!function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return r(n?n:t)},c,c.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t,e,n){var i=t("counterpoint").CantusFirmus,r=t("nmusic").Key,o=t("nmusic").sortPitches,s=t("nmusic").plusInterval,a=t("nmusic").parsePitch,u=t("deepcopy"),l=function(t,e,n,u){t=t||"C4",e=e||"major",n=n||10,u=u||16;var f=new r(t,e),p=new i(f.toString(),n,u);p.addNote(t),this.key=function(){return f.toString()},this.maxRange=function(){return n},this.maxLength=function(){return u},this.mode=function(){return e},this.construction=function(){return p.cf()},this.length=function(){return p.cf().length},this.lastNote=function(){return this.construction()[this.length()-1]},this.firstNote=function(){return this.construction()[0]},this.choices=function(){return p.choices()},this.addNote=function(t){p.addNote(t)},this.pop=function(){if(this.construction().length<=1)throw new Error("No notes to pop.");return p.pop()},this.isValid=function(){return p.isValid()},this.highNote=function(){return o(this.construction())[this.length()-1]},this.lowNote=function(){return o(this.construction())[0]},this.domain=function(){var t=o(this.construction().concat(this.choices())),e=t[0],n=t[t.length-1],i=f.range(e,n);return i.map(function(t){return t.sciPitch()})},this.choicePaths=function(t){return p.choices(t).map(h).reduce(c)},this.transpose=function(t){var i=this.construction().map(function(e){return s(e,t)}),r=new l(i.shift(),e,n,u);return i.forEach(r.addNote),r},this.changeModeTo=function(e){var i=new r(t,e),o=this.construction().map(function(t){var e=a(t);return e.letter+i.accidentalOn(e.letter)+e.octave}),s=new l(o.shift(),e,n,u);try{o.forEach(s.addNote)}catch(c){return!1}return s}},c=function(t,e){var n=u(t);return Array.prototype.push.apply(n,e),n},h=function(t){if(0===t.next.length)return[[t.val]];var e=[];return t.next.forEach(function(n){h(n).forEach(function(n){n.unshift(t.val),e.push(n)})}),e};e.exports=l},{counterpoint:20,deepcopy:41,nmusic:75}],2:[function(t,e,n){function i(){o=new f.PolySynth(6,f.SimpleSynth).set({oscillator:{type:"sine"},envelope:{attack:.6,decay:.1,sustain:.9,release:.2}}).toMaster()}function r(t){o||i(),o.triggerAttackRelease(o.midiToNote(h(t)+12),.3,void 0,.8)}var o,s=t("d3"),a=t("../model/cantus-firmus-maker.js"),u=t("nmusic").Pitch,l=(t("nmusic").sortPitches,t("nmusic").parsePitch,t("nmusic").isHigher,t("nmusic").plusInterval),c=t("nmusic").Key,h=t("nmusic").toMidi,f=t("tone"),p="B Bb A# A Ab G# G Gb F# F E Eb D# D Db C# C".split(" "),d="major minor dorian phrygian lydian mixolydian locrian".split(" "),g=function(t){function e(t,e){if("true"===s.select(this).attr("selected")){var n=e;h(t),s.select(this).transition().duration(250).attr("fill-opacity",$).attr("x",qt(n)).attr("y",function(t){return Pt(t)}).attr("width",qt.rangeBand()).attr("height",Pt.rangeBand()).each("end",function(){s.select(this).attr("animating","no")})}}function n(t){F.select(".y-axis-text").selectAll("text").filter(function(e){return e.val===t}).transition().duration(50).attr("font-size",et)}function h(t){F.select(".y-axis-text").selectAll("text").filter(function(e){return e.val===t}).transition().duration(250).attr("font-size",tt)}function f(t,e,n){t.attr("fill-opacity",Z).attr("x",qt(e)-(qt.rangeBand()*X-qt.rangeBand())/2).attr("y",Pt(n)-(Pt.rangeBand()*X-Pt.rangeBand())/2).attr("width",qt.rangeBand()*X).attr("height",Pt.rangeBand()*X)}function g(t,e,n){t.attr("x",qt(e)-(qt.rangeBand()*J-qt.rangeBand())/2).attr("y",Pt(n)-(Pt.rangeBand()*J-Pt.rangeBand())/2).attr("width",qt.rangeBand()*J).attr("height",Pt.rangeBand()*J)}function y(t,e){var i=e,o=t;ct&&r(o),s.event.preventDefault(),n(o),"no"===s.select(this).attr("animating")&&s.select(this).attr("selected","true").transition().duration(50).call(f,i,o).transition().delay(200).transition().duration(200).call(g,i,o).each("end",function(){s.select(this).attr("selected","false"),"no"===s.select(this).attr("animating")&&m(i)})}function m(t){F.select(".construction-notes").selectAll("rect").attr("animating","yes").attr("selected","false"),F.select(".choice-notes").selectAll("rect").on("mousedown",null).on("touchstart",null).on("mouseup",null).on("touchend",null),s.range(q.length()-1-t).forEach(function(){q.pop()}),j(F)}function v(t){t.attr("x",function(t,e){return qt(e)}).attr("y",function(t){return Pt(t)}).attr("width",qt.rangeBand()).attr("height",Pt.rangeBand()).attr("rx",7).attr("ry",7).attr("fill-opacity",$).attr("fill",function(){return q.isValid()?Q:Y})}function _(t){t.attr("x",qt(q.length()-1)).attr("y",Pt(q.lastNote())).attr("width",qt.rangeBand()).attr("height",Pt.rangeBand()).attr("fill-opacity",0)}function w(t){t.attr("x",function(t){var e=q.construction().lastIndexOf(t.val);return-1===e?K:qt(e)}).attr("y",function(t){return-1===q.construction().lastIndexOf(t.val)?Pt(t.val)+Pt.rangeBand()/2:Pt(t.val)}).attr("width",function(t){return-1===q.construction().lastIndexOf(t.val)?0:qt.rangeBand()}).attr("height",function(t){return-1===q.construction().lastIndexOf(t.val)?0:Pt.rangeBand()}).attr("fill-opacity",0).attr("rx",7).attr("ry",7).attr("fill",Y).attr("animating","yes")}function b(t){t.attr("x",qt(q.length())).attr("y",function(t){return Pt(t.val)+Ft()/2}).attr("width",qt.rangeBand()).attr("height",Pt.rangeBand()-Ft()).attr("fill-opacity",H)}function x(t){t.attr("animating","no").on("mousedown",S).on("touchstart",S).on("mouseup",M).on("touchend",M)}function S(t,e){var i=q.length(),o=t.val;ct&&r(o),s.event.preventDefault(),n(o),"no"===s.select(this).attr("animating")&&s.select(this).attr("selected","true").transition().duration(50).call(f,i,o).transition().delay(200).transition().duration(200).call(g,i,o).each("end",function(){s.select(this).attr("selected","false"),"no"===s.select(this).attr("animating")&&(F.select(".choice-notes").selectAll("rect").on("mousedown",null).on("touchstart",null).on("mouseup",null).on("touchend",null),q.addNote(t.val),j(F))})}function M(t,e){var n=(q.length(),t.val);"true"===s.select(this).attr("selected")&&(h(n),s.select(this).transition().duration(250).call(b).each("end",function(){s.select(this).attr("animating","no")}))}function T(t){t.text(function(t){return u(t.val).pitchClass()}).attr("font-size",tt).attr("text-anchor","start").attr("dominant-baseline","central").attr("x",-50).attr("y",function(t){return Pt(t.val)+Pt.rangeBand()/2})}function A(t){t.attr("x",function(t,e){return qt(e)}).attr("y",function(t){return Pt(t)+Ft()/2}).attr("width",qt.rangeBand()).attr("height",Pt.rangeBand()-Ft()).attr("rx",7).attr("ry",7).attr("fill",Y)}function E(t){t.attr("x",qt(q.length()-1)).attr("y",Pt(q.lastNote())).attr("width",qt.rangeBand()).attr("height",Pt.rangeBand()).attr("fill",function(){return q.isValid()?Q:Y})}function k(){var t=F.select(".choice-notes").selectAll("rect").data(q.choices().map(function(t){return{val:t}}),function(t){return t.val});t.exit().attr("animating","yes").transition().duration(at).call(_).remove(),t.attr("animating","yes").transition().duration(at).call(_).each("end",function(){s.select(this).call(w)}),t.attr("animating","yes").transition().delay(function(t){return at+u(t.val).intervalSize(q.lastNote())*ut/6}).duration(ut).call(b).each("end",function(){s.select(this).call(x)}),t.enter().append("rect").call(w).transition().delay(function(t){return at+u(t.val).intervalSize(q.lastNote())*ut/6}).duration(ut).call(b).each("end",function(){s.select(this).call(x)})}function j(){ft=!0,F.select(".construction-notes").selectAll("rect").attr("selected","false"),F.select(".choice-notes").selectAll("rect").attr("selected","false");var t=F.select(".construction-notes").selectAll("rect").attr("animating","yes").data(q.construction()),n=F.select("#construction-line").datum(q.construction()).attr("d",Ot);t.enter().append("rect").attr("animating","yes").call(A).on("mousedown",y).on("touchstart",y).on("mouseup",e).on("touchend",e),Pt.domain(q.domain()),qt.domain(s.range(s.max([8,q.length()+1]))),t.exit().transition().duration(at).call(E).remove(),t.transition().duration(at).call(v).each("end",function(){s.select(this).attr("animating","no"),ft=!1}),n.transition().duration(at).attr("d",Ot);var i=F.select(".y-axis-text").selectAll("text").data(q.domain().map(function(t){return{val:t}}),function(t){return t.val});i.exit().transition().delay(function(t){var e=u(t.val);return(Math.min(e.intervalSize(q.highNote()),e.intervalSize(q.lowNote()))-2)*at/10}).duration(at/3).attr("x",-50).remove(),i.transition().duration(at).attr("x",ot).attr("y",function(t){return Pt(t.val)+Pt.rangeBand()/2}).attr("font-size",tt).attr("opacity",1),i.enter().append("text").call(T).transition().delay(function(t){return at+u(t.val).intervalSize(q.lastNote())*ut/6}).duration(ut).attr("x",ot),Rt.transition().duration(at).attr("y",Pt(q.firstNote())+(Pt.rangeBand()/2-it/2)).attr("fill",function(){return q.isValid()?Q:Y}),k(),mt()}var q=new a(t.attr("first-note")||"C4",t.attr("mode")||"major",t.attr("max-range")||10,t.attr("max-length")||16),P=t.attr("height")||450;if(t.attr("notes")){var O=t.attr("notes").split(/\s/);O.shift(),O.forEach(q.addNote)}t=t.append("div").attr("id","counterpoint-container").style("position","relative");var F=t.append("svg").attr("width","100%").style("-webkit-tap-highlight-color","transparent"),R={top:5,right:20,bottom:20,left:10},N=40,C=5,L=2,D=(N+C)*L-C,B=t.node().offsetWidth,z=Math.min(window.innerHeight,P),I=B-R.left-R.right,U=z-R.top-R.bottom,G=1,V="steelblue",W=.16,Y="#3498db",Q="#2ca02c",H=.25,$=.5,Z=1,X=1.2,J=1.6,K=40,tt="1em",et="2em",nt=5,it=30,rt=8,ot=nt+rt,st=2,at=300,ut=500,lt=500,ct=!1,ht=!1,ft=!1,pt=t.append("div").attr("id","menu-bar").style("position","absolute").style("left",R.left+ot+K+"px").style("top",R.top+"px").style("height",N+"px").style("display","inline-flex").style("align-items","center"),dt=pt.append("div").attr("id","key-mode-input").style("display","inline-flex"),gt=dt.append("div").attr("id","key-input").style("border-bottom","1px solid rgba(0, 0, 0, 0.12)").style("display","flex").style("align-items","center").append("select").style("font-size","1em").style("border","0").style("background-color","transparent").style("opacity",.7).on("change",function(){ht&&(ht=!1,kt());var t=gt.property("value"),e=u(t).interval(q.firstNote()),n=p.indexOf(t)>p.indexOf(u(q.firstNote()).pitchClass())?"-":"";q=q.transpose(n+e),Pt.domain(q.domain()),F.select(".construction-notes").selectAll("rect").datum(function(t){return l(t,n+e)}),j()});gt.selectAll("option").data(p).enter().append("option").text(function(t){return t}).property("selected",function(t){return t===u(q.firstNote()).pitchClass()});var yt=dt.append("div").attr("id","mode-input").style("border-bottom","1px solid rgba(0, 0, 0, 0.12)").style("display","flex").style("align-items","center").style("margin-left","20px").append("select").style("font-size","1em").style("border","0").style("background-color","transparent").style("opacity",.7).on("change",function(){ht&&(ht=!1,kt());var t=yt.property("value");q.domain()[0],new c(q.firstNote(),t);q=q.changeModeTo(yt.property("value")),Pt.domain(q.domain()),F.select(".construction-notes").selectAll("rect").datum(function(t,e){return q.construction()[e]}),j()});yt.selectAll("option").data(d).enter().append("option").text(function(t){return t}).property("selected",function(t){return t===q.mode()});var mt=function(){yt.selectAll("option").attr("disabled",function(t){return q.changeModeTo(t)===!1?!0:null})},vt=t.append("div").attr("background-color","white").style("position","absolute").style("left",R.left+ot-st+"px").style("display","none").on("submit",function(){s.event.preventDefault(),_t.node().blur()}),_t=vt.append("form").append("input").attr("type","text").attr("name","tonic").style("padding","0px 0px 0px "+st+"px").style("border","0").style("font-size",tt);F.attr("width",B),F.attr("height",z),F=F.append("g").attr("transform","translate("+R.left+","+R.top+")"),F.append("path").attr("id","construction-line").attr("stroke-width",G).attr("stroke-linecap","round").attr("fill","none").attr("stroke",V),F.append("g").attr("class","construction-notes"),F.append("g").attr("class","y-axis-text").attr("opacity",1),F.append("g").attr("class","choice-notes");var wt=s.behavior.drag().origin(function(){var t=s.transform(s.select(this).attr("transform")).translate;return{x:t[0],y:t[1]}}).on("drag",function(){s.select(this).attr("transform","translate("+Math.max(D/2,Math.min(I-D,s.event.x))+","+Math.max(0,Math.min(U-D/2,s.event.y))+")").attr("no-click","true")}),bt=F.append("g").attr("class","menu-icons").attr("transform","translate("+(I-D)+", 0)").call(wt),xt=bt.append("g").attr("class","sound-icon").on("click",function(){"true"===bt.attr("no-click")?bt.attr("no-click","false"):(ct=!ct,o||i(),St.attr("opacity",ct?0:.25),Mt.attr("opacity",ct?.25:0))}),St=xt.append("image").attr("id","sound-off-icon").attr("width",N).attr("height",N).attr("xlink:href","../resources/sound_off.svg").attr("opacity",.25),Mt=xt.append("image").attr("id","sound-on-icon").attr("width",N).attr("height",N).attr("xlink:href","../resources/sound_on.svg").attr("opacity",0),Tt=bt.append("g").attr("class","playback-icon").attr("transform","translate("+(N+C)+", 0)").on("click",function(){s.select(this);"true"===bt.attr("no-click")?bt.attr("no-click","false"):(ht=!ht,o||i(),ht&&jt(0),kt())}),At=Tt.append("image").attr("id","play-icon").attr("width",N).attr("height",N).attr("xlink:href","../resources/play.svg").attr("opacity",.25),Et=Tt.append("image").attr("id","stop-icon").attr("width",N).attr("height",N).attr("xlink:href","../resources/stop.svg").attr("opacity",0),kt=function(){At.attr("opacity",ht?0:.25),Et.attr("opacity",ht?.25:0)},jt=function(t){if(ht&&t<q.length()){var e=q.construction()[t];if(r(e),!ft){n(e);var i=s.select(F.select(".construction-notes").selectAll("rect")[0][t]);"no"===i.attr("animating")&&i.attr("selected","true").transition().duration(50).call(f,t,e).transition().delay(200).each("end",function(){h(e),i.attr("selected","false").transition().duration(250).attr("fill-opacity",$).attr("x",qt(t)).attr("y",function(t){return Pt(t)}).attr("width",qt.rangeBand()).attr("height",Pt.rangeBand()).each("end",function(){s.select(this).attr("animating","no")})})}window.setTimeout(function(){jt(t+1)},lt)}else ht=!1,kt()},qt=s.scale.ordinal().domain(s.range(s.max([8,q.length()+1]))).rangeRoundBands([ot+K,I]),Pt=s.scale.ordinal().domain(q.domain()).rangeRoundBands([U,N]),Ot=s.svg.line().x(function(t,e){return qt(e)+qt.rangeBand()/2}).y(function(t){return Pt(t)+Pt.rangeBand()/2}).interpolate("cardinal").tension(.7),Ft=function(){return Pt.rangeBand()*W};window.addEventListener("resize",function(){var e=I;if(t.select("svg").attr("width","100%"),I=t.node().offsetWidth-R.left-R.right,t.select("svg").attr("width",I+R.left+R.right),e!==I){var n=s.transform(bt.attr("transform")).translate;bt.attr("transform","translate("+I*(n[0]/e)+","+n[1]+")"),qt.rangeRoundBands([ot+K,I]),j()}});var Rt=F.append("rect").attr("x",0).attr("y",Pt(q.firstNote())+(Pt.rangeBand()/2-it/2)).attr("width",nt).attr("opacity",1).attr("height",it).attr("fill",function(){return q.isValid()?Q:Y});j()};s.selectAll("counterpoint").each(function(){g(s.select(this))})},{"../model/cantus-firmus-maker.js":1,d3:40,nmusic:75,tone:88}],3:[function(t,e,n){t("./app/view/cantus-firmus-guide.js")},{"./app/view/cantus-firmus-guide.js":2}],4:[function(t,e,n){(function(e){function i(){return r.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function r(t){return this instanceof r?(this.length=0,this.parent=void 0,"number"==typeof t?o(this,t):"string"==typeof t?s(this,t,arguments.length>1?arguments[1]:"utf8"):a(this,t)):arguments.length>1?new r(t,arguments[1]):new r(t)}function o(t,e){if(t=d(t,0>e?0:0|g(e)),!r.TYPED_ARRAY_SUPPORT)for(var n=0;e>n;n++)t[n]=0;return t}function s(t,e,n){("string"!=typeof n||""===n)&&(n="utf8");var i=0|m(e,n);return t=d(t,i),t.write(e,n),t}function a(t,e){if(r.isBuffer(e))return u(t,e);if($(e))return l(t,e);if(null==e)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(e.buffer instanceof ArrayBuffer)return c(t,e);if(e instanceof ArrayBuffer)return h(t,e)}return e.length?f(t,e):p(t,e)}function u(t,e){var n=0|g(e.length);return t=d(t,n),e.copy(t,0,0,n),t}function l(t,e){var n=0|g(e.length);t=d(t,n);for(var i=0;n>i;i+=1)t[i]=255&e[i];return t}function c(t,e){var n=0|g(e.length);t=d(t,n);for(var i=0;n>i;i+=1)t[i]=255&e[i];return t}function h(t,e){return r.TYPED_ARRAY_SUPPORT?(e.byteLength,t=r._augment(new Uint8Array(e))):t=c(t,new Uint8Array(e)),t}function f(t,e){var n=0|g(e.length);t=d(t,n);for(var i=0;n>i;i+=1)t[i]=255&e[i];return t}function p(t,e){var n,i=0;"Buffer"===e.type&&$(e.data)&&(n=e.data,i=0|g(n.length)),t=d(t,i);for(var r=0;i>r;r+=1)t[r]=255&n[r];return t}function d(t,e){r.TYPED_ARRAY_SUPPORT?(t=r._augment(new Uint8Array(e)),t.__proto__=r.prototype):(t.length=e,t._isBuffer=!0);var n=0!==e&&e<=r.poolSize>>>1;return n&&(t.parent=Z),t}function g(t){if(t>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|t}function y(t,e){if(!(this instanceof y))return new y(t,e);var n=new r(t,e);return delete n.parent,n}function m(t,e){"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"binary":case"raw":case"raws":return n;case"utf8":case"utf-8":return U(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return W(t).length;default:if(i)return U(t).length;e=(""+e).toLowerCase(),i=!0}}function v(t,e,n){var i=!1;if(e=0|e,n=void 0===n||n===1/0?this.length:0|n,t||(t="utf8"),0>e&&(e=0),n>this.length&&(n=this.length),e>=n)return"";for(;;)switch(t){case"hex":return q(this,e,n);case"utf8":case"utf-8":return A(this,e,n);case"ascii":return k(this,e,n);case"binary":return j(this,e,n);case"base64":return T(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,n);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function _(t,e,n,i){n=Number(n)||0;var r=t.length-n;i?(i=Number(i),i>r&&(i=r)):i=r;var o=e.length;if(o%2!==0)throw new Error("Invalid hex string");i>o/2&&(i=o/2);for(var s=0;i>s;s++){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");t[n+s]=a}return s}function w(t,e,n,i){return Y(U(e,t.length-n),t,n,i)}function b(t,e,n,i){return Y(G(e),t,n,i)}function x(t,e,n,i){return b(t,e,n,i)}function S(t,e,n,i){return Y(W(e),t,n,i)}function M(t,e,n,i){return Y(V(e,t.length-n),t,n,i)}function T(t,e,n){return 0===e&&n===t.length?Q.fromByteArray(t):Q.fromByteArray(t.slice(e,n))}function A(t,e,n){n=Math.min(t.length,n);for(var i=[],r=e;n>r;){var o=t[r],s=null,a=o>239?4:o>223?3:o>191?2:1;if(n>=r+a){var u,l,c,h;switch(a){case 1:128>o&&(s=o);break;case 2:u=t[r+1],128===(192&u)&&(h=(31&o)<<6|63&u,h>127&&(s=h));break;case 3:u=t[r+1],l=t[r+2],128===(192&u)&&128===(192&l)&&(h=(15&o)<<12|(63&u)<<6|63&l,h>2047&&(55296>h||h>57343)&&(s=h));break;case 4:u=t[r+1],l=t[r+2],c=t[r+3],128===(192&u)&&128===(192&l)&&128===(192&c)&&(h=(15&o)<<18|(63&u)<<12|(63&l)<<6|63&c,h>65535&&1114112>h&&(s=h))}}null===s?(s=65533,a=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|1023&s),i.push(s),r+=a}return E(i)}function E(t){var e=t.length;if(X>=e)return String.fromCharCode.apply(String,t);for(var n="",i=0;e>i;)n+=String.fromCharCode.apply(String,t.slice(i,i+=X));return n}function k(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;n>r;r++)i+=String.fromCharCode(127&t[r]);return i}function j(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;n>r;r++)i+=String.fromCharCode(t[r]);return i}function q(t,e,n){var i=t.length;(!e||0>e)&&(e=0),(!n||0>n||n>i)&&(n=i);for(var r="",o=e;n>o;o++)r+=I(t[o]);return r}function P(t,e,n){for(var i=t.slice(e,n),r="",o=0;o<i.length;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}function O(t,e,n){if(t%1!==0||0>t)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function F(t,e,n,i,o,s){if(!r.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>o||s>e)throw new RangeError("value is out of bounds");if(n+i>t.length)throw new RangeError("index out of range")}function R(t,e,n,i){0>e&&(e=65535+e+1);for(var r=0,o=Math.min(t.length-n,2);o>r;r++)t[n+r]=(e&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function N(t,e,n,i){0>e&&(e=4294967295+e+1);for(var r=0,o=Math.min(t.length-n,4);o>r;r++)t[n+r]=e>>>8*(i?r:3-r)&255}function C(t,e,n,i,r,o){if(e>r||o>e)throw new RangeError("value is out of bounds");if(n+i>t.length)throw new RangeError("index out of range");if(0>n)throw new RangeError("index out of range")}function L(t,e,n,i,r){return r||C(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),H.write(t,e,n,i,23,4),n+4}function D(t,e,n,i,r){return r||C(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),H.write(t,e,n,i,52,8),n+8}function B(t){if(t=z(t).replace(K,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function z(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function I(t){return 16>t?"0"+t.toString(16):t.toString(16)}function U(t,e){e=e||1/0;for(var n,i=t.length,r=null,o=[],s=0;i>s;s++){if(n=t.charCodeAt(s),n>55295&&57344>n){if(!r){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===i){(e-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(56320>n){(e-=3)>-1&&o.push(239,191,189),r=n;continue}n=r-55296<<10|n-56320|65536}else r&&(e-=3)>-1&&o.push(239,191,189);if(r=null,128>n){if((e-=1)<0)break;o.push(n)}else if(2048>n){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(65536>n){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(1114112>n))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function G(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}function V(t,e){for(var n,i,r,o=[],s=0;s<t.length&&!((e-=2)<0);s++)n=t.charCodeAt(s),i=n>>8,r=n%256,o.push(r),o.push(i);return o}function W(t){return Q.toByteArray(B(t))}function Y(t,e,n,i){for(var r=0;i>r&&!(r+n>=e.length||r>=t.length);r++)e[r+n]=t[r];return r}var Q=t("base64-js"),H=t("ieee754"),$=t("is-array");n.Buffer=r,n.SlowBuffer=y,n.INSPECT_MAX_BYTES=50,r.poolSize=8192;var Z={};r.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){function t(){}try{var e=new Uint8Array(1);return e.foo=function(){return 42},e.constructor=t,42===e.foo()&&e.constructor===t&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(n){return!1}}(),r.TYPED_ARRAY_SUPPORT&&(r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array),r.isBuffer=function(t){return!(null==t||!t._isBuffer)},r.compare=function(t,e){if(!r.isBuffer(t)||!r.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,o=0,s=Math.min(n,i);s>o&&t[o]===e[o];)++o;return o!==s&&(n=t[o],i=e[o]),i>n?-1:n>i?1:0},r.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(t,e){if(!$(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new r(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;n++)e+=t[n].length;var i=new r(e),o=0;for(n=0;n<t.length;n++){var s=t[n];s.copy(i,o),o+=s.length}return i},r.byteLength=m,r.prototype.length=void 0,r.prototype.parent=void 0,r.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?A(this,0,t):v.apply(this,arguments)},r.prototype.equals=function(t){if(!r.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:0===r.compare(this,t)},r.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},r.prototype.compare=function(t){if(!r.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:r.compare(this,t)},r.prototype.indexOf=function(t,e){function n(t,e,n){for(var i=-1,r=0;n+r<t.length;r++)if(t[n+r]===e[-1===i?0:r-i]){if(-1===i&&(i=r),r-i+1===e.length)return n+i}else i=-1;return-1}if(e>2147483647?e=2147483647:-2147483648>e&&(e=-2147483648),e>>=0,0===this.length)return-1;if(e>=this.length)return-1;if(0>e&&(e=Math.max(this.length+e,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,e);if(r.isBuffer(t))return n(this,t,e);if("number"==typeof t)return r.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,e):n(this,[t],e);throw new TypeError("val must be string, number or Buffer")},r.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},r.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},r.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else if(isFinite(e))e=0|e,isFinite(n)?(n=0|n,void 0===i&&(i="utf8")):(i=n,n=void 0);else{var r=i;i=e,e=0|n,n=r}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(0>n||0>e)||e>this.length)throw new RangeError("attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return _(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":return b(this,t,e,n);case"binary":return x(this,t,e,n);case"base64":return S(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var X=4096;r.prototype.slice=function(t,e){var n=this.length;t=~~t,e=void 0===e?n:~~e,0>t?(t+=n,0>t&&(t=0)):t>n&&(t=n),0>e?(e+=n,0>e&&(e=0)):e>n&&(e=n),t>e&&(e=t);var i;if(r.TYPED_ARRAY_SUPPORT)i=r._augment(this.subarray(t,e));else{var o=e-t;i=new r(o,void 0);for(var s=0;o>s;s++)i[s]=this[s+t]}return i.length&&(i.parent=this.parent||this),i},r.prototype.readUIntLE=function(t,e,n){t=0|t,e=0|e,n||O(t,e,this.length);for(var i=this[t],r=1,o=0;++o<e&&(r*=256);)i+=this[t+o]*r;return i},r.prototype.readUIntBE=function(t,e,n){t=0|t,e=0|e,n||O(t,e,this.length);for(var i=this[t+--e],r=1;e>0&&(r*=256);)i+=this[t+--e]*r;return i},r.prototype.readUInt8=function(t,e){return e||O(t,1,this.length),this[t]},r.prototype.readUInt16LE=function(t,e){return e||O(t,2,this.length),this[t]|this[t+1]<<8},r.prototype.readUInt16BE=function(t,e){return e||O(t,2,this.length),this[t]<<8|this[t+1]},r.prototype.readUInt32LE=function(t,e){return e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},r.prototype.readUInt32BE=function(t,e){return e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},r.prototype.readIntLE=function(t,e,n){t=0|t,e=0|e,n||O(t,e,this.length);for(var i=this[t],r=1,o=0;++o<e&&(r*=256);)i+=this[t+o]*r;return r*=128,i>=r&&(i-=Math.pow(2,8*e)),i},r.prototype.readIntBE=function(t,e,n){t=0|t,e=0|e,n||O(t,e,this.length);for(var i=e,r=1,o=this[t+--i];i>0&&(r*=256);)o+=this[t+--i]*r;return r*=128,o>=r&&(o-=Math.pow(2,8*e)),o},r.prototype.readInt8=function(t,e){return e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},r.prototype.readInt16LE=function(t,e){e||O(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},r.prototype.readInt16BE=function(t,e){e||O(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},r.prototype.readInt32LE=function(t,e){return e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},r.prototype.readInt32BE=function(t,e){return e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},r.prototype.readFloatLE=function(t,e){return e||O(t,4,this.length),H.read(this,t,!0,23,4)},r.prototype.readFloatBE=function(t,e){return e||O(t,4,this.length),H.read(this,t,!1,23,4)},r.prototype.readDoubleLE=function(t,e){return e||O(t,8,this.length),H.read(this,t,!0,52,8)},r.prototype.readDoubleBE=function(t,e){return e||O(t,8,this.length),H.read(this,t,!1,52,8)},r.prototype.writeUIntLE=function(t,e,n,i){t=+t,e=0|e,n=0|n,i||F(this,t,e,n,Math.pow(2,8*n),0);var r=1,o=0;for(this[e]=255&t;++o<n&&(r*=256);)this[e+o]=t/r&255;return e+n},r.prototype.writeUIntBE=function(t,e,n,i){t=+t,e=0|e,n=0|n,i||F(this,t,e,n,Math.pow(2,8*n),0);var r=n-1,o=1;for(this[e+r]=255&t;--r>=0&&(o*=256);)this[e+r]=t/o&255;return e+n},r.prototype.writeUInt8=function(t,e,n){return t=+t,e=0|e,n||F(this,t,e,1,255,0),r.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=t,e+1},r.prototype.writeUInt16LE=function(t,e,n){return t=+t,e=0|e,n||F(this,t,e,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},r.prototype.writeUInt16BE=function(t,e,n){return t=+t,e=0|e,n||F(this,t,e,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):R(this,t,e,!1),e+2},r.prototype.writeUInt32LE=function(t,e,n){return t=+t,e=0|e,n||F(this,t,e,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t):N(this,t,e,!0),e+4},r.prototype.writeUInt32BE=function(t,e,n){return t=+t,e=0|e,n||F(this,t,e,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):N(this,t,e,!1),e+4},r.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e=0|e,!i){var r=Math.pow(2,8*n-1);F(this,t,e,n,r-1,-r)}var o=0,s=1,a=0>t?1:0;for(this[e]=255&t;++o<n&&(s*=256);)this[e+o]=(t/s>>0)-a&255;return e+n},r.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e=0|e,!i){var r=Math.pow(2,8*n-1);F(this,t,e,n,r-1,-r)}var o=n-1,s=1,a=0>t?1:0;for(this[e+o]=255&t;--o>=0&&(s*=256);)this[e+o]=(t/s>>0)-a&255;return e+n},r.prototype.writeInt8=function(t,e,n){return t=+t,e=0|e,n||F(this,t,e,1,127,-128),r.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[e]=t,e+1},r.prototype.writeInt16LE=function(t,e,n){return t=+t,e=0|e,n||F(this,t,e,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},r.prototype.writeInt16BE=function(t,e,n){return t=+t,e=0|e,n||F(this,t,e,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):R(this,t,e,!1),e+2},r.prototype.writeInt32LE=function(t,e,n){return t=+t,e=0|e,n||F(this,t,e,4,2147483647,-2147483648),r.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):N(this,t,e,!0),e+4},r.prototype.writeInt32BE=function(t,e,n){return t=+t,e=0|e,n||F(this,t,e,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):N(this,t,e,!1),e+4},r.prototype.writeFloatLE=function(t,e,n){return L(this,t,e,!0,n)},r.prototype.writeFloatBE=function(t,e,n){return L(this,t,e,!1,n)},r.prototype.writeDoubleLE=function(t,e,n){return D(this,t,e,!0,n)},r.prototype.writeDoubleBE=function(t,e,n){return D(this,t,e,!1,n)},r.prototype.copy=function(t,e,n,i){if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&n>i&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(0>e)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("sourceStart out of bounds");if(0>i)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var o,s=i-n;if(this===t&&e>n&&i>e)for(o=s-1;o>=0;o--)t[o+e]=this[o+n];else if(1e3>s||!r.TYPED_ARRAY_SUPPORT)for(o=0;s>o;o++)t[o+e]=this[o+n];else t._set(this.subarray(n,n+s),e);
return s},r.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),e>n)throw new RangeError("end < start");if(n!==e&&0!==this.length){if(0>e||e>=this.length)throw new RangeError("start out of bounds");if(0>n||n>this.length)throw new RangeError("end out of bounds");var i;if("number"==typeof t)for(i=e;n>i;i++)this[i]=t;else{var r=U(t.toString()),o=r.length;for(i=e;n>i;i++)this[i]=r[i%o]}return this}},r.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(r.TYPED_ARRAY_SUPPORT)return new r(this).buffer;for(var t=new Uint8Array(this.length),e=0,n=t.length;n>e;e+=1)t[e]=this[e];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var J=r.prototype;r._augment=function(t){return t.constructor=r,t._isBuffer=!0,t._set=t.set,t.get=J.get,t.set=J.set,t.write=J.write,t.toString=J.toString,t.toLocaleString=J.toString,t.toJSON=J.toJSON,t.equals=J.equals,t.compare=J.compare,t.indexOf=J.indexOf,t.copy=J.copy,t.slice=J.slice,t.readUIntLE=J.readUIntLE,t.readUIntBE=J.readUIntBE,t.readUInt8=J.readUInt8,t.readUInt16LE=J.readUInt16LE,t.readUInt16BE=J.readUInt16BE,t.readUInt32LE=J.readUInt32LE,t.readUInt32BE=J.readUInt32BE,t.readIntLE=J.readIntLE,t.readIntBE=J.readIntBE,t.readInt8=J.readInt8,t.readInt16LE=J.readInt16LE,t.readInt16BE=J.readInt16BE,t.readInt32LE=J.readInt32LE,t.readInt32BE=J.readInt32BE,t.readFloatLE=J.readFloatLE,t.readFloatBE=J.readFloatBE,t.readDoubleLE=J.readDoubleLE,t.readDoubleBE=J.readDoubleBE,t.writeUInt8=J.writeUInt8,t.writeUIntLE=J.writeUIntLE,t.writeUIntBE=J.writeUIntBE,t.writeUInt16LE=J.writeUInt16LE,t.writeUInt16BE=J.writeUInt16BE,t.writeUInt32LE=J.writeUInt32LE,t.writeUInt32BE=J.writeUInt32BE,t.writeIntLE=J.writeIntLE,t.writeIntBE=J.writeIntBE,t.writeInt8=J.writeInt8,t.writeInt16LE=J.writeInt16LE,t.writeInt16BE=J.writeInt16BE,t.writeInt32LE=J.writeInt32LE,t.writeInt32BE=J.writeInt32BE,t.writeFloatLE=J.writeFloatLE,t.writeFloatBE=J.writeFloatBE,t.writeDoubleLE=J.writeDoubleLE,t.writeDoubleBE=J.writeDoubleBE,t.fill=J.fill,t.inspect=J.inspect,t.toArrayBuffer=J.toArrayBuffer,t};var K=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":5,ieee754:6,"is-array":7}],5:[function(t,e,n){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===s||e===h?62:e===a||e===f?63:u>e?-1:u+10>e?e-u+26+26:c+26>e?e-c:l+26>e?e-l+26:void 0}function n(t){function n(t){l[h++]=t}var i,r,s,a,u,l;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=t.length;u="="===t.charAt(c-2)?2:"="===t.charAt(c-1)?1:0,l=new o(3*t.length/4-u),s=u>0?t.length-4:t.length;var h=0;for(i=0,r=0;s>i;i+=4,r+=3)a=e(t.charAt(i))<<18|e(t.charAt(i+1))<<12|e(t.charAt(i+2))<<6|e(t.charAt(i+3)),n((16711680&a)>>16),n((65280&a)>>8),n(255&a);return 2===u?(a=e(t.charAt(i))<<2|e(t.charAt(i+1))>>4,n(255&a)):1===u&&(a=e(t.charAt(i))<<10|e(t.charAt(i+1))<<4|e(t.charAt(i+2))>>2,n(a>>8&255),n(255&a)),l}function r(t){function e(t){return i.charAt(t)}function n(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var r,o,s,a=t.length%3,u="";for(r=0,s=t.length-a;s>r;r+=3)o=(t[r]<<16)+(t[r+1]<<8)+t[r+2],u+=n(o);switch(a){case 1:o=t[t.length-1],u+=e(o>>2),u+=e(o<<4&63),u+="==";break;case 2:o=(t[t.length-2]<<8)+t[t.length-1],u+=e(o>>10),u+=e(o>>4&63),u+=e(o<<2&63),u+="="}return u}var o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="+".charCodeAt(0),a="/".charCodeAt(0),u="0".charCodeAt(0),l="a".charCodeAt(0),c="A".charCodeAt(0),h="-".charCodeAt(0),f="_".charCodeAt(0);t.toByteArray=n,t.fromByteArray=r}("undefined"==typeof n?this.base64js={}:n)},{}],6:[function(t,e,n){n.read=function(t,e,n,i,r){var o,s,a=8*r-i-1,u=(1<<a)-1,l=u>>1,c=-7,h=n?r-1:0,f=n?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-c)-1,p>>=-c,c+=a;c>0;o=256*o+t[e+h],h+=f,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=i;c>0;s=256*s+t[e+h],h+=f,c-=8);if(0===o)o=1-l;else{if(o===u)return s?NaN:(p?-1:1)*(1/0);s+=Math.pow(2,i),o-=l}return(p?-1:1)*s*Math.pow(2,o-i)},n.write=function(t,e,n,i,r,o){var s,a,u,l=8*o-r-1,c=(1<<l)-1,h=c>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,d=i?1:-1,g=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),e+=s+h>=1?f/u:f*Math.pow(2,1-h),e*u>=2&&(s++,u/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(e*u-1)*Math.pow(2,r),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;t[n+p]=255&a,p+=d,a/=256,r-=8);for(s=s<<r|a,l+=r;l>0;t[n+p]=255&s,p+=d,s/=256,l-=8);t[n+p-d]|=128*g}},{}],7:[function(t,e,n){var i=Array.isArray,r=Object.prototype.toString;e.exports=i||function(t){return!!t&&"[object Array]"==r.call(t)}},{}],8:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],9:[function(t,e,n){function i(){c=!1,a.length?l=a.concat(l):h=-1,l.length&&r()}function r(){if(!c){var t=setTimeout(i);c=!0;for(var e=l.length;e;){for(a=l,l=[];++h<e;)a&&a[h].run();h=-1,e=l.length}a=null,c=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function s(){}var a,u=e.exports={},l=[],c=!1,h=-1;u.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new o(t,e)),1!==l.length||c||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=s,u.addListener=s,u.once=s,u.off=s,u.removeListener=s,u.removeAllListeners=s,u.emit=s,u.binding=function(t){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(t){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],10:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],11:[function(t,e,n){(function(e,i){function r(t,e){var i={seen:[],stylize:s};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),g(e)?i.showHidden=e:e&&n._extend(i,e),b(i.showHidden)&&(i.showHidden=!1),b(i.depth)&&(i.depth=2),b(i.colors)&&(i.colors=!1),b(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=o),u(i,t,i.depth)}function o(t,e){var n=r.styles[e];return n?"["+r.colors[n][0]+"m"+t+"["+r.colors[n][1]+"m":t}function s(t,e){return t}function a(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function u(t,e,i){if(t.customInspect&&e&&A(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var r=e.inspect(i,t);return _(r)||(r=u(t,r,i)),r}var o=l(t,e);if(o)return o;var s=Object.keys(e),g=a(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),T(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return c(e);if(0===s.length){if(A(e)){var y=e.name?": "+e.name:"";return t.stylize("[Function"+y+"]","special")}if(x(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(M(e))return t.stylize(Date.prototype.toString.call(e),"date");if(T(e))return c(e)}var m="",v=!1,w=["{","}"];if(d(e)&&(v=!0,w=["[","]"]),A(e)){var b=e.name?": "+e.name:"";m=" [Function"+b+"]"}if(x(e)&&(m=" "+RegExp.prototype.toString.call(e)),M(e)&&(m=" "+Date.prototype.toUTCString.call(e)),T(e)&&(m=" "+c(e)),0===s.length&&(!v||0==e.length))return w[0]+m+w[1];if(0>i)return x(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var S;return S=v?h(t,e,i,g,s):s.map(function(n){return f(t,e,i,g,n,v)}),t.seen.pop(),p(S,m,w)}function l(t,e){if(b(e))return t.stylize("undefined","undefined");if(_(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return v(e)?t.stylize(""+e,"number"):g(e)?t.stylize(""+e,"boolean"):y(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,i,r){for(var o=[],s=0,a=e.length;a>s;++s)P(e,String(s))?o.push(f(t,e,n,i,String(s),!0)):o.push("");return r.forEach(function(r){r.match(/^\d+$/)||o.push(f(t,e,n,i,r,!0))}),o}function f(t,e,n,i,r,o){var s,a,l;if(l=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]},l.get?a=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(a=t.stylize("[Setter]","special")),P(i,r)||(s="["+r+"]"),a||(t.seen.indexOf(l.value)<0?(a=y(n)?u(t,l.value,null):u(t,l.value,n-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),b(s)){if(o&&r.match(/^\d+$/))return a;s=JSON.stringify(""+r),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function p(t,e,n){var i=0,r=t.reduce(function(t,e){return i++,e.indexOf("\n")>=0&&i++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return r>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function d(t){return Array.isArray(t)}function g(t){return"boolean"==typeof t}function y(t){return null===t}function m(t){return null==t}function v(t){return"number"==typeof t}function _(t){return"string"==typeof t}function w(t){return"symbol"==typeof t}function b(t){return void 0===t}function x(t){return S(t)&&"[object RegExp]"===k(t)}function S(t){return"object"==typeof t&&null!==t}function M(t){return S(t)&&"[object Date]"===k(t)}function T(t){return S(t)&&("[object Error]"===k(t)||t instanceof Error)}function A(t){return"function"==typeof t}function E(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function k(t){return Object.prototype.toString.call(t)}function j(t){return 10>t?"0"+t.toString(10):t.toString(10)}function q(){var t=new Date,e=[j(t.getHours()),j(t.getMinutes()),j(t.getSeconds())].join(":");return[t.getDate(),N[t.getMonth()],e].join(" ")}function P(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var O=/%[sdj%]/g;n.format=function(t){if(!_(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(r(arguments[n]));return e.join(" ")}for(var n=1,i=arguments,o=i.length,s=String(t).replace(O,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(e){return"[Circular]"}default:return t}}),a=i[n];o>n;a=i[++n])s+=y(a)||!S(a)?" "+a:" "+r(a);return s},n.deprecate=function(t,r){function o(){if(!s){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),s=!0}return t.apply(this,arguments)}if(b(i.process))return function(){return n.deprecate(t,r).apply(this,arguments)};if(e.noDeprecation===!0)return t;var s=!1;return o};var F,R={};n.debuglog=function(t){if(b(F)&&(F=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!R[t])if(new RegExp("\\b"+t+"\\b","i").test(F)){var i=e.pid;R[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,i,e)}}else R[t]=function(){};return R[t]},n.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=d,n.isBoolean=g,n.isNull=y,n.isNullOrUndefined=m,n.isNumber=v,n.isString=_,n.isSymbol=w,n.isUndefined=b,n.isRegExp=x,n.isObject=S,n.isDate=M,n.isError=T,n.isFunction=A,n.isPrimitive=E,n.isBuffer=t("./support/isBuffer");var N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",q(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!S(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":10,_process:9,inherits:8}],12:[function(t,e,n){var i=t("./create-cf-guide.js"),r=t("nmusic").Pitch,o=t("nmusic").intervalSize,s=t("../utils/sort-pitches.js"),a=8,u=16,l=function(t,e,n){t=t||"C major",e=e||10,n=n||16;var l=i(t,e,n);this.cf=function(){return l.construction()},this.addNote=function(t){l.choose(t)},this.pop=function(){return l.pop()},this.choices=function(t){return l.choices(t||1)},this.isValid=function(){var t=this.cf();if(t.length<a||t.length>u)return!1;if(r(t[t.length-1]).pitchClass()!==l.tonic())return!1;if(r(t[0]).pitchClass()===l.tonic()&&t[0]!==t[t.length-1])return!1;if(2!==o(t[t.length-2],t[t.length-1]))return!1;var e=s(t);return e[e.length-1]===e[e.length-2]?!1:!0}};e.exports=l},{"../utils/sort-pitches.js":22,"./create-cf-guide.js":14,nmusic:27}],13:[function(t,e,n){var i=t("music-machine"),r=t("./grammar/cf-grammar.js"),o=[t("./grammar/pattern-filter.js"),t("./grammar/melodic-outline-filter.js"),t("./grammar/no-leap-back-filter.js"),i.filter.allowedIntervalQualities("M","m","P")],s=new i(r,"Start");o.forEach(s.addFilter),e.exports=s},{"./grammar/cf-grammar.js":15,"./grammar/melodic-outline-filter.js":17,"./grammar/no-leap-back-filter.js":18,"./grammar/pattern-filter.js":19,"music-machine":53}],14:[function(t,e,n){var i=t("./cf-machine.js"),r=t("music-machine"),o=r.filter.maxRange,s=r.filter.maxLength,a=t("./grammar/foresight-filter-generator.js"),u=function(t,e,n){var r=i.createGuide(t||"C major"),u=[o(e||10),s(n||16),a(e||10)];return u.forEach(r.addFilter),r};e.exports=u},{"./cf-machine.js":13,"./grammar/foresight-filter-generator.js":16,"music-machine":53}],15:[function(t,e,n){var i=t("deepcopy"),r={UpPhrase:["UpLeap DownStepPhrase UpPhrase","UpStepPhrase DownPhrase"],UpStepPhrase:["Up2Phrase","Up3Phrase","UpLeapForwardPhrase"],Up2Phrase:["2","2 Up2Phrase","2 Up3Phrase"],Up3Phrase:["3","3 Up2Phrase"],UpLeapForwardPhrase:["2 UpLeapForward DownStepPhrase UpPhrase"],UpLeapForward:["4","5"],UpLeap:["4","5","6","8"]},o={Start:["UpPhrase","DownPhrase"]};for(var s in r){o[s]=i(r[s]);var a=i(r[s]).map(function(t){return t.split(" ").map(function(t){return t.indexOf("Down")>-1?t.replace("Down","Up"):t.indexOf("Up")>-1?t.replace("Up","Down"):isNaN(t)?t:"-"+t}).join(" ")});o[s.replace("Up","Down")]=a}e.exports=o},{deepcopy:41}],16:[function(t,e,n){var i=t("nmusic").isHigher,r=t("nmusic").intervalSize,o=t("nmusic").sortPitches,s=function(t,e){return function(e,n){if(0===n.length)return e;var s=n[0],a=o(n);return i(a[a.length-1],s)||(e=e.filter(function(e){return i(e,s)||r(e,s)<=t-1})),e}};e.exports=s},{nmusic:27}],17:[function(t,e,n){var i=t("../../utils/index-of-last-outline.js"),r=t("nmusic").isHigher,o=t("nmusic").intervalSize,s=t("nmusic").intervalQuality,a=5,u=[7],l=["A","d"],c=function(t,e){return-1!==u.indexOf(o(t,e))||-1!==l.indexOf(s(t,e))},h=function(t,e){var n=e.slice(i(e));if(n.length<3)return t;var o=n[0],s=n[n.length-1],u=r(s,o);return n.length>=a&&(t=t.filter(function(t){return u!==r(t,s)})),c(o,s)&&(t=t.filter(function(t){return u===r(t,s)})),n.length===a-1&&(t=t.filter(function(t){return!c(o,t)})),t};e.exports=h},{"../../utils/index-of-last-outline.js":21,nmusic:27}],18:[function(t,e,n){var i=t("nmusic").intervalSize,r=function(t,e){var n=e.length;if(2>n||3!==i(e[n-2],e[n-1]))return t;var r=e[n-2];return t.filter(function(t){return t!==r})};e.exports=r},{nmusic:27}],19:[function(t,e,n){var i=function(t,e){var n=e.length;if(n>2){var i=[];e[n-3]===e[n-1]&&i.push(e[n-2]),n>4&&e[n-5]===e[n-2]&&e[n-4]===e[n-1]&&i.push(e[n-3]),i.length>0&&(t=t.filter(function(t){return-1===i.indexOf(t)}))}return t};e.exports=i},{}],20:[function(t,e,n){var i={CantusFirmus:t("./cantus-firmus/cantus-firmus.js")};e.exports=i},{"./cantus-firmus/cantus-firmus.js":12}],21:[function(t,e,n){var i=t("nmusic").isHigher,r=function(t){if(t.length<3)return 0;for(var e=t.length-2;e>0&&t[e]===t[e+1];)e--;for(var n=i(t[e],t[e+1]);e>0&&(n===i(t[e-1],t[e])||t[e-1]===t[e]);)e--;return e};e.exports=r},{nmusic:27}],22:[function(t,e,n){function i(t){return t.map(r).sort(function(t,e){return t-e}).map(function(t){return t.sciPitch()})}var r=t("nmusic").Pitch;e.exports=i},{nmusic:27}],23:[function(t,e,n){var i=t("../pitch/pitch.js"),r=t("./mode-intervals.js"),o=t("./scale-set.js"),s=t("../pitch/parse-pitch.js"),a=t("../pitch/interval-size.js"),u=function(t,e){return this instanceof u?(this.tonic=i(t),this.modeName="string"==typeof e?e.toLowerCase():"custom-scale",this.mode="string"==typeof e?r(e):e,this.scale=o(this.tonic.pitchClass(),this.mode),Object.freeze(this.scale),void Object.freeze(this)):new u(t,e)};u.prototype={constructor:u,toString:function(){return this.tonic.pitchClass()+" "+this.modeName},inKey:function(t){return this.scale.indexOf(i(t).pitchClass())>-1},accidentalOn:function(t){var e=a.simple(this.tonic.name,i(t).letter()+(this.tonic.octave()+1));return s(this.scale[e-1]).accidental},pitchAtDegree:function(t){return i(this.scale[(t-1)%this.scale.length])},scaleDegree:function(t){return this.inKey(t)?this.scale.indexOf(i(t).pitchClass())+1:-1},plusInterval:function(t,e){var n=i(t).plusInterval(e);return new i(n.letter()+this.accidentalOn(n)+n.octave())},range:function(t,e){if(!this.inKey(t)||!this.inKey(e))throw new Error("One or both of lo and hi are not in key:",t,e);for(var n=[i(t)];!n[n.length-1].equals(e);)n.push(this.plusInterval(n[n.length-1],2));return n}},e.exports=u},{"../pitch/interval-size.js":29,"../pitch/parse-pitch.js":33,"../pitch/pitch.js":34,"./mode-intervals.js":24,"./scale-set.js":25}],24:[function(t,e,n){var i={major:["P1","M2","M3","P4","P5","M6","M7"],minor:["P1","M2","m3","P4","P5","m6","m7"],ionian:["P1","M2","M3","P4","P5","M6","M7"],dorian:["P1","M2","m3","P4","P5","M6","m7"],phrygian:["P1","m2","m3","P4","P5","m6","m7"],lydian:["P1","M2","M3","A4","P5","M6","M7"],mixolydian:["P1","M2","M3","P4","P5","M6","m7"],aeolian:["P1","M2","m3","P4","P5","m6","m7"],locrian:["P1","m2","m3","P4","d5","m6","m7"]};for(var r in i)Object.freeze(i[r]);var o=function(t){if(t=t.toLowerCase(),!(t in i))throw new Error("Unrecognized mode name:",t);return i[t]};e.exports=o},{}],25:[function(t,e,n){var i=t("./scale.js"),r=t("../pitch/parse-pitch.js"),o=function(t,e){return i(t,e).map(function(t){var e=r(t);return e.letter+e.accidental})};e.exports=o},{"../pitch/parse-pitch.js":33,"./scale.js":26}],26:[function(t,e,n){var i=t("../pitch/plus-interval.js"),r=t("./mode-intervals.js"),o=function(t,e){return e="string"==typeof e?r(e):e,e.map(i(t))};e.exports=o},{"../pitch/plus-interval.js":35,"./mode-intervals.js":24}],27:[function(t,e,n){var i=t("./pitch/pitch.js"),r=t("./pitch/parse-pitch.js"),o=function(t){return t instanceof i?t:r(t)?new i(t):null};o.Pitch=i,o.intervalQuality=t("./pitch/interval-quality.js"),o.intervalSize=t("./pitch/interval-size.js"),o.interval=t("./pitch/interval.js"),o.parseInterval=t("./pitch/parse-interval.js"),o.parsePitch=t("./pitch/parse-pitch.js"),o.plusInterval=t("./pitch/plus-interval.js"),o.semitonesBetween=t("./pitch/semitones-between.js"),o.simplifyIntervalSize=t("./pitch/simplify-interval-size.js"),o.toMidi=t("./pitch/to-midi.js"),o.isHigher=t("./pitch/is-higher.js"),o.sortPitches=t("./pitch/sort-pitches.js"),o.Key=t("./key/key.js"),o.modeIntervals=t("./key/mode-intervals.js"),o.scaleSet=t("./key/scale-set.js"),o.scale=t("./key/scale.js"),n=e.exports=o},{"./key/key.js":23,"./key/mode-intervals.js":24,"./key/scale-set.js":25,"./key/scale.js":26,"./pitch/interval-quality.js":28,"./pitch/interval-size.js":29,"./pitch/interval.js":30,"./pitch/is-higher.js":31,"./pitch/parse-interval.js":32,"./pitch/parse-pitch.js":33,"./pitch/pitch.js":34,"./pitch/plus-interval.js":35,"./pitch/semitones-between.js":36,"./pitch/simplify-interval-size.js":37,"./pitch/sort-pitches.js":38,"./pitch/to-midi.js":39}],28:[function(t,e,n){var i=t("./interval-size.js"),r=t("./semitones-between.js"),o={1:{0:"P",1:"A",11:"d"},2:{0:"d",1:"m",2:"M",3:"A"},3:{2:"d",3:"m",4:"M",5:"A"},4:{4:"d",5:"P",6:"A"},5:{6:"d",7:"P",8:"A"},6:{7:"d",8:"m",9:"M",10:"A"},7:{9:"d",10:"m",11:"M",0:"A"},8:{11:"d",12:"P",13:"A"}},s=function(t,e){var n=i.simple(t,e),s=r(t,e)%12;return o[n][s]};e.exports=s},{"./interval-size.js":29,"./semitones-between.js":36}],29:[function(t,e,n){var i=t("./parse-pitch.js"),r=t("./simplify-interval-size.js"),o="CDEFGAB",s=function(t,e){var n=i(t),r=i(e);if(!n||!r)throw Error("At least one invalid pitch name:",t,e);return Math.abs(o.indexOf(n.letter)-o.indexOf(r.letter)+o.length*(n.octave-r.octave))+1};s.simple=function(t,e){return r(s(t,e))},e.exports=s},{"./parse-pitch.js":33,"./simplify-interval-size.js":37}],30:[function(t,e,n){var i=t("./interval-size.js"),r=t("./interval-quality.js"),o=function(t,e){return r(t,e)+i(t,e)};o.simple=function(t,e){return r(t,e)+i.simple(t,e)},e.exports=o},{"./interval-quality.js":28,"./interval-size.js":29}],31:[function(t,e,n){var i=t("./to-midi.js"),r=function(t,e){return i(t)>i(e)};e.exports=r},{"./to-midi.js":39}],32:[function(t,e,n){var i=t("./simplify-interval-size.js"),r=[1,4,5],o="dAP",s="MmAd",a=7,u=12,l={1:{P:0,A:1,d:-1},2:{d:0,m:1,M:2,A:3},3:{d:2,m:3,M:4,A:5},4:{d:4,P:5,A:6},5:{d:6,P:7,A:8},6:{d:7,m:8,M:9,A:10},7:{d:9,m:10,M:11,A:12}},c=function(t){var e=/^(-)?([dmMAP])?(\d{1,2})$/.exec(String(t));if(!e||"0"===e[3])return!1;var n={};if(n.interval=e[0],n.direction=void 0===e[1]?1:-1,n.quality=void 0===e[2]?null:e[2],n.size=Number(e[3]),n.simpleSize=i(n.size),n.perfectable=r.indexOf(n.simpleSize)>-1,n.simpleSize=i(n.size),n.octaves=Math.floor((n.size-1)/a),null!==n.quality){if(n.perfectable&&-1===o.indexOf(n.quality)||!n.perfectable&&-1===s.indexOf(n.quality))return!1;n.halfsteps=l[n.simpleSize][n.quality]+n.octaves*u}return n};e.exports=c},{"./simplify-interval-size.js":37}],33:[function(t,e,n){var i=function(t){var e=/^([a-gA-G])(b{1,2}|#{1,2})?(\d{1,2})?$/.exec(t);if(!e)return!1;var n={};return n.letter=e[1].toUpperCase(),n.accidental=void 0===e[2]?"":e[2],n.numAccidental=n.accidental.length>0&&"b"===n.accidental[0]?-1*n.accidental.length:n.accidental.length,n.octave=void 0===e[3]?4:Number(e[3]),n.sciPitch=n.letter+n.accidental+n.octave,n};e.exports=i},{}],34:[function(t,e,n){function i(t){if(t instanceof i)return t;if(!(this instanceof i))return new i(t);var e=r(t);if(!e)throw Error("Invalid pitch name: "+t);this.name=e.sciPitch,Object.freeze(this)}var r=t("./parse-pitch.js"),o=t("./to-midi.js"),s=t("./semitones-between.js"),a=t("./interval-size.js"),u=t("./interval.js"),l=t("./plus-interval.js"),c=t("./is-higher.js");i.prototype={constructor:i,toString:function(){return this.name},valueOf:function(){return this.midi()},equals:function(t){return this.name===i(t).name},isEnharmonic:function(t){return this.midi()===i(t).midi()},isHigher:function(t){return c(this.name,i(t).name)},sciPitch:function(){return this.name},letter:function(){return r(this.name).letter},accidental:function(){return r(this.name).accidental},octave:function(){return r(this.name).octave},pitchClass:function(){var t=r(this.name);return t.letter+t.accidental},numAccidental:function(){return r(this.name).numAccidental},midi:function(){return o(this.name)},semitonesTo:function(t){return s(this.name,i(t).name)},intervalSize:function(t){return a(this.name,i(t).name)},simpleIntervalSize:function(t){return a.simple(this.name,i(t).name)},interval:function(t){return u(this.name,i(t).name)},simpleInterval:function(t){return u.simple(this.name,i(t).name)},plusInterval:function(t){return new i(l(this.name,t))}},e.exports=i},{"./interval-size.js":29,"./interval.js":30,"./is-higher.js":31,"./parse-pitch.js":33,"./plus-interval.js":35,"./semitones-between.js":36,"./to-midi.js":39}],35:[function(t,e,n){var i=t("./parse-pitch.js"),r=t("./parse-interval.js"),o=t("./semitones-between.js"),s="CDEFGAB",a={"-2":"bb","-1":"b",0:"",1:"#",2:"##"},u=function(t,e){if(1===arguments.length){var n=arguments[0];return function(t){return i(n)!==!1?u(n,t):u(t,n)}}var l=i(t),c=r(e);if(!l||!c)throw new Error("Invalid pitch or interval:",t,e);if(1===c.size&&c.quality){if("P"===c.quality)return l.sciPitch;var h=1===c.direction?"":"-",f=1===c.direction?"-":"";if("A"===c.quality)return u(u(l.sciPitch,h+"M2"),f+"m2");if("d"===c.quality)return u(u(l.sciPitch,h+"m2"),f+"M2")}var p=s.indexOf(l.letter)+(c.simpleSize-1)*c.direction;p>=s.length?(c.octaves+=1,p%=s.length):0>p&&(c.octaves+=1,p+=s.length);var d=s[p]+String(c.direction*c.octaves+l.octave);if(null===c.quality)return d;var g=c.direction*(c.halfsteps-o(l.sciPitch,d));return s[p]+a[g]+String(c.direction*c.octaves+l.octave)};e.exports=u},{"./parse-interval.js":32,"./parse-pitch.js":33,"./semitones-between.js":36}],36:[function(t,e,n){var i=t("./to-midi.js"),r=function(t,e){return Math.abs(i(t)-i(e))};e.exports=r},{"./to-midi.js":39}],37:[function(t,e,n){var i=7,r=function(t){if(0===t)throw new Error("0 is not a valid interval size");var e=1;return 0>t&&(e*=-1),(t-e)%i+e};e.exports=r},{}],38:[function(t,e,n){function i(t){return t.map(r).sort(function(t,e){return t-e}).map(function(t){return t.sciPitch()})}var r=t("./pitch.js");e.exports=i},{"./pitch.js":34}],39:[function(t,e,n){var i=t("./parse-pitch.js"),r={C:0,D:2,E:4,F:5,G:7,A:9,B:11},o=12,s=function(t){var e=i(t);if(!e)throw Error("Invalid pitch name: "+t);return r[e.letter]+o*(e.octave+1)+e.numAccidental};e.exports=s},{"./parse-pitch.js":33}],40:[function(t,e,n){!function(){function t(t){return t&&(t.ownerDocument||t.document||t).documentElement}function n(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}function i(t,e){return e>t?-1:t>e?1:t>=e?0:NaN}function r(t){return null===t?NaN:+t}function o(t){return!isNaN(t)}function s(t){return{left:function(e,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=e.length);r>i;){var o=i+r>>>1;t(e[o],n)<0?i=o+1:r=o}return i},right:function(e,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=e.length);r>i;){var o=i+r>>>1;t(e[o],n)>0?r=o:i=o+1}return i}}}function a(t){return t.length}function u(t){for(var e=1;t*e%1;)e*=10;return e}function l(t,e){for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}function c(){this._=Object.create(null)}function h(t){return(t+="")===ys||t[0]===ms?ms+t:t}function f(t){return(t+="")[0]===ms?t.slice(1):t}function p(t){return h(t)in this._}function d(t){return(t=h(t))in this._&&delete this._[t]}function g(){var t=[];for(var e in this._)t.push(f(e));return t}function y(){var t=0;for(var e in this._)++t;return t}function m(){for(var t in this._)return!1;return!0}function v(){this._=Object.create(null)}function _(t){return t}function w(t,e,n){return function(){var i=n.apply(e,arguments);return i===e?t:i}}function b(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var n=0,i=vs.length;i>n;++n){var r=vs[n]+e;if(r in t)return r}}function x(){}function S(){}function M(t){function e(){for(var e,i=n,r=-1,o=i.length;++r<o;)(e=i[r].on)&&e.apply(this,arguments);return t}var n=[],i=new c;return e.on=function(e,r){var o,s=i.get(e);return arguments.length<2?s&&s.on:(s&&(s.on=null,n=n.slice(0,o=n.indexOf(s)).concat(n.slice(o+1)),i.remove(e)),r&&n.push(i.set(e,{on:r})),t)},e}function T(){is.event.preventDefault()}function A(){for(var t,e=is.event;t=e.sourceEvent;)e=t;return e}function E(t){for(var e=new S,n=0,i=arguments.length;++n<i;)e[arguments[n]]=M(e);return e.of=function(n,i){return function(r){try{var o=r.sourceEvent=is.event;r.target=t,is.event=r,e[r.type].apply(n,i)}finally{is.event=o}}},e}function k(t){return ws(t,Ms),t}function j(t){return"function"==typeof t?t:function(){return bs(t,this)}}function q(t){return"function"==typeof t?t:function(){return xs(t,this)}}function P(t,e){function n(){this.removeAttribute(t)}function i(){this.removeAttributeNS(t.space,t.local)}function r(){this.setAttribute(t,e)}function o(){this.setAttributeNS(t.space,t.local,e)}function s(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}function a(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}return t=is.ns.qualify(t),null==e?t.local?i:n:"function"==typeof e?t.local?a:s:t.local?o:r}function O(t){return t.trim().replace(/\s+/g," ")}function F(t){return new RegExp("(?:^|\\s+)"+is.requote(t)+"(?:\\s+|$)","g")}function R(t){return(t+"").trim().split(/^|\s+/)}function N(t,e){function n(){for(var n=-1;++n<r;)t[n](this,e)}function i(){for(var n=-1,i=e.apply(this,arguments);++n<r;)t[n](this,i)}t=R(t).map(C);var r=t.length;return"function"==typeof e?i:n}function C(t){var e=F(t);return function(n,i){if(r=n.classList)return i?r.add(t):r.remove(t);var r=n.getAttribute("class")||"";i?(e.lastIndex=0,e.test(r)||n.setAttribute("class",O(r+" "+t))):n.setAttribute("class",O(r.replace(e," ")))}}function L(t,e,n){function i(){this.style.removeProperty(t)}function r(){this.style.setProperty(t,e,n)}function o(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}return null==e?i:"function"==typeof e?o:r}function D(t,e){function n(){delete this[t]}function i(){this[t]=e}function r(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}return null==e?n:"function"==typeof e?r:i}function B(t){function e(){var e=this.ownerDocument,n=this.namespaceURI;return n?e.createElementNS(n,t):e.createElement(t)}function n(){return this.ownerDocument.createElementNS(t.space,t.local)}return"function"==typeof t?t:(t=is.ns.qualify(t)).local?n:e}function z(){var t=this.parentNode;t&&t.removeChild(this)}function I(t){return{__data__:t}}function U(t){return function(){return Ss(this,t)}}function G(t){return arguments.length||(t=i),function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}}function V(t,e){for(var n=0,i=t.length;i>n;n++)for(var r,o=t[n],s=0,a=o.length;a>s;s++)(r=o[s])&&e(r,s,n);return t}function W(t){return ws(t,As),t}function Y(t){var e,n;return function(i,r,o){var s,a=t[o].update,u=a.length;for(o!=n&&(n=o,e=0),r>=e&&(e=r+1);!(s=a[e])&&++e<u;);return s}}function Q(t,e,n){function i(){var e=this[s];e&&(this.removeEventListener(t,e,e.$),delete this[s])}function r(){var r=u(e,os(arguments));i.call(this),this.addEventListener(t,this[s]=r,r.$=n),r._=e}function o(){var e,n=new RegExp("^__on([^.]+)"+is.requote(t)+"$");for(var i in this)if(e=i.match(n)){var r=this[i];this.removeEventListener(e[1],r,r.$),delete this[i]}}var s="__on"+t,a=t.indexOf("."),u=H;a>0&&(t=t.slice(0,a));var l=Es.get(t);return l&&(t=l,u=$),a?e?r:i:e?x:o}function H(t,e){return function(n){var i=is.event;is.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{is.event=i}}}function $(t,e){var n=H(t,e);return function(t){var e=this,i=t.relatedTarget;i&&(i===e||8&i.compareDocumentPosition(e))||n.call(e,t)}}function Z(e){var i=".dragsuppress-"+ ++js,r="click"+i,o=is.select(n(e)).on("touchmove"+i,T).on("dragstart"+i,T).on("selectstart"+i,T);if(null==ks&&(ks="onselectstart"in e?!1:b(e.style,"userSelect")),ks){var s=t(e).style,a=s[ks];s[ks]="none"}return function(t){if(o.on(i,null),ks&&(s[ks]=a),t){var e=function(){o.on(r,null)};o.on(r,function(){T(),e()},!0),setTimeout(e,0)}}}function X(t,e){e.changedTouches&&(e=e.changedTouches[0]);var i=t.ownerSVGElement||t;if(i.createSVGPoint){var r=i.createSVGPoint();if(0>qs){var o=n(t);if(o.scrollX||o.scrollY){i=is.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var s=i[0][0].getScreenCTM();qs=!(s.f||s.e),i.remove()}}return qs?(r.x=e.pageX,r.y=e.pageY):(r.x=e.clientX,r.y=e.clientY),r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y];
}var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}function J(){return is.event.changedTouches[0].identifier}function K(t){return t>0?1:0>t?-1:0}function tt(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function et(t){return t>1?0:-1>t?Fs:Math.acos(t)}function nt(t){return t>1?Cs:-1>t?-Cs:Math.asin(t)}function it(t){return((t=Math.exp(t))-1/t)/2}function rt(t){return((t=Math.exp(t))+1/t)/2}function ot(t){return((t=Math.exp(2*t))-1)/(t+1)}function st(t){return(t=Math.sin(t/2))*t}function at(){}function ut(t,e,n){return this instanceof ut?(this.h=+t,this.s=+e,void(this.l=+n)):arguments.length<2?t instanceof ut?new ut(t.h,t.s,t.l):xt(""+t,St,ut):new ut(t,e,n)}function lt(t,e,n){function i(t){return t>360?t-=360:0>t&&(t+=360),60>t?o+(s-o)*t/60:180>t?s:240>t?o+(s-o)*(240-t)/60:o}function r(t){return Math.round(255*i(t))}var o,s;return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:0>e?0:e>1?1:e,n=0>n?0:n>1?1:n,s=.5>=n?n*(1+e):n+e-n*e,o=2*n-s,new vt(r(t+120),r(t),r(t-120))}function ct(t,e,n){return this instanceof ct?(this.h=+t,this.c=+e,void(this.l=+n)):arguments.length<2?t instanceof ct?new ct(t.h,t.c,t.l):t instanceof ft?dt(t.l,t.a,t.b):dt((t=Mt((t=is.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new ct(t,e,n)}function ht(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new ft(n,Math.cos(t*=Ls)*e,Math.sin(t)*e)}function ft(t,e,n){return this instanceof ft?(this.l=+t,this.a=+e,void(this.b=+n)):arguments.length<2?t instanceof ft?new ft(t.l,t.a,t.b):t instanceof ct?ht(t.h,t.c,t.l):Mt((t=vt(t)).r,t.g,t.b):new ft(t,e,n)}function pt(t,e,n){var i=(t+16)/116,r=i+e/500,o=i-n/200;return r=gt(r)*Hs,i=gt(i)*$s,o=gt(o)*Zs,new vt(mt(3.2404542*r-1.5371385*i-.4985314*o),mt(-.969266*r+1.8760108*i+.041556*o),mt(.0556434*r-.2040259*i+1.0572252*o))}function dt(t,e,n){return t>0?new ct(Math.atan2(n,e)*Ds,Math.sqrt(e*e+n*n),t):new ct(NaN,NaN,t)}function gt(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function yt(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function mt(t){return Math.round(255*(.00304>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function vt(t,e,n){return this instanceof vt?(this.r=~~t,this.g=~~e,void(this.b=~~n)):arguments.length<2?t instanceof vt?new vt(t.r,t.g,t.b):xt(""+t,vt,lt):new vt(t,e,n)}function _t(t){return new vt(t>>16,t>>8&255,255&t)}function wt(t){return _t(t)+""}function bt(t){return 16>t?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function xt(t,e,n){t=t.toLowerCase();var i,r,o,s=0,a=0,u=0;if(i=/([a-z]+)\((.*)\)/.exec(t))switch(r=i[2].split(","),i[1]){case"hsl":return n(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return e(At(r[0]),At(r[1]),At(r[2]))}return(o=Ks.get(t))?e(o.r,o.g,o.b):(null==t||"#"!==t.charAt(0)||isNaN(o=parseInt(t.slice(1),16))||(4===t.length?(s=(3840&o)>>4,s=s>>4|s,a=240&o,a=a>>4|a,u=15&o,u=u<<4|u):7===t.length&&(s=(16711680&o)>>16,a=(65280&o)>>8,u=255&o)),e(s,a,u))}function St(t,e,n){var i,r,o=Math.min(t/=255,e/=255,n/=255),s=Math.max(t,e,n),a=s-o,u=(s+o)/2;return a?(r=.5>u?a/(s+o):a/(2-s-o),i=t==s?(e-n)/a+(n>e?6:0):e==s?(n-t)/a+2:(t-e)/a+4,i*=60):(i=NaN,r=u>0&&1>u?0:i),new ut(i,r,u)}function Mt(t,e,n){t=Tt(t),e=Tt(e),n=Tt(n);var i=yt((.4124564*t+.3575761*e+.1804375*n)/Hs),r=yt((.2126729*t+.7151522*e+.072175*n)/$s),o=yt((.0193339*t+.119192*e+.9503041*n)/Zs);return ft(116*r-16,500*(i-r),200*(r-o))}function Tt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function At(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function Et(t){return"function"==typeof t?t:function(){return t}}function kt(t){return function(e,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=null),jt(e,n,t,i)}}function jt(t,e,n,i){function r(){var t,e=u.status;if(!e&&Pt(u)||e>=200&&300>e||304===e){try{t=n.call(o,u)}catch(i){return void s.error.call(o,i)}s.load.call(o,t)}else s.error.call(o,u)}var o={},s=is.dispatch("beforesend","progress","load","error"),a={},u=new XMLHttpRequest,l=null;return!this.XDomainRequest||"withCredentials"in u||!/^(http(s)?:)?\/\//.test(t)||(u=new XDomainRequest),"onload"in u?u.onload=u.onerror=r:u.onreadystatechange=function(){u.readyState>3&&r()},u.onprogress=function(t){var e=is.event;is.event=t;try{s.progress.call(o,u)}finally{is.event=e}},o.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?a[t]:(null==e?delete a[t]:a[t]=e+"",o)},o.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",o):e},o.responseType=function(t){return arguments.length?(l=t,o):l},o.response=function(t){return n=t,o},["get","post"].forEach(function(t){o[t]=function(){return o.send.apply(o,[t].concat(os(arguments)))}}),o.send=function(n,i,r){if(2===arguments.length&&"function"==typeof i&&(r=i,i=null),u.open(n,t,!0),null==e||"accept"in a||(a.accept=e+",*/*"),u.setRequestHeader)for(var c in a)u.setRequestHeader(c,a[c]);return null!=e&&u.overrideMimeType&&u.overrideMimeType(e),null!=l&&(u.responseType=l),null!=r&&o.on("error",r).on("load",function(t){r(null,t)}),s.beforesend.call(o,u),u.send(null==i?null:i),o},o.abort=function(){return u.abort(),o},is.rebind(o,s,"on"),null==i?o:o.get(qt(i))}function qt(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}function Pt(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}function Ot(){var t=Ft(),e=Rt()-t;e>24?(isFinite(e)&&(clearTimeout(ia),ia=setTimeout(Ot,e)),na=0):(na=1,oa(Ot))}function Ft(){var t=Date.now();for(ra=ta;ra;)t>=ra.t&&(ra.f=ra.c(t-ra.t)),ra=ra.n;return t}function Rt(){for(var t,e=ta,n=1/0;e;)e.f?e=t?t.n=e.n:ta=e.n:(e.t<n&&(n=e.t),e=(t=e).n);return ea=t,n}function Nt(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function Ct(t,e){var n=Math.pow(10,3*gs(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}function Lt(t){var e=t.decimal,n=t.thousands,i=t.grouping,r=t.currency,o=i&&n?function(t,e){for(var r=t.length,o=[],s=0,a=i[0],u=0;r>0&&a>0&&(u+a+1>e&&(a=Math.max(1,e-u)),o.push(t.substring(r-=a,r+a)),!((u+=a+1)>e));)a=i[s=(s+1)%i.length];return o.reverse().join(n)}:_;return function(t){var n=aa.exec(t),i=n[1]||" ",s=n[2]||">",a=n[3]||"-",u=n[4]||"",l=n[5],c=+n[6],h=n[7],f=n[8],p=n[9],d=1,g="",y="",m=!1,v=!0;switch(f&&(f=+f.substring(1)),(l||"0"===i&&"="===s)&&(l=i="0",s="="),p){case"n":h=!0,p="g";break;case"%":d=100,y="%",p="f";break;case"p":d=100,y="%",p="r";break;case"b":case"o":case"x":case"X":"#"===u&&(g="0"+p.toLowerCase());case"c":v=!1;case"d":m=!0,f=0;break;case"s":d=-1,p="r"}"$"===u&&(g=r[0],y=r[1]),"r"!=p||f||(p="g"),null!=f&&("g"==p?f=Math.max(1,Math.min(21,f)):("e"==p||"f"==p)&&(f=Math.max(0,Math.min(20,f)))),p=ua.get(p)||Dt;var _=l&&h;return function(t){var n=y;if(m&&t%1)return"";var r=0>t||0===t&&0>1/t?(t=-t,"-"):"-"===a?"":a;if(0>d){var u=is.formatPrefix(t,f);t=u.scale(t),n=u.symbol+y}else t*=d;t=p(t,f);var w,b,x=t.lastIndexOf(".");if(0>x){var S=v?t.lastIndexOf("e"):-1;0>S?(w=t,b=""):(w=t.substring(0,S),b=t.substring(S))}else w=t.substring(0,x),b=e+t.substring(x+1);!l&&h&&(w=o(w,1/0));var M=g.length+w.length+b.length+(_?0:r.length),T=c>M?new Array(M=c-M+1).join(i):"";return _&&(w=o(T+w,T.length?c-b.length:1/0)),r+=g,t=w+b,("<"===s?r+t+T:">"===s?T+r+t:"^"===s?T.substring(0,M>>=1)+r+t+T.substring(M):r+(_?t:T+t))+n}}}function Dt(t){return t+""}function Bt(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function zt(t,e,n){function i(e){var n=t(e),i=o(n,1);return i-e>e-n?n:i}function r(n){return e(n=t(new ca(n-1)),1),n}function o(t,n){return e(t=new ca(+t),n),t}function s(t,i,o){var s=r(t),a=[];if(o>1)for(;i>s;)n(s)%o||a.push(new Date(+s)),e(s,1);else for(;i>s;)a.push(new Date(+s)),e(s,1);return a}function a(t,e,n){try{ca=Bt;var i=new Bt;return i._=t,s(i,e,n)}finally{ca=Date}}t.floor=t,t.round=i,t.ceil=r,t.offset=o,t.range=s;var u=t.utc=It(t);return u.floor=u,u.round=It(i),u.ceil=It(r),u.offset=It(o),u.range=a,t}function It(t){return function(e,n){try{ca=Bt;var i=new Bt;return i._=e,t(i,n)._}finally{ca=Date}}}function Ut(t){function e(t){function e(e){for(var n,r,o,s=[],a=-1,u=0;++a<i;)37===t.charCodeAt(a)&&(s.push(t.slice(u,a)),null!=(r=fa[n=t.charAt(++a)])&&(n=t.charAt(++a)),(o=k[n])&&(n=o(e,null==r?"e"===n?" ":"0":r)),s.push(n),u=a+1);return s.push(t.slice(u,a)),s.join("")}var i=t.length;return e.parse=function(e){var i={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},r=n(i,t,e,0);if(r!=e.length)return null;"p"in i&&(i.H=i.H%12+12*i.p);var o=null!=i.Z&&ca!==Bt,s=new(o?Bt:ca);return"j"in i?s.setFullYear(i.y,0,i.j):"w"in i&&("W"in i||"U"in i)?(s.setFullYear(i.y,0,1),s.setFullYear(i.y,0,"W"in i?(i.w+6)%7+7*i.W-(s.getDay()+5)%7:i.w+7*i.U-(s.getDay()+6)%7)):s.setFullYear(i.y,i.m,i.d),s.setHours(i.H+(i.Z/100|0),i.M+i.Z%100,i.S,i.L),o?s._:s},e.toString=function(){return t},e}function n(t,e,n,i){for(var r,o,s,a=0,u=e.length,l=n.length;u>a;){if(i>=l)return-1;if(r=e.charCodeAt(a++),37===r){if(s=e.charAt(a++),o=j[s in fa?e.charAt(a++):s],!o||(i=o(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}function i(t,e,n){x.lastIndex=0;var i=x.exec(e.slice(n));return i?(t.w=S.get(i[0].toLowerCase()),n+i[0].length):-1}function r(t,e,n){w.lastIndex=0;var i=w.exec(e.slice(n));return i?(t.w=b.get(i[0].toLowerCase()),n+i[0].length):-1}function o(t,e,n){A.lastIndex=0;var i=A.exec(e.slice(n));return i?(t.m=E.get(i[0].toLowerCase()),n+i[0].length):-1}function s(t,e,n){M.lastIndex=0;var i=M.exec(e.slice(n));return i?(t.m=T.get(i[0].toLowerCase()),n+i[0].length):-1}function a(t,e,i){return n(t,k.c.toString(),e,i)}function u(t,e,i){return n(t,k.x.toString(),e,i)}function l(t,e,i){return n(t,k.X.toString(),e,i)}function c(t,e,n){var i=_.get(e.slice(n,n+=2).toLowerCase());return null==i?-1:(t.p=i,n)}var h=t.dateTime,f=t.date,p=t.time,d=t.periods,g=t.days,y=t.shortDays,m=t.months,v=t.shortMonths;e.utc=function(t){function n(t){try{ca=Bt;var e=new ca;return e._=t,i(e)}finally{ca=Date}}var i=e(t);return n.parse=function(t){try{ca=Bt;var e=i.parse(t);return e&&e._}finally{ca=Date}},n.toString=i.toString,n},e.multi=e.utc.multi=ue;var _=is.map(),w=Vt(g),b=Wt(g),x=Vt(y),S=Wt(y),M=Vt(m),T=Wt(m),A=Vt(v),E=Wt(v);d.forEach(function(t,e){_.set(t.toLowerCase(),e)});var k={a:function(t){return y[t.getDay()]},A:function(t){return g[t.getDay()]},b:function(t){return v[t.getMonth()]},B:function(t){return m[t.getMonth()]},c:e(h),d:function(t,e){return Gt(t.getDate(),e,2)},e:function(t,e){return Gt(t.getDate(),e,2)},H:function(t,e){return Gt(t.getHours(),e,2)},I:function(t,e){return Gt(t.getHours()%12||12,e,2)},j:function(t,e){return Gt(1+la.dayOfYear(t),e,3)},L:function(t,e){return Gt(t.getMilliseconds(),e,3)},m:function(t,e){return Gt(t.getMonth()+1,e,2)},M:function(t,e){return Gt(t.getMinutes(),e,2)},p:function(t){return d[+(t.getHours()>=12)]},S:function(t,e){return Gt(t.getSeconds(),e,2)},U:function(t,e){return Gt(la.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return Gt(la.mondayOfYear(t),e,2)},x:e(f),X:e(p),y:function(t,e){return Gt(t.getFullYear()%100,e,2)},Y:function(t,e){return Gt(t.getFullYear()%1e4,e,4)},Z:se,"%":function(){return"%"}},j={a:i,A:r,b:o,B:s,c:a,d:te,e:te,H:ne,I:ne,j:ee,L:oe,m:Kt,M:ie,p:c,S:re,U:Qt,w:Yt,W:Ht,x:u,X:l,y:Zt,Y:$t,Z:Xt,"%":ae};return e}function Gt(t,e,n){var i=0>t?"-":"",r=(i?-t:t)+"",o=r.length;return i+(n>o?new Array(n-o+1).join(e)+r:r)}function Vt(t){return new RegExp("^(?:"+t.map(is.requote).join("|")+")","i")}function Wt(t){for(var e=new c,n=-1,i=t.length;++n<i;)e.set(t[n].toLowerCase(),n);return e}function Yt(t,e,n){pa.lastIndex=0;var i=pa.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function Qt(t,e,n){pa.lastIndex=0;var i=pa.exec(e.slice(n));return i?(t.U=+i[0],n+i[0].length):-1}function Ht(t,e,n){pa.lastIndex=0;var i=pa.exec(e.slice(n));return i?(t.W=+i[0],n+i[0].length):-1}function $t(t,e,n){pa.lastIndex=0;var i=pa.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function Zt(t,e,n){pa.lastIndex=0;var i=pa.exec(e.slice(n,n+2));return i?(t.y=Jt(+i[0]),n+i[0].length):-1}function Xt(t,e,n){return/^[+-]\d{4}$/.test(e=e.slice(n,n+5))?(t.Z=-e,n+5):-1}function Jt(t){return t+(t>68?1900:2e3)}function Kt(t,e,n){pa.lastIndex=0;var i=pa.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function te(t,e,n){pa.lastIndex=0;var i=pa.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function ee(t,e,n){pa.lastIndex=0;var i=pa.exec(e.slice(n,n+3));return i?(t.j=+i[0],n+i[0].length):-1}function ne(t,e,n){pa.lastIndex=0;var i=pa.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function ie(t,e,n){pa.lastIndex=0;var i=pa.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function re(t,e,n){pa.lastIndex=0;var i=pa.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function oe(t,e,n){pa.lastIndex=0;var i=pa.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function se(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",i=gs(e)/60|0,r=gs(e)%60;return n+Gt(i,"0",2)+Gt(r,"0",2)}function ae(t,e,n){da.lastIndex=0;var i=da.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function ue(t){for(var e=t.length,n=-1;++n<e;)t[n][0]=this(t[n][0]);return function(e){for(var n=0,i=t[n];!i[1](e);)i=t[++n];return i[0](e)}}function le(){}function ce(t,e,n){var i=n.s=t+e,r=i-t,o=i-r;n.t=t-o+(e-r)}function he(t,e){t&&va.hasOwnProperty(t.type)&&va[t.type](t,e)}function fe(t,e,n){var i,r=-1,o=t.length-n;for(e.lineStart();++r<o;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function pe(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)fe(t[n],e,1);e.polygonEnd()}function de(){function t(t,e){t*=Ls,e=e*Ls/2+Fs/4;var n=t-i,s=n>=0?1:-1,a=s*n,u=Math.cos(e),l=Math.sin(e),c=o*l,h=r*u+c*Math.cos(a),f=c*s*Math.sin(a);wa.add(Math.atan2(f,h)),i=t,r=u,o=l}var e,n,i,r,o;ba.point=function(s,a){ba.point=t,i=(e=s)*Ls,r=Math.cos(a=(n=a)*Ls/2+Fs/4),o=Math.sin(a)},ba.lineEnd=function(){t(e,n)}}function ge(t){var e=t[0],n=t[1],i=Math.cos(n);return[i*Math.cos(e),i*Math.sin(e),Math.sin(n)]}function ye(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function me(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function ve(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function _e(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function we(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function be(t){return[Math.atan2(t[1],t[0]),nt(t[2])]}function xe(t,e){return gs(t[0]-e[0])<Ps&&gs(t[1]-e[1])<Ps}function Se(t,e){t*=Ls;var n=Math.cos(e*=Ls);Me(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function Me(t,e,n){++xa,Ma+=(t-Ma)/xa,Ta+=(e-Ta)/xa,Aa+=(n-Aa)/xa}function Te(){function t(t,r){t*=Ls;var o=Math.cos(r*=Ls),s=o*Math.cos(t),a=o*Math.sin(t),u=Math.sin(r),l=Math.atan2(Math.sqrt((l=n*u-i*a)*l+(l=i*s-e*u)*l+(l=e*a-n*s)*l),e*s+n*a+i*u);Sa+=l,Ea+=l*(e+(e=s)),ka+=l*(n+(n=a)),ja+=l*(i+(i=u)),Me(e,n,i)}var e,n,i;Fa.point=function(r,o){r*=Ls;var s=Math.cos(o*=Ls);e=s*Math.cos(r),n=s*Math.sin(r),i=Math.sin(o),Fa.point=t,Me(e,n,i)}}function Ae(){Fa.point=Se}function Ee(){function t(t,e){t*=Ls;var n=Math.cos(e*=Ls),s=n*Math.cos(t),a=n*Math.sin(t),u=Math.sin(e),l=r*u-o*a,c=o*s-i*u,h=i*a-r*s,f=Math.sqrt(l*l+c*c+h*h),p=i*s+r*a+o*u,d=f&&-et(p)/f,g=Math.atan2(f,p);qa+=d*l,Pa+=d*c,Oa+=d*h,Sa+=g,Ea+=g*(i+(i=s)),ka+=g*(r+(r=a)),ja+=g*(o+(o=u)),Me(i,r,o)}var e,n,i,r,o;Fa.point=function(s,a){e=s,n=a,Fa.point=t,s*=Ls;var u=Math.cos(a*=Ls);i=u*Math.cos(s),r=u*Math.sin(s),o=Math.sin(a),Me(i,r,o)},Fa.lineEnd=function(){t(e,n),Fa.lineEnd=Ae,Fa.point=Se}}function ke(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return n=e.invert(n,i),n&&t.invert(n[0],n[1])}),n}function je(){return!0}function qe(t,e,n,i,r){var o=[],s=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],i=t[e];if(xe(n,i)){r.lineStart();for(var a=0;e>a;++a)r.point((n=t[a])[0],n[1]);return void r.lineEnd()}var u=new Oe(n,t,null,!0),l=new Oe(n,null,u,!1);u.o=l,o.push(u),s.push(l),u=new Oe(i,t,null,!1),l=new Oe(i,null,u,!0),u.o=l,o.push(u),s.push(l)}}),s.sort(e),Pe(o),Pe(s),o.length){for(var a=0,u=n,l=s.length;l>a;++a)s[a].e=u=!u;for(var c,h,f=o[0];;){for(var p=f,d=!0;p.v;)if((p=p.n)===f)return;c=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(d)for(var a=0,l=c.length;l>a;++a)r.point((h=c[a])[0],h[1]);else i(p.x,p.n.x,1,r);p=p.n}else{if(d){c=p.p.z;for(var a=c.length-1;a>=0;--a)r.point((h=c[a])[0],h[1])}else i(p.x,p.p.x,-1,r);p=p.p}p=p.o,c=p.z,d=!d}while(!p.v);r.lineEnd()}}}function Pe(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function Oe(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function Fe(t,e,n,i){return function(r,o){function s(e,n){var i=r(e,n);t(e=i[0],n=i[1])&&o.point(e,n)}function a(t,e){var n=r(t,e);y.point(n[0],n[1])}function u(){v.point=a,y.lineStart()}function l(){v.point=s,y.lineEnd()}function c(t,e){g.push([t,e]);var n=r(t,e);w.point(n[0],n[1])}function h(){w.lineStart(),g=[]}function f(){c(g[0][0],g[0][1]),w.lineEnd();var t,e=w.clean(),n=_.buffer(),i=n.length;if(g.pop(),d.push(g),g=null,i)if(1&e){t=n[0];var r,i=t.length-1,s=-1;if(i>0){for(b||(o.polygonStart(),b=!0),o.lineStart();++s<i;)o.point((r=t[s])[0],r[1]);o.lineEnd()}}else i>1&&2&e&&n.push(n.pop().concat(n.shift())),p.push(n.filter(Re))}var p,d,g,y=e(o),m=r.invert(i[0],i[1]),v={point:s,lineStart:u,lineEnd:l,polygonStart:function(){v.point=c,v.lineStart=h,v.lineEnd=f,p=[],d=[]},polygonEnd:function(){v.point=s,v.lineStart=u,v.lineEnd=l,p=is.merge(p);var t=ze(m,d);p.length?(b||(o.polygonStart(),b=!0),qe(p,Ce,t,n,o)):t&&(b||(o.polygonStart(),b=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),b&&(o.polygonEnd(),b=!1),p=d=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}},_=Ne(),w=e(_),b=!1;return v}}function Re(t){return t.length>1}function Ne(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:x,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function Ce(t,e){return((t=t.x)[0]<0?t[1]-Cs-Ps:Cs-t[1])-((e=e.x)[0]<0?e[1]-Cs-Ps:Cs-e[1])}function Le(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var a=o>0?Fs:-Fs,u=gs(o-n);gs(u-Fs)<Ps?(t.point(n,i=(i+s)/2>0?Cs:-Cs),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),t.point(o,i),e=0):r!==a&&u>=Fs&&(gs(n-r)<Ps&&(n-=r*Ps),gs(o-a)<Ps&&(o-=a*Ps),i=De(n,i,o,s),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),e=0),t.point(n=o,i=s),r=a},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}}function De(t,e,n,i){var r,o,s=Math.sin(t-n);return gs(s)>Ps?Math.atan((Math.sin(e)*(o=Math.cos(i))*Math.sin(n)-Math.sin(i)*(r=Math.cos(e))*Math.sin(t))/(r*o*s)):(e+i)/2}function Be(t,e,n,i){var r;if(null==t)r=n*Cs,i.point(-Fs,r),i.point(0,r),i.point(Fs,r),i.point(Fs,0),i.point(Fs,-r),i.point(0,-r),i.point(-Fs,-r),i.point(-Fs,0),i.point(-Fs,r);else if(gs(t[0]-e[0])>Ps){var o=t[0]<e[0]?Fs:-Fs;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(e[0],e[1])}function ze(t,e){var n=t[0],i=t[1],r=[Math.sin(n),-Math.cos(n),0],o=0,s=0;wa.reset();for(var a=0,u=e.length;u>a;++a){var l=e[a],c=l.length;if(c)for(var h=l[0],f=h[0],p=h[1]/2+Fs/4,d=Math.sin(p),g=Math.cos(p),y=1;;){y===c&&(y=0),t=l[y];var m=t[0],v=t[1]/2+Fs/4,_=Math.sin(v),w=Math.cos(v),b=m-f,x=b>=0?1:-1,S=x*b,M=S>Fs,T=d*_;if(wa.add(Math.atan2(T*x*Math.sin(S),g*w+T*Math.cos(S))),o+=M?b+x*Rs:b,M^f>=n^m>=n){var A=me(ge(h),ge(t));we(A);var E=me(r,A);we(E);var k=(M^b>=0?-1:1)*nt(E[2]);(i>k||i===k&&(A[0]||A[1]))&&(s+=M^b>=0?1:-1)}if(!y++)break;f=m,d=_,g=w,h=t}}return(-Ps>o||Ps>o&&0>wa)^1&s}function Ie(t){function e(t,e){return Math.cos(t)*Math.cos(e)>o}function n(t){var n,o,u,l,c;return{lineStart:function(){l=u=!1,c=1},point:function(h,f){var p,d=[h,f],g=e(h,f),y=s?g?0:r(h,f):g?r(h+(0>h?Fs:-Fs),f):0;if(!n&&(l=u=g)&&t.lineStart(),g!==u&&(p=i(n,d),(xe(n,p)||xe(d,p))&&(d[0]+=Ps,d[1]+=Ps,g=e(d[0],d[1]))),g!==u)c=0,g?(t.lineStart(),p=i(d,n),t.point(p[0],p[1])):(p=i(n,d),t.point(p[0],p[1]),t.lineEnd()),n=p;else if(a&&n&&s^g){var m;y&o||!(m=i(d,n,!0))||(c=0,s?(t.lineStart(),t.point(m[0][0],m[0][1]),t.point(m[1][0],m[1][1]),t.lineEnd()):(t.point(m[1][0],m[1][1]),t.lineEnd(),t.lineStart(),t.point(m[0][0],m[0][1])))}!g||n&&xe(n,d)||t.point(d[0],d[1]),n=d,u=g,o=y},lineEnd:function(){u&&t.lineEnd(),n=null},clean:function(){return c|(l&&u)<<1}}}function i(t,e,n){var i=ge(t),r=ge(e),s=[1,0,0],a=me(i,r),u=ye(a,a),l=a[0],c=u-l*l;if(!c)return!n&&t;var h=o*u/c,f=-o*l/c,p=me(s,a),d=_e(s,h),g=_e(a,f);ve(d,g);var y=p,m=ye(d,y),v=ye(y,y),_=m*m-v*(ye(d,d)-1);if(!(0>_)){var w=Math.sqrt(_),b=_e(y,(-m-w)/v);if(ve(b,d),b=be(b),!n)return b;var x,S=t[0],M=e[0],T=t[1],A=e[1];S>M&&(x=S,S=M,M=x);var E=M-S,k=gs(E-Fs)<Ps,j=k||Ps>E;if(!k&&T>A&&(x=T,T=A,A=x),j?k?T+A>0^b[1]<(gs(b[0]-S)<Ps?T:A):T<=b[1]&&b[1]<=A:E>Fs^(S<=b[0]&&b[0]<=M)){var q=_e(y,(-m+w)/v);return ve(q,d),[b,be(q)]}}}function r(e,n){var i=s?t:Fs-t,r=0;return-i>e?r|=1:e>i&&(r|=2),-i>n?r|=4:n>i&&(r|=8),r}var o=Math.cos(t),s=o>0,a=gs(o)>Ps,u=gn(t,6*Ls);return Fe(e,n,u,s?[0,-t]:[-Fs,t-Fs])}function Ue(t,e,n,i){return function(r){var o,s=r.a,a=r.b,u=s.x,l=s.y,c=a.x,h=a.y,f=0,p=1,d=c-u,g=h-l;if(o=t-u,d||!(o>0)){if(o/=d,0>d){if(f>o)return;p>o&&(p=o)}else if(d>0){if(o>p)return;o>f&&(f=o)}if(o=n-u,d||!(0>o)){if(o/=d,0>d){if(o>p)return;o>f&&(f=o)}else if(d>0){if(f>o)return;p>o&&(p=o)}if(o=e-l,g||!(o>0)){if(o/=g,0>g){if(f>o)return;p>o&&(p=o)}else if(g>0){if(o>p)return;o>f&&(f=o)}if(o=i-l,g||!(0>o)){if(o/=g,0>g){if(o>p)return;o>f&&(f=o)}else if(g>0){if(f>o)return;p>o&&(p=o)}return f>0&&(r.a={x:u+f*d,y:l+f*g}),1>p&&(r.b={x:u+p*d,y:l+p*g}),r}}}}}}function Ge(t,e,n,i){function r(i,r){return gs(i[0]-t)<Ps?r>0?0:3:gs(i[0]-n)<Ps?r>0?2:1:gs(i[1]-e)<Ps?r>0?1:0:r>0?3:2}function o(t,e){return s(t.x,e.x)}function s(t,e){var n=r(t,1),i=r(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(a){function u(t){for(var e=0,n=y.length,i=t[1],r=0;n>r;++r)for(var o,s=1,a=y[r],u=a.length,l=a[0];u>s;++s)o=a[s],l[1]<=i?o[1]>i&&tt(l,o,t)>0&&++e:o[1]<=i&&tt(l,o,t)<0&&--e,l=o;return 0!==e}function l(o,a,u,l){var c=0,h=0;if(null==o||(c=r(o,u))!==(h=r(a,u))||s(o,a)<0^u>0){do l.point(0===c||3===c?t:n,c>1?i:e);while((c=(c+u+4)%4)!==h)}else l.point(a[0],a[1])}function c(r,o){return r>=t&&n>=r&&o>=e&&i>=o}function h(t,e){c(t,e)&&a.point(t,e)}function f(){j.point=d,y&&y.push(m=[]),M=!0,S=!1,b=x=NaN}function p(){g&&(d(v,_),w&&S&&E.rejoin(),g.push(E.buffer())),j.point=h,S&&a.lineEnd()}function d(t,e){t=Math.max(-Na,Math.min(Na,t)),e=Math.max(-Na,Math.min(Na,e));var n=c(t,e);if(y&&m.push([t,e]),M)v=t,_=e,w=n,M=!1,n&&(a.lineStart(),a.point(t,e));else if(n&&S)a.point(t,e);else{var i={a:{x:b,y:x},b:{x:t,y:e}};k(i)?(S||(a.lineStart(),a.point(i.a.x,i.a.y)),a.point(i.b.x,i.b.y),n||a.lineEnd(),T=!1):n&&(a.lineStart(),a.point(t,e),T=!1)}b=t,x=e,S=n}var g,y,m,v,_,w,b,x,S,M,T,A=a,E=Ne(),k=Ue(t,e,n,i),j={point:h,lineStart:f,lineEnd:p,polygonStart:function(){a=E,g=[],y=[],T=!0},polygonEnd:function(){a=A,g=is.merge(g);var e=u([t,i]),n=T&&e,r=g.length;(n||r)&&(a.polygonStart(),n&&(a.lineStart(),l(null,null,1,a),a.lineEnd()),r&&qe(g,o,e,l,a),a.polygonEnd()),g=y=m=null}};return j}}function Ve(t){var e=0,n=Fs/3,i=an(t),r=i(e,n);return r.parallels=function(t){return arguments.length?i(e=t[0]*Fs/180,n=t[1]*Fs/180):[e/Fs*180,n/Fs*180]},r}function We(t,e){function n(t,e){var n=Math.sqrt(o-2*r*Math.sin(e))/r;return[n*Math.sin(t*=r),s-n*Math.cos(t)]}var i=Math.sin(t),r=(i+Math.sin(e))/2,o=1+i*(2*r-i),s=Math.sqrt(o)/r;return n.invert=function(t,e){var n=s-e;return[Math.atan2(t,n)/r,nt((o-(t*t+n*n)*r*r)/(2*r))]},n}function Ye(){function t(t,e){La+=r*t-i*e,i=t,r=e}var e,n,i,r;Ua.point=function(o,s){Ua.point=t,e=i=o,n=r=s},Ua.lineEnd=function(){t(e,n)}}function Qe(t,e){Da>t&&(Da=t),t>za&&(za=t),Ba>e&&(Ba=e),e>Ia&&(Ia=e)}function He(){function t(t,e){s.push("M",t,",",e,o)}function e(t,e){s.push("M",t,",",e),a.point=n}function n(t,e){s.push("L",t,",",e)}function i(){a.point=t}function r(){s.push("Z")}var o=$e(4.5),s=[],a={point:t,lineStart:function(){a.point=e},lineEnd:i,polygonStart:function(){a.lineEnd=r},polygonEnd:function(){a.lineEnd=i,a.point=t},pointRadius:function(t){return o=$e(t),a},result:function(){if(s.length){var t=s.join("");return s=[],t}}};return a}function $e(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Ze(t,e){Ma+=t,Ta+=e,++Aa}function Xe(){function t(t,i){var r=t-e,o=i-n,s=Math.sqrt(r*r+o*o);Ea+=s*(e+t)/2,ka+=s*(n+i)/2,ja+=s,Ze(e=t,n=i)}var e,n;Va.point=function(i,r){Va.point=t,Ze(e=i,n=r)}}function Je(){Va.point=Ze}function Ke(){function t(t,e){var n=t-i,o=e-r,s=Math.sqrt(n*n+o*o);Ea+=s*(i+t)/2,ka+=s*(r+e)/2,ja+=s,s=r*t-i*e,qa+=s*(i+t),Pa+=s*(r+e),Oa+=3*s,Ze(i=t,r=e)}var e,n,i,r;Va.point=function(o,s){Va.point=t,Ze(e=i=o,n=r=s)},Va.lineEnd=function(){t(e,n)}}function tn(t){function e(e,n){t.moveTo(e+s,n),t.arc(e,n,s,0,Rs)}function n(e,n){t.moveTo(e,n),a.point=i}function i(e,n){t.lineTo(e,n)}function r(){a.point=e}function o(){t.closePath()}var s=4.5,a={point:e,lineStart:function(){a.point=n},lineEnd:r,polygonStart:function(){a.lineEnd=o},polygonEnd:function(){a.lineEnd=r,a.point=e},pointRadius:function(t){return s=t,a},result:x};return a}function en(t){function e(t){return(a?i:n)(t)}function n(e){return on(e,function(n,i){n=t(n,i),e.point(n[0],n[1])})}function i(e){function n(n,i){n=t(n,i),e.point(n[0],n[1])}function i(){_=NaN,M.point=o,e.lineStart()}function o(n,i){var o=ge([n,i]),s=t(n,i);r(_,w,v,b,x,S,_=s[0],w=s[1],v=n,b=o[0],x=o[1],S=o[2],a,e),e.point(_,w)}function s(){M.point=n,e.lineEnd()}function u(){i(),M.point=l,M.lineEnd=c}function l(t,e){o(h=t,f=e),p=_,d=w,g=b,y=x,m=S,M.point=o}function c(){r(_,w,v,b,x,S,p,d,h,g,y,m,a,e),M.lineEnd=s,s()}var h,f,p,d,g,y,m,v,_,w,b,x,S,M={point:n,lineStart:i,lineEnd:s,polygonStart:function(){e.polygonStart(),M.lineStart=u},polygonEnd:function(){e.polygonEnd(),M.lineStart=i}};return M}function r(e,n,i,a,u,l,c,h,f,p,d,g,y,m){var v=c-e,_=h-n,w=v*v+_*_;if(w>4*o&&y--){var b=a+p,x=u+d,S=l+g,M=Math.sqrt(b*b+x*x+S*S),T=Math.asin(S/=M),A=gs(gs(S)-1)<Ps||gs(i-f)<Ps?(i+f)/2:Math.atan2(x,b),E=t(A,T),k=E[0],j=E[1],q=k-e,P=j-n,O=_*q-v*P;(O*O/w>o||gs((v*q+_*P)/w-.5)>.3||s>a*p+u*d+l*g)&&(r(e,n,i,a,u,l,k,j,A,b/=M,x/=M,S,y,m),m.point(k,j),r(k,j,A,b,x,S,c,h,f,p,d,g,y,m))}}var o=.5,s=Math.cos(30*Ls),a=16;return e.precision=function(t){return arguments.length?(a=(o=t*t)>0&&16,e):Math.sqrt(o)},e}function nn(t){var e=en(function(e,n){return t([e*Ds,n*Ds])});return function(t){return un(e(t))}}function rn(t){this.stream=t}function on(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function sn(t){return an(function(){return t})()}function an(t){function e(t){return t=a(t[0]*Ls,t[1]*Ls),[t[0]*f+u,l-t[1]*f]}function n(t){return t=a.invert((t[0]-u)/f,(l-t[1])/f),t&&[t[0]*Ds,t[1]*Ds]}function i(){a=ke(s=hn(m,v,w),o);var t=o(g,y);return u=p-t[0]*f,l=d+t[1]*f,r()}function r(){return c&&(c.valid=!1,c=null),e}var o,s,a,u,l,c,h=en(function(t,e){return t=o(t,e),[t[0]*f+u,l-t[1]*f]}),f=150,p=480,d=250,g=0,y=0,m=0,v=0,w=0,b=Ra,x=_,S=null,M=null;return e.stream=function(t){return c&&(c.valid=!1),c=un(b(s,h(x(t)))),c.valid=!0,c},e.clipAngle=function(t){return arguments.length?(b=null==t?(S=t,Ra):Ie((S=+t)*Ls),r()):S},e.clipExtent=function(t){return arguments.length?(M=t,x=t?Ge(t[0][0],t[0][1],t[1][0],t[1][1]):_,r()):M},e.scale=function(t){return arguments.length?(f=+t,i()):f},e.translate=function(t){return arguments.length?(p=+t[0],d=+t[1],i()):[p,d]},e.center=function(t){return arguments.length?(g=t[0]%360*Ls,y=t[1]%360*Ls,i()):[g*Ds,y*Ds]},e.rotate=function(t){return arguments.length?(m=t[0]%360*Ls,v=t[1]%360*Ls,w=t.length>2?t[2]%360*Ls:0,i()):[m*Ds,v*Ds,w*Ds]},is.rebind(e,h,"precision"),function(){return o=t.apply(this,arguments),e.invert=o.invert&&n,i()}}function un(t){return on(t,function(e,n){t.point(e*Ls,n*Ls)})}function ln(t,e){return[t,e]}function cn(t,e){return[t>Fs?t-Rs:-Fs>t?t+Rs:t,e]}function hn(t,e,n){return t?e||n?ke(pn(t),dn(e,n)):pn(t):e||n?dn(e,n):cn}function fn(t){return function(e,n){return e+=t,[e>Fs?e-Rs:-Fs>e?e+Rs:e,n]}}function pn(t){var e=fn(t);return e.invert=fn(-t),e}function dn(t,e){function n(t,e){var n=Math.cos(e),a=Math.cos(t)*n,u=Math.sin(t)*n,l=Math.sin(e),c=l*i+a*r;return[Math.atan2(u*o-c*s,a*i-l*r),nt(c*o+u*s)]}var i=Math.cos(t),r=Math.sin(t),o=Math.cos(e),s=Math.sin(e);return n.invert=function(t,e){var n=Math.cos(e),a=Math.cos(t)*n,u=Math.sin(t)*n,l=Math.sin(e),c=l*o-u*s;return[Math.atan2(u*o+l*s,a*i+c*r),nt(c*i-a*r)]},n}function gn(t,e){var n=Math.cos(t),i=Math.sin(t);return function(r,o,s,a){var u=s*e;null!=r?(r=yn(n,r),o=yn(n,o),(s>0?o>r:r>o)&&(r+=s*Rs)):(r=t+s*Rs,o=t-.5*u);for(var l,c=r;s>0?c>o:o>c;c-=u)a.point((l=be([n,-i*Math.cos(c),-i*Math.sin(c)]))[0],l[1])}}function yn(t,e){var n=ge(e);n[0]-=t,we(n);var i=et(-n[1]);return((-n[2]<0?-i:i)+2*Math.PI-Ps)%(2*Math.PI)}function mn(t,e,n){var i=is.range(t,e-Ps,n).concat(e);return function(t){return i.map(function(e){return[t,e]})}}function vn(t,e,n){var i=is.range(t,e-Ps,n).concat(e);return function(t){return i.map(function(e){return[e,t]})}}function _n(t){return t.source}function wn(t){return t.target}function bn(t,e,n,i){var r=Math.cos(e),o=Math.sin(e),s=Math.cos(i),a=Math.sin(i),u=r*Math.cos(t),l=r*Math.sin(t),c=s*Math.cos(n),h=s*Math.sin(n),f=2*Math.asin(Math.sqrt(st(i-e)+r*s*st(n-t))),p=1/Math.sin(f),d=f?function(t){var e=Math.sin(t*=f)*p,n=Math.sin(f-t)*p,i=n*u+e*c,r=n*l+e*h,s=n*o+e*a;return[Math.atan2(r,i)*Ds,Math.atan2(s,Math.sqrt(i*i+r*r))*Ds]}:function(){return[t*Ds,e*Ds]};return d.distance=f,d}function xn(){function t(t,r){var o=Math.sin(r*=Ls),s=Math.cos(r),a=gs((t*=Ls)-e),u=Math.cos(a);Wa+=Math.atan2(Math.sqrt((a=s*Math.sin(a))*a+(a=i*o-n*s*u)*a),n*o+i*s*u),e=t,n=o,i=s}var e,n,i;Ya.point=function(r,o){e=r*Ls,n=Math.sin(o*=Ls),i=Math.cos(o),Ya.point=t},Ya.lineEnd=function(){Ya.point=Ya.lineEnd=x}}function Sn(t,e){function n(e,n){var i=Math.cos(e),r=Math.cos(n),o=t(i*r);return[o*r*Math.sin(e),o*Math.sin(n)]}return n.invert=function(t,n){var i=Math.sqrt(t*t+n*n),r=e(i),o=Math.sin(r),s=Math.cos(r);return[Math.atan2(t*o,i*s),Math.asin(i&&n*o/i)]},n}function Mn(t,e){function n(t,e){s>0?-Cs+Ps>e&&(e=-Cs+Ps):e>Cs-Ps&&(e=Cs-Ps);var n=s/Math.pow(r(e),o);return[n*Math.sin(o*t),s-n*Math.cos(o*t)]}var i=Math.cos(t),r=function(t){return Math.tan(Fs/4+t/2)},o=t===e?Math.sin(t):Math.log(i/Math.cos(e))/Math.log(r(e)/r(t)),s=i*Math.pow(r(t),o)/o;return o?(n.invert=function(t,e){var n=s-e,i=K(o)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/o,2*Math.atan(Math.pow(s/i,1/o))-Cs]},n):An}function Tn(t,e){function n(t,e){var n=o-e;return[n*Math.sin(r*t),o-n*Math.cos(r*t)]}var i=Math.cos(t),r=t===e?Math.sin(t):(i-Math.cos(e))/(e-t),o=i/r+t;return gs(r)<Ps?ln:(n.invert=function(t,e){var n=o-e;return[Math.atan2(t,n)/r,o-K(r)*Math.sqrt(t*t+n*n)]},n)}function An(t,e){return[t,Math.log(Math.tan(Fs/4+e/2))]}function En(t){var e,n=sn(t),i=n.scale,r=n.translate,o=n.clipExtent;return n.scale=function(){var t=i.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var s=o.apply(n,arguments);if(s===n){if(e=null==t){var a=Fs*i(),u=r();o([[u[0]-a,u[1]-a],[u[0]+a,u[1]+a]])}}else e&&(s=null);return s},n.clipExtent(null)}function kn(t,e){return[Math.log(Math.tan(Fs/4+e/2)),-t]}function jn(t){return t[0]}function qn(t){return t[1]}function Pn(t){for(var e=t.length,n=[0,1],i=2,r=2;e>r;r++){for(;i>1&&tt(t[n[i-2]],t[n[i-1]],t[r])<=0;)--i;n[i++]=r}return n.slice(0,i)}function On(t,e){return t[0]-e[0]||t[1]-e[1]}function Fn(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function Rn(t,e,n,i){var r=t[0],o=n[0],s=e[0]-r,a=i[0]-o,u=t[1],l=n[1],c=e[1]-u,h=i[1]-l,f=(a*(u-l)-h*(r-o))/(h*s-a*c);return[r+f*s,u+f*c]}function Nn(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}function Cn(){
ii(this),this.edge=this.site=this.circle=null}function Ln(t){var e=ru.pop()||new Cn;return e.site=t,e}function Dn(t){Hn(t),eu.remove(t),ru.push(t),ii(t)}function Bn(t){var e=t.circle,n=e.x,i=e.cy,r={x:n,y:i},o=t.P,s=t.N,a=[t];Dn(t);for(var u=o;u.circle&&gs(n-u.circle.x)<Ps&&gs(i-u.circle.cy)<Ps;)o=u.P,a.unshift(u),Dn(u),u=o;a.unshift(u),Hn(u);for(var l=s;l.circle&&gs(n-l.circle.x)<Ps&&gs(i-l.circle.cy)<Ps;)s=l.N,a.push(l),Dn(l),l=s;a.push(l),Hn(l);var c,h=a.length;for(c=1;h>c;++c)l=a[c],u=a[c-1],ti(l.edge,u.site,l.site,r);u=a[0],l=a[h-1],l.edge=Jn(u.site,l.site,null,r),Qn(u),Qn(l)}function zn(t){for(var e,n,i,r,o=t.x,s=t.y,a=eu._;a;)if(i=In(a,s)-o,i>Ps)a=a.L;else{if(r=o-Un(a,s),!(r>Ps)){i>-Ps?(e=a.P,n=a):r>-Ps?(e=a,n=a.N):e=n=a;break}if(!a.R){e=a;break}a=a.R}var u=Ln(t);if(eu.insert(e,u),e||n){if(e===n)return Hn(e),n=Ln(e.site),eu.insert(u,n),u.edge=n.edge=Jn(e.site,u.site),Qn(e),void Qn(n);if(!n)return void(u.edge=Jn(e.site,u.site));Hn(e),Hn(n);var l=e.site,c=l.x,h=l.y,f=t.x-c,p=t.y-h,d=n.site,g=d.x-c,y=d.y-h,m=2*(f*y-p*g),v=f*f+p*p,_=g*g+y*y,w={x:(y*v-p*_)/m+c,y:(f*_-g*v)/m+h};ti(n.edge,l,d,w),u.edge=Jn(l,t,null,w),n.edge=Jn(t,d,null,w),Qn(e),Qn(n)}}function In(t,e){var n=t.site,i=n.x,r=n.y,o=r-e;if(!o)return i;var s=t.P;if(!s)return-(1/0);n=s.site;var a=n.x,u=n.y,l=u-e;if(!l)return a;var c=a-i,h=1/o-1/l,f=c/l;return h?(-f+Math.sqrt(f*f-2*h*(c*c/(-2*l)-u+l/2+r-o/2)))/h+i:(i+a)/2}function Un(t,e){var n=t.N;if(n)return In(n,e);var i=t.site;return i.y===e?i.x:1/0}function Gn(t){this.site=t,this.edges=[]}function Vn(t){for(var e,n,i,r,o,s,a,u,l,c,h=t[0][0],f=t[1][0],p=t[0][1],d=t[1][1],g=tu,y=g.length;y--;)if(o=g[y],o&&o.prepare())for(a=o.edges,u=a.length,s=0;u>s;)c=a[s].end(),i=c.x,r=c.y,l=a[++s%u].start(),e=l.x,n=l.y,(gs(i-e)>Ps||gs(r-n)>Ps)&&(a.splice(s,0,new ei(Kn(o.site,c,gs(i-h)<Ps&&d-r>Ps?{x:h,y:gs(e-h)<Ps?n:d}:gs(r-d)<Ps&&f-i>Ps?{x:gs(n-d)<Ps?e:f,y:d}:gs(i-f)<Ps&&r-p>Ps?{x:f,y:gs(e-f)<Ps?n:p}:gs(r-p)<Ps&&i-h>Ps?{x:gs(n-p)<Ps?e:h,y:p}:null),o.site,null)),++u)}function Wn(t,e){return e.angle-t.angle}function Yn(){ii(this),this.x=this.y=this.arc=this.site=this.cy=null}function Qn(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,o=n.site;if(i!==o){var s=r.x,a=r.y,u=i.x-s,l=i.y-a,c=o.x-s,h=o.y-a,f=2*(u*h-l*c);if(!(f>=-Os)){var p=u*u+l*l,d=c*c+h*h,g=(h*p-l*d)/f,y=(u*d-c*p)/f,h=y+a,m=ou.pop()||new Yn;m.arc=t,m.site=r,m.x=g+s,m.y=h+Math.sqrt(g*g+y*y),m.cy=h,t.circle=m;for(var v=null,_=iu._;_;)if(m.y<_.y||m.y===_.y&&m.x<=_.x){if(!_.L){v=_.P;break}_=_.L}else{if(!_.R){v=_;break}_=_.R}iu.insert(v,m),v||(nu=m)}}}}function Hn(t){var e=t.circle;e&&(e.P||(nu=e.N),iu.remove(e),ou.push(e),ii(e),t.circle=null)}function $n(t){for(var e,n=Ka,i=Ue(t[0][0],t[0][1],t[1][0],t[1][1]),r=n.length;r--;)e=n[r],(!Zn(e,t)||!i(e)||gs(e.a.x-e.b.x)<Ps&&gs(e.a.y-e.b.y)<Ps)&&(e.a=e.b=null,n.splice(r,1))}function Zn(t,e){var n=t.b;if(n)return!0;var i,r,o=t.a,s=e[0][0],a=e[1][0],u=e[0][1],l=e[1][1],c=t.l,h=t.r,f=c.x,p=c.y,d=h.x,g=h.y,y=(f+d)/2,m=(p+g)/2;if(g===p){if(s>y||y>=a)return;if(f>d){if(o){if(o.y>=l)return}else o={x:y,y:u};n={x:y,y:l}}else{if(o){if(o.y<u)return}else o={x:y,y:l};n={x:y,y:u}}}else if(i=(f-d)/(g-p),r=m-i*y,-1>i||i>1)if(f>d){if(o){if(o.y>=l)return}else o={x:(u-r)/i,y:u};n={x:(l-r)/i,y:l}}else{if(o){if(o.y<u)return}else o={x:(l-r)/i,y:l};n={x:(u-r)/i,y:u}}else if(g>p){if(o){if(o.x>=a)return}else o={x:s,y:i*s+r};n={x:a,y:i*a+r}}else{if(o){if(o.x<s)return}else o={x:a,y:i*a+r};n={x:s,y:i*s+r}}return t.a=o,t.b=n,!0}function Xn(t,e){this.l=t,this.r=e,this.a=this.b=null}function Jn(t,e,n,i){var r=new Xn(t,e);return Ka.push(r),n&&ti(r,t,e,n),i&&ti(r,e,t,i),tu[t.i].edges.push(new ei(r,t,e)),tu[e.i].edges.push(new ei(r,e,t)),r}function Kn(t,e,n){var i=new Xn(t,null);return i.a=e,i.b=n,Ka.push(i),i}function ti(t,e,n,i){t.a||t.b?t.l===n?t.b=i:t.a=i:(t.a=i,t.l=e,t.r=n)}function ei(t,e,n){var i=t.a,r=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(r.x-i.x,i.y-r.y):Math.atan2(i.x-r.x,r.y-i.y)}function ni(){this._=null}function ii(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function ri(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function oi(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function si(t){for(;t.L;)t=t.L;return t}function ai(t,e){var n,i,r,o=t.sort(ui).pop();for(Ka=[],tu=new Array(t.length),eu=new ni,iu=new ni;;)if(r=nu,o&&(!r||o.y<r.y||o.y===r.y&&o.x<r.x))(o.x!==n||o.y!==i)&&(tu[o.i]=new Gn(o),zn(o),n=o.x,i=o.y),o=t.pop();else{if(!r)break;Bn(r.arc)}e&&($n(e),Vn(e));var s={cells:tu,edges:Ka};return eu=iu=Ka=tu=null,s}function ui(t,e){return e.y-t.y||e.x-t.x}function li(t,e,n){return(t.x-n.x)*(e.y-t.y)-(t.x-e.x)*(n.y-t.y)}function ci(t){return t.x}function hi(t){return t.y}function fi(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function pi(t,e,n,i,r,o){if(!t(e,n,i,r,o)){var s=.5*(n+r),a=.5*(i+o),u=e.nodes;u[0]&&pi(t,u[0],n,i,s,a),u[1]&&pi(t,u[1],s,i,r,a),u[2]&&pi(t,u[2],n,a,s,o),u[3]&&pi(t,u[3],s,a,r,o)}}function di(t,e,n,i,r,o,s){var a,u=1/0;return function l(t,c,h,f,p){if(!(c>o||h>s||i>f||r>p)){if(d=t.point){var d,g=e-t.x,y=n-t.y,m=g*g+y*y;if(u>m){var v=Math.sqrt(u=m);i=e-v,r=n-v,o=e+v,s=n+v,a=d}}for(var _=t.nodes,w=.5*(c+f),b=.5*(h+p),x=e>=w,S=n>=b,M=S<<1|x,T=M+4;T>M;++M)if(t=_[3&M])switch(3&M){case 0:l(t,c,h,w,b);break;case 1:l(t,w,h,f,b);break;case 2:l(t,c,b,w,p);break;case 3:l(t,w,b,f,p)}}}(t,i,r,o,s),a}function gi(t,e){t=is.rgb(t),e=is.rgb(e);var n=t.r,i=t.g,r=t.b,o=e.r-n,s=e.g-i,a=e.b-r;return function(t){return"#"+bt(Math.round(n+o*t))+bt(Math.round(i+s*t))+bt(Math.round(r+a*t))}}function yi(t,e){var n,i={},r={};for(n in t)n in e?i[n]=_i(t[n],e[n]):r[n]=t[n];for(n in e)n in t||(r[n]=e[n]);return function(t){for(n in i)r[n]=i[n](t);return r}}function mi(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function vi(t,e){var n,i,r,o=au.lastIndex=uu.lastIndex=0,s=-1,a=[],u=[];for(t+="",e+="";(n=au.exec(t))&&(i=uu.exec(e));)(r=i.index)>o&&(r=e.slice(o,r),a[s]?a[s]+=r:a[++s]=r),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,u.push({i:s,x:mi(n,i)})),o=uu.lastIndex;return o<e.length&&(r=e.slice(o),a[s]?a[s]+=r:a[++s]=r),a.length<2?u[0]?(e=u[0].x,function(t){return e(t)+""}):function(){return e}:(e=u.length,function(t){for(var n,i=0;e>i;++i)a[(n=u[i]).i]=n.x(t);return a.join("")})}function _i(t,e){for(var n,i=is.interpolators.length;--i>=0&&!(n=is.interpolators[i](t,e)););return n}function wi(t,e){var n,i=[],r=[],o=t.length,s=e.length,a=Math.min(t.length,e.length);for(n=0;a>n;++n)i.push(_i(t[n],e[n]));for(;o>n;++n)r[n]=t[n];for(;s>n;++n)r[n]=e[n];return function(t){for(n=0;a>n;++n)r[n]=i[n](t);return r}}function bi(t){return function(e){return 0>=e?0:e>=1?1:t(e)}}function xi(t){return function(e){return 1-t(1-e)}}function Si(t){return function(e){return.5*(.5>e?t(2*e):2-t(2-2*e))}}function Mi(t){return t*t}function Ti(t){return t*t*t}function Ai(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(.5>t?n:3*(t-e)+n-.75)}function Ei(t){return function(e){return Math.pow(e,t)}}function ki(t){return 1-Math.cos(t*Cs)}function ji(t){return Math.pow(2,10*(t-1))}function qi(t){return 1-Math.sqrt(1-t*t)}function Pi(t,e){var n;return arguments.length<2&&(e=.45),arguments.length?n=e/Rs*Math.asin(1/t):(t=1,n=e/4),function(i){return 1+t*Math.pow(2,-10*i)*Math.sin((i-n)*Rs/e)}}function Oi(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}}function Fi(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function Ri(t,e){t=is.hcl(t),e=is.hcl(e);var n=t.h,i=t.c,r=t.l,o=e.h-n,s=e.c-i,a=e.l-r;return isNaN(s)&&(s=0,i=isNaN(i)?e.c:i),isNaN(o)?(o=0,n=isNaN(n)?e.h:n):o>180?o-=360:-180>o&&(o+=360),function(t){return ht(n+o*t,i+s*t,r+a*t)+""}}function Ni(t,e){t=is.hsl(t),e=is.hsl(e);var n=t.h,i=t.s,r=t.l,o=e.h-n,s=e.s-i,a=e.l-r;return isNaN(s)&&(s=0,i=isNaN(i)?e.s:i),isNaN(o)?(o=0,n=isNaN(n)?e.h:n):o>180?o-=360:-180>o&&(o+=360),function(t){return lt(n+o*t,i+s*t,r+a*t)+""}}function Ci(t,e){t=is.lab(t),e=is.lab(e);var n=t.l,i=t.a,r=t.b,o=e.l-n,s=e.a-i,a=e.b-r;return function(t){return pt(n+o*t,i+s*t,r+a*t)+""}}function Li(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function Di(t){var e=[t.a,t.b],n=[t.c,t.d],i=zi(e),r=Bi(e,n),o=zi(Ii(n,e,-r))||0;e[0]*n[1]<n[0]*e[1]&&(e[0]*=-1,e[1]*=-1,i*=-1,r*=-1),this.rotate=(i?Math.atan2(e[1],e[0]):Math.atan2(-n[0],n[1]))*Ds,this.translate=[t.e,t.f],this.scale=[i,o],this.skew=o?Math.atan2(r,o)*Ds:0}function Bi(t,e){return t[0]*e[0]+t[1]*e[1]}function zi(t){var e=Math.sqrt(Bi(t,t));return e&&(t[0]/=e,t[1]/=e),e}function Ii(t,e,n){return t[0]+=n*e[0],t[1]+=n*e[1],t}function Ui(t,e){var n,i=[],r=[],o=is.transform(t),s=is.transform(e),a=o.translate,u=s.translate,l=o.rotate,c=s.rotate,h=o.skew,f=s.skew,p=o.scale,d=s.scale;return a[0]!=u[0]||a[1]!=u[1]?(i.push("translate(",null,",",null,")"),r.push({i:1,x:mi(a[0],u[0])},{i:3,x:mi(a[1],u[1])})):u[0]||u[1]?i.push("translate("+u+")"):i.push(""),l!=c?(l-c>180?c+=360:c-l>180&&(l+=360),r.push({i:i.push(i.pop()+"rotate(",null,")")-2,x:mi(l,c)})):c&&i.push(i.pop()+"rotate("+c+")"),h!=f?r.push({i:i.push(i.pop()+"skewX(",null,")")-2,x:mi(h,f)}):f&&i.push(i.pop()+"skewX("+f+")"),p[0]!=d[0]||p[1]!=d[1]?(n=i.push(i.pop()+"scale(",null,",",null,")"),r.push({i:n-4,x:mi(p[0],d[0])},{i:n-2,x:mi(p[1],d[1])})):(1!=d[0]||1!=d[1])&&i.push(i.pop()+"scale("+d+")"),n=r.length,function(t){for(var e,o=-1;++o<n;)i[(e=r[o]).i]=e.x(t);return i.join("")}}function Gi(t,e){return e=(e-=t=+t)||1/e,function(n){return(n-t)/e}}function Vi(t,e){return e=(e-=t=+t)||1/e,function(n){return Math.max(0,Math.min(1,(n-t)/e))}}function Wi(t){for(var e=t.source,n=t.target,i=Qi(e,n),r=[e];e!==i;)e=e.parent,r.push(e);for(var o=r.length;n!==i;)r.splice(o,0,n),n=n.parent;return r}function Yi(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function Qi(t,e){if(t===e)return t;for(var n=Yi(t),i=Yi(e),r=n.pop(),o=i.pop(),s=null;r===o;)s=r,r=n.pop(),o=i.pop();return s}function Hi(t){t.fixed|=2}function $i(t){t.fixed&=-7}function Zi(t){t.fixed|=4,t.px=t.x,t.py=t.y}function Xi(t){t.fixed&=-5}function Ji(t,e,n){var i=0,r=0;if(t.charge=0,!t.leaf)for(var o,s=t.nodes,a=s.length,u=-1;++u<a;)o=s[u],null!=o&&(Ji(o,e,n),t.charge+=o.charge,i+=o.charge*o.cx,r+=o.charge*o.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var l=e*n[t.point.index];t.charge+=t.pointCharge=l,i+=l*t.point.x,r+=l*t.point.y}t.cx=i/t.charge,t.cy=r/t.charge}function Ki(t,e){return is.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=or,t}function tr(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(r=t.children)&&(i=r.length))for(var i,r;--i>=0;)n.push(r[i])}function er(t,e){for(var n=[t],i=[];null!=(t=n.pop());)if(i.push(t),(o=t.children)&&(r=o.length))for(var r,o,s=-1;++s<r;)n.push(o[s]);for(;null!=(t=i.pop());)e(t)}function nr(t){return t.children}function ir(t){return t.value}function rr(t,e){return e.value-t.value}function or(t){return is.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}function sr(t){return t.x}function ar(t){return t.y}function ur(t,e,n){t.y0=e,t.y=n}function lr(t){return is.range(t.length)}function cr(t){for(var e=-1,n=t[0].length,i=[];++e<n;)i[e]=0;return i}function hr(t){for(var e,n=1,i=0,r=t[0][1],o=t.length;o>n;++n)(e=t[n][1])>r&&(i=n,r=e);return i}function fr(t){return t.reduce(pr,0)}function pr(t,e){return t+e[1]}function dr(t,e){return gr(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function gr(t,e){for(var n=-1,i=+t[0],r=(t[1]-i)/e,o=[];++n<=e;)o[n]=r*n+i;return o}function yr(t){return[is.min(t),is.max(t)]}function mr(t,e){return t.value-e.value}function vr(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function _r(t,e){t._pack_next=e,e._pack_prev=t}function wr(t,e){var n=e.x-t.x,i=e.y-t.y,r=t.r+e.r;return.999*r*r>n*n+i*i}function br(t){function e(t){c=Math.min(t.x-t.r,c),h=Math.max(t.x+t.r,h),f=Math.min(t.y-t.r,f),p=Math.max(t.y+t.r,p)}if((n=t.children)&&(l=n.length)){var n,i,r,o,s,a,u,l,c=1/0,h=-(1/0),f=1/0,p=-(1/0);if(n.forEach(xr),i=n[0],i.x=-i.r,i.y=0,e(i),l>1&&(r=n[1],r.x=r.r,r.y=0,e(r),l>2))for(o=n[2],Tr(i,r,o),e(o),vr(i,o),i._pack_prev=o,vr(o,r),r=i._pack_next,s=3;l>s;s++){Tr(i,r,o=n[s]);var d=0,g=1,y=1;for(a=r._pack_next;a!==r;a=a._pack_next,g++)if(wr(a,o)){d=1;break}if(1==d)for(u=i._pack_prev;u!==a._pack_prev&&!wr(u,o);u=u._pack_prev,y++);d?(y>g||g==y&&r.r<i.r?_r(i,r=a):_r(i=u,r),s--):(vr(i,o),r=o,e(o))}var m=(c+h)/2,v=(f+p)/2,_=0;for(s=0;l>s;s++)o=n[s],o.x-=m,o.y-=v,_=Math.max(_,o.r+Math.sqrt(o.x*o.x+o.y*o.y));t.r=_,n.forEach(Sr)}}function xr(t){t._pack_next=t._pack_prev=t}function Sr(t){delete t._pack_next,delete t._pack_prev}function Mr(t,e,n,i){var r=t.children;if(t.x=e+=i*t.x,t.y=n+=i*t.y,t.r*=i,r)for(var o=-1,s=r.length;++o<s;)Mr(r[o],e,n,i)}function Tr(t,e,n){var i=t.r+n.r,r=e.x-t.x,o=e.y-t.y;if(i&&(r||o)){var s=e.r+n.r,a=r*r+o*o;s*=s,i*=i;var u=.5+(i-s)/(2*a),l=Math.sqrt(Math.max(0,2*s*(i+a)-(i-=a)*i-s*s))/(2*a);n.x=t.x+u*r+l*o,n.y=t.y+u*o-l*r}else n.x=t.x+i,n.y=t.y}function Ar(t,e){return t.parent==e.parent?1:2}function Er(t){var e=t.children;return e.length?e[0]:t.t}function kr(t){var e,n=t.children;return(e=n.length)?n[e-1]:t.t}function jr(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function qr(t){for(var e,n=0,i=0,r=t.children,o=r.length;--o>=0;)e=r[o],e.z+=n,e.m+=n,n+=e.s+(i+=e.c)}function Pr(t,e,n){return t.a.parent===e.parent?t.a:n}function Or(t){return 1+is.max(t,function(t){return t.y})}function Fr(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function Rr(t){var e=t.children;return e&&e.length?Rr(e[0]):t}function Nr(t){var e,n=t.children;return n&&(e=n.length)?Nr(n[e-1]):t}function Cr(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Lr(t,e){var n=t.x+e[3],i=t.y+e[0],r=t.dx-e[1]-e[3],o=t.dy-e[0]-e[2];return 0>r&&(n+=r/2,r=0),0>o&&(i+=o/2,o=0),{x:n,y:i,dx:r,dy:o}}function Dr(t){var e=t[0],n=t[t.length-1];return n>e?[e,n]:[n,e]}function Br(t){return t.rangeExtent?t.rangeExtent():Dr(t.range())}function zr(t,e,n,i){var r=n(t[0],t[1]),o=i(e[0],e[1]);return function(t){return o(r(t))}}function Ir(t,e){var n,i=0,r=t.length-1,o=t[i],s=t[r];return o>s&&(n=i,i=r,r=n,n=o,o=s,s=n),t[i]=e.floor(o),t[r]=e.ceil(s),t}function Ur(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:_u}function Gr(t,e,n,i){var r=[],o=[],s=0,a=Math.min(t.length,e.length)-1;for(t[a]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<=a;)r.push(n(t[s-1],t[s])),o.push(i(e[s-1],e[s]));return function(e){var n=is.bisect(t,e,1,a)-1;return o[n](r[n](e))}}function Vr(t,e,n,i){function r(){var r=Math.min(t.length,e.length)>2?Gr:zr,u=i?Vi:Gi;return s=r(t,e,u,n),a=r(e,t,u,_i),o}function o(t){return s(t)}var s,a;return o.invert=function(t){return a(t)},o.domain=function(e){return arguments.length?(t=e.map(Number),r()):t},o.range=function(t){return arguments.length?(e=t,r()):e},o.rangeRound=function(t){return o.range(t).interpolate(Li)},o.clamp=function(t){return arguments.length?(i=t,r()):i},o.interpolate=function(t){return arguments.length?(n=t,r()):n},o.ticks=function(e){return Hr(t,e)},o.tickFormat=function(e,n){return $r(t,e,n)},o.nice=function(e){return Yr(t,e),r()},o.copy=function(){return Vr(t,e,n,i)},r()}function Wr(t,e){return is.rebind(t,e,"range","rangeRound","interpolate","clamp")}function Yr(t,e){return Ir(t,Ur(Qr(t,e)[2]))}function Qr(t,e){null==e&&(e=10);var n=Dr(t),i=n[1]-n[0],r=Math.pow(10,Math.floor(Math.log(i/e)/Math.LN10)),o=e/i*r;return.15>=o?r*=10:.35>=o?r*=5:.75>=o&&(r*=2),n[0]=Math.ceil(n[0]/r)*r,n[1]=Math.floor(n[1]/r)*r+.5*r,n[2]=r,n}function Hr(t,e){return is.range.apply(is,Qr(t,e))}function $r(t,e,n){var i=Qr(t,e);if(n){var r=aa.exec(n);if(r.shift(),"s"===r[8]){var o=is.formatPrefix(Math.max(gs(i[0]),gs(i[1])));return r[7]||(r[7]="."+Zr(o.scale(i[2]))),r[8]="f",n=is.format(r.join("")),function(t){return n(o.scale(t))+o.symbol}}r[7]||(r[7]="."+Xr(r[8],i)),n=r.join("")}else n=",."+Zr(i[2])+"f";return is.format(n)}function Zr(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function Xr(t,e){var n=Zr(e[2]);return t in wu?Math.abs(n-Zr(Math.max(gs(e[0]),gs(e[1]))))+ +("e"!==t):n-2*("%"===t)}function Jr(t,e,n,i){function r(t){return(n?Math.log(0>t?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function o(t){return n?Math.pow(e,t):-Math.pow(e,-t)}function s(e){return t(r(e))}return s.invert=function(e){return o(t.invert(e))},s.domain=function(e){return arguments.length?(n=e[0]>=0,t.domain((i=e.map(Number)).map(r)),s):i},s.base=function(n){return arguments.length?(e=+n,t.domain(i.map(r)),s):e},s.nice=function(){var e=Ir(i.map(r),n?Math:xu);return t.domain(e),i=e.map(o),s},s.ticks=function(){var t=Dr(i),s=[],a=t[0],u=t[1],l=Math.floor(r(a)),c=Math.ceil(r(u)),h=e%1?2:e;if(isFinite(c-l)){if(n){for(;c>l;l++)for(var f=1;h>f;f++)s.push(o(l)*f);s.push(o(l))}else for(s.push(o(l));l++<c;)for(var f=h-1;f>0;f--)s.push(o(l)*f);for(l=0;s[l]<a;l++);for(c=s.length;s[c-1]>u;c--);s=s.slice(l,c)}return s},s.tickFormat=function(t,e){if(!arguments.length)return bu;arguments.length<2?e=bu:"function"!=typeof e&&(e=is.format(e));var i,a=Math.max(.1,t/s.ticks().length),u=n?(i=1e-12,Math.ceil):(i=-1e-12,Math.floor);return function(t){return t/o(u(r(t)+i))<=a?e(t):""}},s.copy=function(){return Jr(t.copy(),e,n,i)},Wr(s,t)}function Kr(t,e,n){function i(e){return t(r(e))}var r=to(e),o=to(1/e);return i.invert=function(e){return o(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain((n=e.map(Number)).map(r)),i):n},i.ticks=function(t){return Hr(n,t)},i.tickFormat=function(t,e){return $r(n,t,e)},i.nice=function(t){return i.domain(Yr(n,t))},i.exponent=function(s){return arguments.length?(r=to(e=s),o=to(1/e),t.domain(n.map(r)),i):e},i.copy=function(){return Kr(t.copy(),e,n)},Wr(i,t)}function to(t){return function(e){return 0>e?-Math.pow(-e,t):Math.pow(e,t)}}function eo(t,e){function n(n){return o[((r.get(n)||("range"===e.t?r.set(n,t.push(n)):NaN))-1)%o.length]}function i(e,n){return is.range(t.length).map(function(t){return e+n*t})}var r,o,s;return n.domain=function(i){if(!arguments.length)return t;t=[],r=new c;for(var o,s=-1,a=i.length;++s<a;)r.has(o=i[s])||r.set(o,t.push(o));return n[e.t].apply(n,e.a)},n.range=function(t){return arguments.length?(o=t,s=0,e={t:"range",a:arguments},n):o},n.rangePoints=function(r,a){arguments.length<2&&(a=0);var u=r[0],l=r[1],c=t.length<2?(u=(u+l)/2,0):(l-u)/(t.length-1+a);return o=i(u+c*a/2,c),s=0,e={t:"rangePoints",a:arguments},n},n.rangeRoundPoints=function(r,a){arguments.length<2&&(a=0);var u=r[0],l=r[1],c=t.length<2?(u=l=Math.round((u+l)/2),0):(l-u)/(t.length-1+a)|0;return o=i(u+Math.round(c*a/2+(l-u-(t.length-1+a)*c)/2),c),s=0,e={t:"rangeRoundPoints",a:arguments},n},n.rangeBands=function(r,a,u){arguments.length<2&&(a=0),arguments.length<3&&(u=a);var l=r[1]<r[0],c=r[l-0],h=r[1-l],f=(h-c)/(t.length-a+2*u);return o=i(c+f*u,f),l&&o.reverse(),s=f*(1-a),e={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(r,a,u){arguments.length<2&&(a=0),arguments.length<3&&(u=a);var l=r[1]<r[0],c=r[l-0],h=r[1-l],f=Math.floor((h-c)/(t.length-a+2*u));return o=i(c+Math.round((h-c-(t.length-a)*f)/2),f),l&&o.reverse(),s=Math.round(f*(1-a)),e={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return s},n.rangeExtent=function(){return Dr(e.a[0])},n.copy=function(){return eo(t,e)},n.domain(t)}function no(t,e){function n(){var n=0,i=e.length;for(a=[];++n<i;)a[n-1]=is.quantile(t,n/i);return s}function s(t){return isNaN(t=+t)?void 0:e[is.bisect(a,t)]}var a;return s.domain=function(e){return arguments.length?(t=e.map(r).filter(o).sort(i),n()):t},s.range=function(t){return arguments.length?(e=t,n()):e},s.quantiles=function(){return a},s.invertExtent=function(n){return n=e.indexOf(n),0>n?[NaN,NaN]:[n>0?a[n-1]:t[0],n<a.length?a[n]:t[t.length-1]]},s.copy=function(){return no(t,e)},n()}function io(t,e,n){function i(e){return n[Math.max(0,Math.min(s,Math.floor(o*(e-t))))]}function r(){return o=n.length/(e-t),s=n.length-1,i}var o,s;return i.domain=function(n){return arguments.length?(t=+n[0],e=+n[n.length-1],r()):[t,e]},i.range=function(t){return arguments.length?(n=t,r()):n},i.invertExtent=function(e){return e=n.indexOf(e),e=0>e?NaN:e/o+t,[e,e+1/o]},i.copy=function(){return io(t,e,n)},r()}function ro(t,e){function n(n){return n>=n?e[is.bisect(t,n)]:void 0}return n.domain=function(e){return arguments.length?(t=e,n):t},n.range=function(t){return arguments.length?(e=t,n):e},n.invertExtent=function(n){return n=e.indexOf(n),[t[n-1],t[n]]},n.copy=function(){return ro(t,e)},n}function oo(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=n.map(e),e):t},e.ticks=function(e){return Hr(t,e)},e.tickFormat=function(e,n){return $r(t,e,n)},e.copy=function(){return oo(t)},e}function so(){return 0}function ao(t){return t.innerRadius}function uo(t){return t.outerRadius}function lo(t){return t.startAngle}function co(t){return t.endAngle}function ho(t){return t&&t.padAngle}function fo(t,e,n,i){return(t-n)*e-(e-i)*t>0?0:1}function po(t,e,n,i,r){var o=t[0]-e[0],s=t[1]-e[1],a=(r?i:-i)/Math.sqrt(o*o+s*s),u=a*s,l=-a*o,c=t[0]+u,h=t[1]+l,f=e[0]+u,p=e[1]+l,d=(c+f)/2,g=(h+p)/2,y=f-c,m=p-h,v=y*y+m*m,_=n-i,w=c*p-f*h,b=(0>m?-1:1)*Math.sqrt(_*_*v-w*w),x=(w*m-y*b)/v,S=(-w*y-m*b)/v,M=(w*m+y*b)/v,T=(-w*y+m*b)/v,A=x-d,E=S-g,k=M-d,j=T-g;return A*A+E*E>k*k+j*j&&(x=M,S=T),[[x-u,S-l],[x*n/_,S*n/_]]}function go(t){function e(e){function s(){l.push("M",o(t(c),a))}for(var u,l=[],c=[],h=-1,f=e.length,p=Et(n),d=Et(i);++h<f;)r.call(this,u=e[h],h)?c.push([+p.call(this,u,h),+d.call(this,u,h)]):c.length&&(s(),c=[]);return c.length&&s(),l.length?l.join(""):null}var n=jn,i=qn,r=je,o=yo,s=o.key,a=.7;return e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(i=t,e):i},e.defined=function(t){return arguments.length?(r=t,e):r},e.interpolate=function(t){return arguments.length?(s="function"==typeof t?o=t:(o=ku.get(t)||yo).key,e):s},e.tension=function(t){return arguments.length?(a=t,e):a},e}function yo(t){return t.join("L")}function mo(t){return yo(t)+"Z"}function vo(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("H",(i[0]+(i=t[e])[0])/2,"V",i[1]);return n>1&&r.push("H",i[0]),r.join("")}function _o(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("V",(i=t[e])[1],"H",i[0]);return r.join("")}function wo(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("H",(i=t[e])[0],"V",i[1]);return r.join("")}function bo(t,e){return t.length<4?yo(t):t[1]+Mo(t.slice(1,-1),To(t,e))}function xo(t,e){return t.length<3?yo(t):t[0]+Mo((t.push(t[0]),t),To([t[t.length-2]].concat(t,[t[1]]),e))}function So(t,e){return t.length<3?yo(t):t[0]+Mo(t,To(t,e))}function Mo(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return yo(t);var n=t.length!=e.length,i="",r=t[0],o=t[1],s=e[0],a=s,u=1;if(n&&(i+="Q"+(o[0]-2*s[0]/3)+","+(o[1]-2*s[1]/3)+","+o[0]+","+o[1],r=t[1],u=2),e.length>1){a=e[1],o=t[u],u++,i+="C"+(r[0]+s[0])+","+(r[1]+s[1])+","+(o[0]-a[0])+","+(o[1]-a[1])+","+o[0]+","+o[1];for(var l=2;l<e.length;l++,u++)o=t[u],a=e[l],i+="S"+(o[0]-a[0])+","+(o[1]-a[1])+","+o[0]+","+o[1]}if(n){var c=t[u];i+="Q"+(o[0]+2*a[0]/3)+","+(o[1]+2*a[1]/3)+","+c[0]+","+c[1]}return i}function To(t,e){for(var n,i=[],r=(1-e)/2,o=t[0],s=t[1],a=1,u=t.length;++a<u;)n=o,o=s,s=t[a],i.push([r*(s[0]-n[0]),r*(s[1]-n[1])]);return i}function Ao(t){if(t.length<3)return yo(t);var e=1,n=t.length,i=t[0],r=i[0],o=i[1],s=[r,r,r,(i=t[1])[0]],a=[o,o,o,i[1]],u=[r,",",o,"L",qo(Pu,s),",",qo(Pu,a)];for(t.push(t[n-1]);++e<=n;)i=t[e],s.shift(),s.push(i[0]),a.shift(),a.push(i[1]),Po(u,s,a);return t.pop(),u.push("L",i),u.join("")}function Eo(t){if(t.length<4)return yo(t);for(var e,n=[],i=-1,r=t.length,o=[0],s=[0];++i<3;)e=t[i],o.push(e[0]),s.push(e[1]);for(n.push(qo(Pu,o)+","+qo(Pu,s)),--i;++i<r;)e=t[i],o.shift(),o.push(e[0]),s.shift(),s.push(e[1]),Po(n,o,s);return n.join("")}function ko(t){for(var e,n,i=-1,r=t.length,o=r+4,s=[],a=[];++i<4;)n=t[i%r],s.push(n[0]),a.push(n[1]);for(e=[qo(Pu,s),",",qo(Pu,a)],--i;++i<o;)n=t[i%r],s.shift(),s.push(n[0]),a.shift(),a.push(n[1]),Po(e,s,a);return e.join("")}function jo(t,e){var n=t.length-1;if(n)for(var i,r,o=t[0][0],s=t[0][1],a=t[n][0]-o,u=t[n][1]-s,l=-1;++l<=n;)i=t[l],r=l/n,i[0]=e*i[0]+(1-e)*(o+r*a),i[1]=e*i[1]+(1-e)*(s+r*u);return Ao(t)}function qo(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Po(t,e,n){t.push("C",qo(ju,e),",",qo(ju,n),",",qo(qu,e),",",qo(qu,n),",",qo(Pu,e),",",qo(Pu,n))}function Oo(t,e){return(e[1]-t[1])/(e[0]-t[0])}function Fo(t){for(var e=0,n=t.length-1,i=[],r=t[0],o=t[1],s=i[0]=Oo(r,o);++e<n;)i[e]=(s+(s=Oo(r=o,o=t[e+1])))/2;return i[e]=s,i}function Ro(t){for(var e,n,i,r,o=[],s=Fo(t),a=-1,u=t.length-1;++a<u;)e=Oo(t[a],t[a+1]),gs(e)<Ps?s[a]=s[a+1]=0:(n=s[a]/e,i=s[a+1]/e,r=n*n+i*i,r>9&&(r=3*e/Math.sqrt(r),s[a]=r*n,s[a+1]=r*i));for(a=-1;++a<=u;)r=(t[Math.min(u,a+1)][0]-t[Math.max(0,a-1)][0])/(6*(1+s[a]*s[a])),o.push([r||0,s[a]*r||0]);return o}function No(t){return t.length<3?yo(t):t[0]+Mo(t,Ro(t))}function Co(t){for(var e,n,i,r=-1,o=t.length;++r<o;)e=t[r],n=e[0],i=e[1]-Cs,e[0]=n*Math.cos(i),e[1]=n*Math.sin(i);return t}function Lo(t){function e(e){function u(){g.push("M",a(t(m),h),c,l(t(y.reverse()),h),"Z")}for(var f,p,d,g=[],y=[],m=[],v=-1,_=e.length,w=Et(n),b=Et(r),x=n===i?function(){return p}:Et(i),S=r===o?function(){return d}:Et(o);++v<_;)s.call(this,f=e[v],v)?(y.push([p=+w.call(this,f,v),d=+b.call(this,f,v)]),m.push([+x.call(this,f,v),+S.call(this,f,v)])):y.length&&(u(),y=[],m=[]);return y.length&&u(),g.length?g.join(""):null}var n=jn,i=jn,r=0,o=qn,s=je,a=yo,u=a.key,l=a,c="L",h=.7;return e.x=function(t){return arguments.length?(n=i=t,e):i},e.x0=function(t){return arguments.length?(n=t,e):n},e.x1=function(t){return arguments.length?(i=t,e):i},e.y=function(t){return arguments.length?(r=o=t,e):o},e.y0=function(t){return arguments.length?(r=t,e):r},e.y1=function(t){return arguments.length?(o=t,e):o},e.defined=function(t){return arguments.length?(s=t,e):s},e.interpolate=function(t){return arguments.length?(u="function"==typeof t?a=t:(a=ku.get(t)||yo).key,l=a.reverse||a,c=a.closed?"M":"L",e):u},e.tension=function(t){return arguments.length?(h=t,e):h},e}function Do(t){return t.radius}function Bo(t){return[t.x,t.y]}function zo(t){return function(){var e=t.apply(this,arguments),n=e[0],i=e[1]-Cs;return[n*Math.cos(i),n*Math.sin(i)]}}function Io(){return 64}function Uo(){return"circle"}function Go(t){var e=Math.sqrt(t/Fs);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function Vo(t){return function(){var e,n;(e=this[t])&&(n=e[e.active])&&(--e.count?delete e[e.active]:delete this[t],e.active+=.5,n.event&&n.event.interrupt.call(this,this.__data__,n.index))}}function Wo(t,e,n){return ws(t,Du),t.namespace=e,t.id=n,t}function Yo(t,e,n,i){var r=t.id,o=t.namespace;return V(t,"function"==typeof n?function(t,s,a){t[o][r].tween.set(e,i(n.call(t,t.__data__,s,a)))}:(n=i(n),function(t){t[o][r].tween.set(e,n)}))}function Qo(t){return null==t&&(t=""),function(){this.textContent=t}}function Ho(t){return null==t?"__transition__":"__transition_"+t+"__"}function $o(t,e,n,i,r){var o=t[n]||(t[n]={active:0,count:0}),s=o[i];if(!s){var a=r.time;s=o[i]={tween:new c,time:a,delay:r.delay,duration:r.duration,ease:r.ease,index:e},r=null,++o.count,is.timer(function(r){function u(n){if(o.active>i)return c();var r=o[o.active];r&&(--o.count,delete o[o.active],r.event&&r.event.interrupt.call(t,t.__data__,r.index)),o.active=i,s.event&&s.event.start.call(t,t.__data__,e),s.tween.forEach(function(n,i){(i=i.call(t,t.__data__,e))&&g.push(i)}),f=s.ease,h=s.duration,is.timer(function(){return d.c=l(n||1)?je:l,1},0,a)}function l(n){if(o.active!==i)return 1;for(var r=n/h,a=f(r),u=g.length;u>0;)g[--u].call(t,a);return r>=1?(s.event&&s.event.end.call(t,t.__data__,e),c()):void 0}function c(){return--o.count?delete o[i]:delete t[n],1}var h,f,p=s.delay,d=ra,g=[];return d.t=p+a,r>=p?u(r-p):void(d.c=u)},0,a)}}function Zo(t,e,n){t.attr("transform",function(t){var i=e(t);return"translate("+(isFinite(i)?i:n(t))+",0)"})}function Xo(t,e,n){t.attr("transform",function(t){var i=e(t);return"translate(0,"+(isFinite(i)?i:n(t))+")"})}function Jo(t){return t.toISOString()}function Ko(t,e,n){function i(e){return t(e)}function r(t,n){var i=t[1]-t[0],r=i/n,o=is.bisect(Qu,r);return o==Qu.length?[e.year,Qr(t.map(function(t){return t/31536e6}),n)[2]]:o?e[r/Qu[o-1]<Qu[o]/r?o-1:o]:[Zu,Qr(t,n)[2]]}return i.invert=function(e){return ts(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain().map(ts)},i.nice=function(t,e){function n(n){return!isNaN(n)&&!t.range(n,ts(+n+1),e).length}var o=i.domain(),s=Dr(o),a=null==t?r(s,10):"number"==typeof t&&r(s,t);return a&&(t=a[0],e=a[1]),i.domain(Ir(o,e>1?{floor:function(e){for(;n(e=t.floor(e));)e=ts(e-1);return e},ceil:function(e){for(;n(e=t.ceil(e));)e=ts(+e+1);return e}}:t))},i.ticks=function(t,e){var n=Dr(i.domain()),o=null==t?r(n,10):"number"==typeof t?r(n,t):!t.range&&[{range:t},e];return o&&(t=o[0],e=o[1]),t.range(n[0],ts(+n[1]+1),1>e?1:e)},i.tickFormat=function(){return n},i.copy=function(){return Ko(t.copy(),e,n)},Wr(i,t)}function ts(t){return new Date(t)}function es(t){return JSON.parse(t.responseText)}function ns(t){var e=ss.createRange();return e.selectNode(ss.body),e.createContextualFragment(t.responseText)}var is={version:"3.5.6"},rs=[].slice,os=function(t){return rs.call(t)},ss=this.document;if(ss)try{os(ss.documentElement.childNodes)[0].nodeType}catch(as){os=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}if(Date.now||(Date.now=function(){return+new Date}),ss)try{ss.createElement("DIV").style.setProperty("opacity",0,"")}catch(us){var ls=this.Element.prototype,cs=ls.setAttribute,hs=ls.setAttributeNS,fs=this.CSSStyleDeclaration.prototype,ps=fs.setProperty;ls.setAttribute=function(t,e){cs.call(this,t,e+"")},ls.setAttributeNS=function(t,e,n){hs.call(this,t,e,n+"")},fs.setProperty=function(t,e,n){ps.call(this,t,e+"",n)}}is.ascending=i,is.descending=function(t,e){return t>e?-1:e>t?1:e>=t?0:NaN},is.min=function(t,e){var n,i,r=-1,o=t.length;if(1===arguments.length){for(;++r<o;)if(null!=(i=t[r])&&i>=i){n=i;break}for(;++r<o;)null!=(i=t[r])&&n>i&&(n=i)}else{for(;++r<o;)if(null!=(i=e.call(t,t[r],r))&&i>=i){n=i;break}for(;++r<o;)null!=(i=e.call(t,t[r],r))&&n>i&&(n=i)}return n},is.max=function(t,e){var n,i,r=-1,o=t.length;if(1===arguments.length){for(;++r<o;)if(null!=(i=t[r])&&i>=i){n=i;break}for(;++r<o;)null!=(i=t[r])&&i>n&&(n=i)}else{for(;++r<o;)if(null!=(i=e.call(t,t[r],r))&&i>=i){n=i;break}for(;++r<o;)null!=(i=e.call(t,t[r],r))&&i>n&&(n=i)}return n},is.extent=function(t,e){var n,i,r,o=-1,s=t.length;if(1===arguments.length){for(;++o<s;)if(null!=(i=t[o])&&i>=i){n=r=i;break}for(;++o<s;)null!=(i=t[o])&&(n>i&&(n=i),i>r&&(r=i))}else{for(;++o<s;)if(null!=(i=e.call(t,t[o],o))&&i>=i){n=r=i;break}for(;++o<s;)null!=(i=e.call(t,t[o],o))&&(n>i&&(n=i),i>r&&(r=i))}return[n,r]},is.sum=function(t,e){var n,i=0,r=t.length,s=-1;if(1===arguments.length)for(;++s<r;)o(n=+t[s])&&(i+=n);else for(;++s<r;)o(n=+e.call(t,t[s],s))&&(i+=n);return i},is.mean=function(t,e){var n,i=0,s=t.length,a=-1,u=s;if(1===arguments.length)for(;++a<s;)o(n=r(t[a]))?i+=n:--u;else for(;++a<s;)o(n=r(e.call(t,t[a],a)))?i+=n:--u;return u?i/u:void 0},is.quantile=function(t,e){var n=(t.length-1)*e+1,i=Math.floor(n),r=+t[i-1],o=n-i;return o?r+o*(t[i]-r):r},is.median=function(t,e){var n,s=[],a=t.length,u=-1;if(1===arguments.length)for(;++u<a;)o(n=r(t[u]))&&s.push(n);else for(;++u<a;)o(n=r(e.call(t,t[u],u)))&&s.push(n);return s.length?is.quantile(s.sort(i),.5):void 0},is.variance=function(t,e){var n,i,s=t.length,a=0,u=0,l=-1,c=0;if(1===arguments.length)for(;++l<s;)o(n=r(t[l]))&&(i=n-a,a+=i/++c,u+=i*(n-a));else for(;++l<s;)o(n=r(e.call(t,t[l],l)))&&(i=n-a,a+=i/++c,u+=i*(n-a));return c>1?u/(c-1):void 0},is.deviation=function(){var t=is.variance.apply(this,arguments);return t?Math.sqrt(t):t;
};var ds=s(i);is.bisectLeft=ds.left,is.bisect=is.bisectRight=ds.right,is.bisector=function(t){return s(1===t.length?function(e,n){return i(t(e),n)}:t)},is.shuffle=function(t,e,n){(o=arguments.length)<3&&(n=t.length,2>o&&(e=0));for(var i,r,o=n-e;o;)r=Math.random()*o--|0,i=t[o+e],t[o+e]=t[r+e],t[r+e]=i;return t},is.permute=function(t,e){for(var n=e.length,i=new Array(n);n--;)i[n]=t[e[n]];return i},is.pairs=function(t){for(var e,n=0,i=t.length-1,r=t[0],o=new Array(0>i?0:i);i>n;)o[n]=[e=r,r=t[++n]];return o},is.zip=function(){if(!(i=arguments.length))return[];for(var t=-1,e=is.min(arguments,a),n=new Array(e);++t<e;)for(var i,r=-1,o=n[t]=new Array(i);++r<i;)o[r]=arguments[r][t];return n},is.transpose=function(t){return is.zip.apply(is,t)},is.keys=function(t){var e=[];for(var n in t)e.push(n);return e},is.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},is.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},is.merge=function(t){for(var e,n,i,r=t.length,o=-1,s=0;++o<r;)s+=t[o].length;for(n=new Array(s);--r>=0;)for(i=t[r],e=i.length;--e>=0;)n[--s]=i[e];return n};var gs=Math.abs;is.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),(e-t)/n===1/0)throw new Error("infinite range");var i,r=[],o=u(gs(n)),s=-1;if(t*=o,e*=o,n*=o,0>n)for(;(i=t+n*++s)>e;)r.push(i/o);else for(;(i=t+n*++s)<e;)r.push(i/o);return r},is.map=function(t,e){var n=new c;if(t instanceof c)t.forEach(function(t,e){n.set(t,e)});else if(Array.isArray(t)){var i,r=-1,o=t.length;if(1===arguments.length)for(;++r<o;)n.set(r,t[r]);else for(;++r<o;)n.set(e.call(t,i=t[r],r),i)}else for(var s in t)n.set(s,t[s]);return n};var ys="__proto__",ms="\x00";l(c,{has:p,get:function(t){return this._[h(t)]},set:function(t,e){return this._[h(t)]=e},remove:d,keys:g,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:f(e),value:this._[e]});return t},size:y,empty:m,forEach:function(t){for(var e in this._)t.call(this,f(e),this._[e])}}),is.nest=function(){function t(e,s,a){if(a>=o.length)return i?i.call(r,s):n?s.sort(n):s;for(var u,l,h,f,p=-1,d=s.length,g=o[a++],y=new c;++p<d;)(f=y.get(u=g(l=s[p])))?f.push(l):y.set(u,[l]);return e?(l=e(),h=function(n,i){l.set(n,t(e,i,a))}):(l={},h=function(n,i){l[n]=t(e,i,a)}),y.forEach(h),l}function e(t,n){if(n>=o.length)return t;var i=[],r=s[n++];return t.forEach(function(t,r){i.push({key:t,values:e(r,n)})}),r?i.sort(function(t,e){return r(t.key,e.key)}):i}var n,i,r={},o=[],s=[];return r.map=function(e,n){return t(n,e,0)},r.entries=function(n){return e(t(is.map,n,0),0)},r.key=function(t){return o.push(t),r},r.sortKeys=function(t){return s[o.length-1]=t,r},r.sortValues=function(t){return n=t,r},r.rollup=function(t){return i=t,r},r},is.set=function(t){var e=new v;if(t)for(var n=0,i=t.length;i>n;++n)e.add(t[n]);return e},l(v,{has:p,add:function(t){return this._[h(t+="")]=!0,t},remove:d,values:g,size:y,empty:m,forEach:function(t){for(var e in this._)t.call(this,f(e))}}),is.behavior={},is.rebind=function(t,e){for(var n,i=1,r=arguments.length;++i<r;)t[n=arguments[i]]=w(t,e,e[n]);return t};var vs=["webkit","ms","moz","Moz","o","O"];is.dispatch=function(){for(var t=new S,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=M(t);return t},S.prototype.on=function(t,e){var n=t.indexOf("."),i="";if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t)return arguments.length<2?this[t].on(i):this[t].on(i,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(i,null);return this}},is.event=null,is.requote=function(t){return t.replace(_s,"\\$&")};var _s=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,ws={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]},bs=function(t,e){return e.querySelector(t)},xs=function(t,e){return e.querySelectorAll(t)},Ss=function(t,e){var n=t.matches||t[b(t,"matchesSelector")];return(Ss=function(t,e){return n.call(t,e)})(t,e)};"function"==typeof Sizzle&&(bs=function(t,e){return Sizzle(t,e)[0]||null},xs=Sizzle,Ss=Sizzle.matchesSelector),is.selection=function(){return is.select(ss.documentElement)};var Ms=is.selection.prototype=[];Ms.select=function(t){var e,n,i,r,o=[];t=j(t);for(var s=-1,a=this.length;++s<a;){o.push(e=[]),e.parentNode=(i=this[s]).parentNode;for(var u=-1,l=i.length;++u<l;)(r=i[u])?(e.push(n=t.call(r,r.__data__,u,s)),n&&"__data__"in r&&(n.__data__=r.__data__)):e.push(null)}return k(o)},Ms.selectAll=function(t){var e,n,i=[];t=q(t);for(var r=-1,o=this.length;++r<o;)for(var s=this[r],a=-1,u=s.length;++a<u;)(n=s[a])&&(i.push(e=os(t.call(n,n.__data__,a,r))),e.parentNode=n);return k(i)};var Ts={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};is.ns={prefix:Ts,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&(n=t.slice(0,e),t=t.slice(e+1)),Ts.hasOwnProperty(n)?{space:Ts[n],local:t}:t}},Ms.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return t=is.ns.qualify(t),t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(P(e,t[e]));return this}return this.each(P(t,e))},Ms.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),i=(t=R(t)).length,r=-1;if(e=n.classList){for(;++r<i;)if(!e.contains(t[r]))return!1}else for(e=n.getAttribute("class");++r<i;)if(!F(t[r]).test(e))return!1;return!0}for(e in t)this.each(N(e,t[e]));return this}return this.each(N(t,e))},Ms.style=function(t,e,i){var r=arguments.length;if(3>r){if("string"!=typeof t){2>r&&(e="");for(i in t)this.each(L(i,t[i],e));return this}if(2>r){var o=this.node();return n(o).getComputedStyle(o,null).getPropertyValue(t)}i=""}return this.each(L(t,e,i))},Ms.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(D(e,t[e]));return this}return this.each(D(t,e))},Ms.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},Ms.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},Ms.append=function(t){return t=B(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},Ms.insert=function(t,e){return t=B(t),e=j(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},Ms.remove=function(){return this.each(z)},Ms.data=function(t,e){function n(t,n){var i,r,o,s=t.length,h=n.length,f=Math.min(s,h),p=new Array(h),d=new Array(h),g=new Array(s);if(e){var y,m=new c,v=new Array(s);for(i=-1;++i<s;)m.has(y=e.call(r=t[i],r.__data__,i))?g[i]=r:m.set(y,r),v[i]=y;for(i=-1;++i<h;)(r=m.get(y=e.call(n,o=n[i],i)))?r!==!0&&(p[i]=r,r.__data__=o):d[i]=I(o),m.set(y,!0);for(i=-1;++i<s;)m.get(v[i])!==!0&&(g[i]=t[i])}else{for(i=-1;++i<f;)r=t[i],o=n[i],r?(r.__data__=o,p[i]=r):d[i]=I(o);for(;h>i;++i)d[i]=I(n[i]);for(;s>i;++i)g[i]=t[i]}d.update=p,d.parentNode=p.parentNode=g.parentNode=t.parentNode,a.push(d),u.push(p),l.push(g)}var i,r,o=-1,s=this.length;if(!arguments.length){for(t=new Array(s=(i=this[0]).length);++o<s;)(r=i[o])&&(t[o]=r.__data__);return t}var a=W([]),u=k([]),l=k([]);if("function"==typeof t)for(;++o<s;)n(i=this[o],t.call(i,i.parentNode.__data__,o));else for(;++o<s;)n(i=this[o],t);return u.enter=function(){return a},u.exit=function(){return l},u},Ms.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},Ms.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=U(t));for(var o=0,s=this.length;s>o;o++){r.push(e=[]),e.parentNode=(n=this[o]).parentNode;for(var a=0,u=n.length;u>a;a++)(i=n[a])&&t.call(i,i.__data__,a,o)&&e.push(i)}return k(r)},Ms.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,i=this[t],r=i.length-1,o=i[r];--r>=0;)(n=i[r])&&(o&&o!==n.nextSibling&&o.parentNode.insertBefore(n,o),o=n);return this},Ms.sort=function(t){t=G.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},Ms.each=function(t){return V(this,function(e,n,i){t.call(e,e.__data__,n,i)})},Ms.call=function(t){var e=os(arguments);return t.apply(e[0]=this,e),this},Ms.empty=function(){return!this.node()},Ms.node=function(){for(var t=0,e=this.length;e>t;t++)for(var n=this[t],i=0,r=n.length;r>i;i++){var o=n[i];if(o)return o}return null},Ms.size=function(){var t=0;return V(this,function(){++t}),t};var As=[];is.selection.enter=W,is.selection.enter.prototype=As,As.append=Ms.append,As.empty=Ms.empty,As.node=Ms.node,As.call=Ms.call,As.size=Ms.size,As.select=function(t){for(var e,n,i,r,o,s=[],a=-1,u=this.length;++a<u;){i=(r=this[a]).update,s.push(e=[]),e.parentNode=r.parentNode;for(var l=-1,c=r.length;++l<c;)(o=r[l])?(e.push(i[l]=n=t.call(r.parentNode,o.__data__,l,a)),n.__data__=o.__data__):e.push(null)}return k(s)},As.insert=function(t,e){return arguments.length<2&&(e=Y(this)),Ms.insert.call(this,t,e)},is.select=function(e){var n;return"string"==typeof e?(n=[bs(e,ss)],n.parentNode=ss.documentElement):(n=[e],n.parentNode=t(e)),k([n])},is.selectAll=function(t){var e;return"string"==typeof t?(e=os(xs(t,ss)),e.parentNode=ss.documentElement):(e=t,e.parentNode=null),k([e])},Ms.on=function(t,e,n){var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(e=!1);for(n in t)this.each(Q(n,t[n],e));return this}if(2>i)return(i=this.node()["__on"+t])&&i._;n=!1}return this.each(Q(t,e,n))};var Es=is.map({mouseenter:"mouseover",mouseleave:"mouseout"});ss&&Es.forEach(function(t){"on"+t in ss&&Es.remove(t)});var ks,js=0;is.mouse=function(t){return X(t,A())};var qs=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;is.touch=function(t,e,n){if(arguments.length<3&&(n=e,e=A().changedTouches),e)for(var i,r=0,o=e.length;o>r;++r)if((i=e[r]).identifier===n)return X(t,i)},is.behavior.drag=function(){function t(){this.on("mousedown.drag",o).on("touchstart.drag",s)}function e(t,e,n,o,s){return function(){function a(){var t,n,i=e(f,g);i&&(t=i[0]-_[0],n=i[1]-_[1],d|=t|n,_=i,p({type:"drag",x:i[0]+l[0],y:i[1]+l[1],dx:t,dy:n}))}function u(){e(f,g)&&(m.on(o+y,null).on(s+y,null),v(d&&is.event.target===h),p({type:"dragend"}))}var l,c=this,h=is.event.target,f=c.parentNode,p=i.of(c,arguments),d=0,g=t(),y=".drag"+(null==g?"":"-"+g),m=is.select(n(h)).on(o+y,a).on(s+y,u),v=Z(h),_=e(f,g);r?(l=r.apply(c,arguments),l=[l.x-_[0],l.y-_[1]]):l=[0,0],p({type:"dragstart"})}}var i=E(t,"drag","dragstart","dragend"),r=null,o=e(x,is.mouse,n,"mousemove","mouseup"),s=e(J,is.touch,_,"touchmove","touchend");return t.origin=function(e){return arguments.length?(r=e,t):r},is.rebind(t,i,"on")},is.touches=function(t,e){return arguments.length<2&&(e=A().touches),e?os(e).map(function(e){var n=X(t,e);return n.identifier=e.identifier,n}):[]};var Ps=1e-6,Os=Ps*Ps,Fs=Math.PI,Rs=2*Fs,Ns=Rs-Ps,Cs=Fs/2,Ls=Fs/180,Ds=180/Fs,Bs=Math.SQRT2,zs=2,Is=4;is.interpolateZoom=function(t,e){function n(t){var e=t*v;if(m){var n=rt(g),s=o/(zs*f)*(n*ot(Bs*e+g)-it(g));return[i+s*l,r+s*c,o*n/rt(Bs*e+g)]}return[i+t*l,r+t*c,o*Math.exp(Bs*e)]}var i=t[0],r=t[1],o=t[2],s=e[0],a=e[1],u=e[2],l=s-i,c=a-r,h=l*l+c*c,f=Math.sqrt(h),p=(u*u-o*o+Is*h)/(2*o*zs*f),d=(u*u-o*o-Is*h)/(2*u*zs*f),g=Math.log(Math.sqrt(p*p+1)-p),y=Math.log(Math.sqrt(d*d+1)-d),m=y-g,v=(m||Math.log(u/o))/Bs;return n.duration=1e3*v,n},is.behavior.zoom=function(){function t(t){t.on(P,h).on(Gs+".zoom",p).on("dblclick.zoom",d).on(R,f)}function e(t){return[(t[0]-M.x)/M.k,(t[1]-M.y)/M.k]}function i(t){return[t[0]*M.k+M.x,t[1]*M.k+M.y]}function r(t){M.k=Math.max(k[0],Math.min(k[1],t))}function o(t,e){e=i(e),M.x+=t[0]-e[0],M.y+=t[1]-e[1]}function s(e,n,i,s){e.__chart__={x:M.x,y:M.y,k:M.k},r(Math.pow(2,s)),o(y=n,i),e=is.select(e),j>0&&(e=e.transition().duration(j)),e.call(t.event)}function a(){b&&b.domain(w.range().map(function(t){return(t-M.x)/M.k}).map(w.invert)),S&&S.domain(x.range().map(function(t){return(t-M.y)/M.k}).map(x.invert))}function u(t){q++||t({type:"zoomstart"})}function l(t){a(),t({type:"zoom",scale:M.k,translate:[M.x,M.y]})}function c(t){--q||(t({type:"zoomend"}),y=null)}function h(){function t(){h=1,o(is.mouse(r),p),l(a)}function i(){f.on(O,null).on(F,null),d(h&&is.event.target===s),c(a)}var r=this,s=is.event.target,a=N.of(r,arguments),h=0,f=is.select(n(r)).on(O,t).on(F,i),p=e(is.mouse(r)),d=Z(r);Lu.call(r),u(a)}function f(){function t(){var t=is.touches(d);return p=M.k,t.forEach(function(t){t.identifier in y&&(y[t.identifier]=e(t))}),t}function n(){var e=is.event.target;is.select(e).on(w,i).on(b,a),x.push(e);for(var n=is.event.changedTouches,r=0,o=n.length;o>r;++r)y[n[r].identifier]=null;var u=t(),l=Date.now();if(1===u.length){if(500>l-_){var c=u[0];s(d,c,y[c.identifier],Math.floor(Math.log(M.k)/Math.LN2)+1),T()}_=l}else if(u.length>1){var c=u[0],h=u[1],f=c[0]-h[0],p=c[1]-h[1];m=f*f+p*p}}function i(){var t,e,n,i,s=is.touches(d);Lu.call(d);for(var a=0,u=s.length;u>a;++a,i=null)if(n=s[a],i=y[n.identifier]){if(e)break;t=n,e=i}if(i){var c=(c=n[0]-t[0])*c+(c=n[1]-t[1])*c,h=m&&Math.sqrt(c/m);t=[(t[0]+n[0])/2,(t[1]+n[1])/2],e=[(e[0]+i[0])/2,(e[1]+i[1])/2],r(h*p)}_=null,o(t,e),l(g)}function a(){if(is.event.touches.length){for(var e=is.event.changedTouches,n=0,i=e.length;i>n;++n)delete y[e[n].identifier];for(var r in y)return void t()}is.selectAll(x).on(v,null),S.on(P,h).on(R,f),A(),c(g)}var p,d=this,g=N.of(d,arguments),y={},m=0,v=".zoom-"+is.event.changedTouches[0].identifier,w="touchmove"+v,b="touchend"+v,x=[],S=is.select(d),A=Z(d);n(),u(g),S.on(P,null).on(R,n)}function p(){var t=N.of(this,arguments);v?clearTimeout(v):(Lu.call(this),g=e(y=m||is.mouse(this)),u(t)),v=setTimeout(function(){v=null,c(t)},50),T(),r(Math.pow(2,.002*Us())*M.k),o(y,g),l(t)}function d(){var t=is.mouse(this),n=Math.log(M.k)/Math.LN2;s(this,t,e(t),is.event.shiftKey?Math.ceil(n)-1:Math.floor(n)+1)}var g,y,m,v,_,w,b,x,S,M={x:0,y:0,k:1},A=[960,500],k=Vs,j=250,q=0,P="mousedown.zoom",O="mousemove.zoom",F="mouseup.zoom",R="touchstart.zoom",N=E(t,"zoomstart","zoom","zoomend");return Gs||(Gs="onwheel"in ss?(Us=function(){return-is.event.deltaY*(is.event.deltaMode?120:1)},"wheel"):"onmousewheel"in ss?(Us=function(){return is.event.wheelDelta},"mousewheel"):(Us=function(){return-is.event.detail},"MozMousePixelScroll")),t.event=function(t){t.each(function(){var t=N.of(this,arguments),e=M;Nu?is.select(this).transition().each("start.zoom",function(){M=this.__chart__||{x:0,y:0,k:1},u(t)}).tween("zoom:zoom",function(){var n=A[0],i=A[1],r=y?y[0]:n/2,o=y?y[1]:i/2,s=is.interpolateZoom([(r-M.x)/M.k,(o-M.y)/M.k,n/M.k],[(r-e.x)/e.k,(o-e.y)/e.k,n/e.k]);return function(e){var i=s(e),a=n/i[2];this.__chart__=M={x:r-i[0]*a,y:o-i[1]*a,k:a},l(t)}}).each("interrupt.zoom",function(){c(t)}).each("end.zoom",function(){c(t)}):(this.__chart__=M,u(t),l(t),c(t))})},t.translate=function(e){return arguments.length?(M={x:+e[0],y:+e[1],k:M.k},a(),t):[M.x,M.y]},t.scale=function(e){return arguments.length?(M={x:M.x,y:M.y,k:+e},a(),t):M.k},t.scaleExtent=function(e){return arguments.length?(k=null==e?Vs:[+e[0],+e[1]],t):k},t.center=function(e){return arguments.length?(m=e&&[+e[0],+e[1]],t):m},t.size=function(e){return arguments.length?(A=e&&[+e[0],+e[1]],t):A},t.duration=function(e){return arguments.length?(j=+e,t):j},t.x=function(e){return arguments.length?(b=e,w=e.copy(),M={x:0,y:0,k:1},t):b},t.y=function(e){return arguments.length?(S=e,x=e.copy(),M={x:0,y:0,k:1},t):S},is.rebind(t,N,"on")};var Us,Gs,Vs=[0,1/0];is.color=at,at.prototype.toString=function(){return this.rgb()+""},is.hsl=ut;var Ws=ut.prototype=new at;Ws.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new ut(this.h,this.s,this.l/t)},Ws.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new ut(this.h,this.s,t*this.l)},Ws.rgb=function(){return lt(this.h,this.s,this.l)},is.hcl=ct;var Ys=ct.prototype=new at;Ys.brighter=function(t){return new ct(this.h,this.c,Math.min(100,this.l+Qs*(arguments.length?t:1)))},Ys.darker=function(t){return new ct(this.h,this.c,Math.max(0,this.l-Qs*(arguments.length?t:1)))},Ys.rgb=function(){return ht(this.h,this.c,this.l).rgb()},is.lab=ft;var Qs=18,Hs=.95047,$s=1,Zs=1.08883,Xs=ft.prototype=new at;Xs.brighter=function(t){return new ft(Math.min(100,this.l+Qs*(arguments.length?t:1)),this.a,this.b)},Xs.darker=function(t){return new ft(Math.max(0,this.l-Qs*(arguments.length?t:1)),this.a,this.b)},Xs.rgb=function(){return pt(this.l,this.a,this.b)},is.rgb=vt;var Js=vt.prototype=new at;Js.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,i=this.b,r=30;return e||n||i?(e&&r>e&&(e=r),n&&r>n&&(n=r),i&&r>i&&(i=r),new vt(Math.min(255,e/t),Math.min(255,n/t),Math.min(255,i/t))):new vt(r,r,r)},Js.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new vt(t*this.r,t*this.g,t*this.b)},Js.hsl=function(){return St(this.r,this.g,this.b)},Js.toString=function(){return"#"+bt(this.r)+bt(this.g)+bt(this.b)};var Ks=is.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Ks.forEach(function(t,e){Ks.set(t,_t(e))}),is.functor=Et,is.xhr=kt(_),is.dsv=function(t,e){function n(t,n,o){arguments.length<3&&(o=n,n=null);var s=jt(t,e,null==n?i:r(n),o);return s.row=function(t){return arguments.length?s.response(null==(n=t)?i:r(t)):n},s}function i(t){return n.parse(t.responseText)}function r(t){return function(e){return n.parse(e.responseText,t)}}function o(e){return e.map(s).join(t)}function s(t){return a.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var a=new RegExp('["'+t+"\n]"),u=t.charCodeAt(0);return n.parse=function(t,e){var i;return n.parseRows(t,function(t,n){if(i)return i(t,n-1);var r=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");i=e?function(t,n){return e(r(t),n)}:r})},n.parseRows=function(t,e){function n(){if(c>=l)return s;if(r)return r=!1,o;var e=c;if(34===t.charCodeAt(e)){for(var n=e;n++<l;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}c=n+2;var i=t.charCodeAt(n+1);return 13===i?(r=!0,10===t.charCodeAt(n+2)&&++c):10===i&&(r=!0),t.slice(e+1,n).replace(/""/g,'"')}for(;l>c;){var i=t.charCodeAt(c++),a=1;if(10===i)r=!0;else if(13===i)r=!0,10===t.charCodeAt(c)&&(++c,++a);else if(i!==u)continue;return t.slice(e,c-a)}return t.slice(e)}for(var i,r,o={},s={},a=[],l=t.length,c=0,h=0;(i=n())!==s;){for(var f=[];i!==o&&i!==s;)f.push(i),i=n();e&&null==(f=e(f,h++))||a.push(f)}return a},n.format=function(e){if(Array.isArray(e[0]))return n.formatRows(e);var i=new v,r=[];return e.forEach(function(t){for(var e in t)i.has(e)||r.push(i.add(e))}),[r.map(s).join(t)].concat(e.map(function(e){return r.map(function(t){return s(e[t])}).join(t)})).join("\n")},n.formatRows=function(t){return t.map(o).join("\n")},n},is.csv=is.dsv(",","text/csv"),is.tsv=is.dsv("	","text/tab-separated-values");var ta,ea,na,ia,ra,oa=this[b(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};is.timer=function(t,e,n){var i=arguments.length;2>i&&(e=0),3>i&&(n=Date.now());var r=n+e,o={c:t,t:r,f:!1,n:null};ea?ea.n=o:ta=o,ea=o,na||(ia=clearTimeout(ia),na=1,oa(Ot))},is.timer.flush=function(){Ft(),Rt()},is.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var sa=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(Ct);is.formatPrefix=function(t,e){var n=0;return t&&(0>t&&(t*=-1),e&&(t=is.round(t,Nt(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),sa[8+n/3]};var aa=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,ua=is.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=is.round(t,Nt(t,e))).toFixed(Math.max(0,Math.min(20,Nt(t*(1+1e-15),e))))}}),la=is.time={},ca=Date;Bt.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){ha.setUTCDate.apply(this._,arguments)},setDay:function(){ha.setUTCDay.apply(this._,arguments)},setFullYear:function(){ha.setUTCFullYear.apply(this._,arguments)},setHours:function(){ha.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){ha.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){ha.setUTCMinutes.apply(this._,arguments)},setMonth:function(){ha.setUTCMonth.apply(this._,arguments)},setSeconds:function(){ha.setUTCSeconds.apply(this._,arguments)},setTime:function(){ha.setTime.apply(this._,arguments)}};var ha=Date.prototype;la.year=zt(function(t){return t=la.day(t),t.setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),la.years=la.year.range,la.years.utc=la.year.utc.range,la.day=zt(function(t){var e=new ca(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),la.days=la.day.range,la.days.utc=la.day.utc.range,la.dayOfYear=function(t){var e=la.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,e){e=7-e;var n=la[t]=zt(function(t){return(t=la.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var n=la.year(t).getDay();return Math.floor((la.dayOfYear(t)+(n+e)%7)/7)-(n!==e)});la[t+"s"]=n.range,la[t+"s"].utc=n.utc.range,la[t+"OfYear"]=function(t){var n=la.year(t).getDay();return Math.floor((la.dayOfYear(t)+(n+e)%7)/7)}}),la.week=la.sunday,la.weeks=la.sunday.range,la.weeks.utc=la.sunday.utc.range,la.weekOfYear=la.sundayOfYear;var fa={"-":"",_:" ",0:"0"},pa=/^\s*\d+/,da=/^%/;is.locale=function(t){return{numberFormat:Lt(t),timeFormat:Ut(t)}};var ga=is.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});is.format=ga.numberFormat,is.geo={},le.prototype={s:0,t:0,add:function(t){ce(t,this.t,ya),ce(ya.s,this.s,this),this.s?this.t+=ya.t:this.s=ya.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ya=new le;is.geo.stream=function(t,e){t&&ma.hasOwnProperty(t.type)?ma[t.type](t,e):he(t,e)};var ma={Feature:function(t,e){he(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)he(n[i].geometry,e)}},va={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){fe(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)fe(n[i],e,0)},Polygon:function(t,e){pe(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)pe(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)he(n[i],e)}};is.geo.area=function(t){return _a=0,is.geo.stream(t,ba),_a};var _a,wa=new le,ba={sphere:function(){_a+=4*Fs},point:x,lineStart:x,lineEnd:x,polygonStart:function(){wa.reset(),ba.lineStart=de},polygonEnd:function(){var t=2*wa;_a+=0>t?4*Fs+t:t,ba.lineStart=ba.lineEnd=ba.point=x}};is.geo.bounds=function(){function t(t,e){_.push(w=[c=t,f=t]),h>e&&(h=e),e>p&&(p=e)}function e(e,n){var i=ge([e*Ls,n*Ls]);if(m){var r=me(m,i),o=[r[1],-r[0],0],s=me(o,r);we(s),s=be(s);var u=e-d,l=u>0?1:-1,g=s[0]*Ds*l,y=gs(u)>180;if(y^(g>l*d&&l*e>g)){var v=s[1]*Ds;v>p&&(p=v)}else if(g=(g+360)%360-180,y^(g>l*d&&l*e>g)){var v=-s[1]*Ds;h>v&&(h=v)}else h>n&&(h=n),n>p&&(p=n);y?d>e?a(c,e)>a(c,f)&&(f=e):a(e,f)>a(c,f)&&(c=e):f>=c?(c>e&&(c=e),e>f&&(f=e)):e>d?a(c,e)>a(c,f)&&(f=e):a(e,f)>a(c,f)&&(c=e)}else t(e,n);m=i,d=e}function n(){b.point=e}function i(){w[0]=c,w[1]=f,b.point=t,m=null}function r(t,n){if(m){var i=t-d;v+=gs(i)>180?i+(i>0?360:-360):i}else g=t,y=n;ba.point(t,n),e(t,n)}function o(){ba.lineStart()}function s(){r(g,y),ba.lineEnd(),gs(v)>Ps&&(c=-(f=180)),w[0]=c,w[1]=f,m=null}function a(t,e){return(e-=t)<0?e+360:e}function u(t,e){return t[0]-e[0]}function l(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var c,h,f,p,d,g,y,m,v,_,w,b={point:t,lineStart:n,lineEnd:i,polygonStart:function(){b.point=r,b.lineStart=o,b.lineEnd=s,v=0,ba.polygonStart()},polygonEnd:function(){ba.polygonEnd(),b.point=t,b.lineStart=n,b.lineEnd=i,0>wa?(c=-(f=180),h=-(p=90)):v>Ps?p=90:-Ps>v&&(h=-90),w[0]=c,w[1]=f}};return function(t){p=f=-(c=h=1/0),_=[],is.geo.stream(t,b);var e=_.length;if(e){_.sort(u);for(var n,i=1,r=_[0],o=[r];e>i;++i)n=_[i],l(n[0],r)||l(n[1],r)?(a(r[0],n[1])>a(r[0],r[1])&&(r[1]=n[1]),a(n[0],r[1])>a(r[0],r[1])&&(r[0]=n[0])):o.push(r=n);for(var s,n,d=-(1/0),e=o.length-1,i=0,r=o[e];e>=i;r=n,++i)n=o[i],(s=a(r[1],n[0]))>d&&(d=s,c=n[0],f=r[1])}return _=w=null,c===1/0||h===1/0?[[NaN,NaN],[NaN,NaN]]:[[c,h],[f,p]]}}(),is.geo.centroid=function(t){xa=Sa=Ma=Ta=Aa=Ea=ka=ja=qa=Pa=Oa=0,is.geo.stream(t,Fa);var e=qa,n=Pa,i=Oa,r=e*e+n*n+i*i;return Os>r&&(e=Ea,n=ka,i=ja,Ps>Sa&&(e=Ma,n=Ta,i=Aa),r=e*e+n*n+i*i,Os>r)?[NaN,NaN]:[Math.atan2(n,e)*Ds,nt(i/Math.sqrt(r))*Ds]};var xa,Sa,Ma,Ta,Aa,Ea,ka,ja,qa,Pa,Oa,Fa={sphere:x,point:Se,lineStart:Te,lineEnd:Ae,polygonStart:function(){Fa.lineStart=Ee},polygonEnd:function(){Fa.lineStart=Te}},Ra=Fe(je,Le,Be,[-Fs,-Fs/2]),Na=1e9;is.geo.clipExtent=function(){var t,e,n,i,r,o,s={stream:function(t){return r&&(r.valid=!1),r=o(t),r.valid=!0,r},extent:function(a){return arguments.length?(o=Ge(t=+a[0][0],e=+a[0][1],n=+a[1][0],i=+a[1][1]),r&&(r.valid=!1,r=null),s):[[t,e],[n,i]]}};return s.extent([[0,0],[960,500]])},(is.geo.conicEqualArea=function(){return Ve(We)}).raw=We,is.geo.albers=function(){return is.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},is.geo.albersUsa=function(){function t(t){var o=t[0],s=t[1];return e=null,n(o,s),e||(i(o,s),e)||r(o,s),e}var e,n,i,r,o=is.geo.albers(),s=is.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a=is.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,n){e=[t,n]}};return t.invert=function(t){var e=o.scale(),n=o.translate(),i=(t[0]-n[0])/e,r=(t[1]-n[1])/e;return(r>=.12&&.234>r&&i>=-.425&&-.214>i?s:r>=.166&&.234>r&&i>=-.214&&-.115>i?a:o).invert(t)},t.stream=function(t){var e=o.stream(t),n=s.stream(t),i=a.stream(t);return{point:function(t,r){e.point(t,r),n.point(t,r),i.point(t,r)},sphere:function(){e.sphere(),n.sphere(),i.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),i.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),i.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),i.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),i.polygonEnd()}}},t.precision=function(e){return arguments.length?(o.precision(e),s.precision(e),a.precision(e),t):o.precision()},t.scale=function(e){return arguments.length?(o.scale(e),s.scale(.35*e),a.scale(e),t.translate(o.translate())):o.scale()},t.translate=function(e){if(!arguments.length)return o.translate();var l=o.scale(),c=+e[0],h=+e[1];return n=o.translate(e).clipExtent([[c-.455*l,h-.238*l],[c+.455*l,h+.238*l]]).stream(u).point,i=s.translate([c-.307*l,h+.201*l]).clipExtent([[c-.425*l+Ps,h+.12*l+Ps],[c-.214*l-Ps,h+.234*l-Ps]]).stream(u).point,r=a.translate([c-.205*l,h+.212*l]).clipExtent([[c-.214*l+Ps,h+.166*l+Ps],[c-.115*l-Ps,h+.234*l-Ps]]).stream(u).point,t},t.scale(1070)};var Ca,La,Da,Ba,za,Ia,Ua={point:x,lineStart:x,lineEnd:x,polygonStart:function(){La=0,Ua.lineStart=Ye},polygonEnd:function(){Ua.lineStart=Ua.lineEnd=Ua.point=x,Ca+=gs(La/2)}},Ga={point:Qe,lineStart:x,lineEnd:x,polygonStart:x,polygonEnd:x},Va={point:Ze,lineStart:Xe,lineEnd:Je,polygonStart:function(){Va.lineStart=Ke},polygonEnd:function(){Va.point=Ze,Va.lineStart=Xe,Va.lineEnd=Je}};is.geo.path=function(){function t(t){return t&&("function"==typeof a&&o.pointRadius(+a.apply(this,arguments)),s&&s.valid||(s=r(o)),is.geo.stream(t,s)),o.result()}function e(){return s=null,t}var n,i,r,o,s,a=4.5;return t.area=function(t){return Ca=0,is.geo.stream(t,r(Ua)),Ca},t.centroid=function(t){return Ma=Ta=Aa=Ea=ka=ja=qa=Pa=Oa=0,is.geo.stream(t,r(Va)),Oa?[qa/Oa,Pa/Oa]:ja?[Ea/ja,ka/ja]:Aa?[Ma/Aa,Ta/Aa]:[NaN,NaN]},t.bounds=function(t){
return za=Ia=-(Da=Ba=1/0),is.geo.stream(t,r(Ga)),[[Da,Ba],[za,Ia]]},t.projection=function(t){return arguments.length?(r=(n=t)?t.stream||nn(t):_,e()):n},t.context=function(t){return arguments.length?(o=null==(i=t)?new He:new tn(t),"function"!=typeof a&&o.pointRadius(a),e()):i},t.pointRadius=function(e){return arguments.length?(a="function"==typeof e?e:(o.pointRadius(+e),+e),t):a},t.projection(is.geo.albersUsa()).context(null)},is.geo.transform=function(t){return{stream:function(e){var n=new rn(e);for(var i in t)n[i]=t[i];return n}}},rn.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},is.geo.projection=sn,is.geo.projectionMutator=an,(is.geo.equirectangular=function(){return sn(ln)}).raw=ln.invert=ln,is.geo.rotation=function(t){function e(e){return e=t(e[0]*Ls,e[1]*Ls),e[0]*=Ds,e[1]*=Ds,e}return t=hn(t[0]%360*Ls,t[1]*Ls,t.length>2?t[2]*Ls:0),e.invert=function(e){return e=t.invert(e[0]*Ls,e[1]*Ls),e[0]*=Ds,e[1]*=Ds,e},e},cn.invert=ln,is.geo.circle=function(){function t(){var t="function"==typeof i?i.apply(this,arguments):i,e=hn(-t[0]*Ls,-t[1]*Ls,0).invert,r=[];return n(null,null,1,{point:function(t,n){r.push(t=e(t,n)),t[0]*=Ds,t[1]*=Ds}}),{type:"Polygon",coordinates:[r]}}var e,n,i=[0,0],r=6;return t.origin=function(e){return arguments.length?(i=e,t):i},t.angle=function(i){return arguments.length?(n=gn((e=+i)*Ls,r*Ls),t):e},t.precision=function(i){return arguments.length?(n=gn(e*Ls,(r=+i)*Ls),t):r},t.angle(90)},is.geo.distance=function(t,e){var n,i=(e[0]-t[0])*Ls,r=t[1]*Ls,o=e[1]*Ls,s=Math.sin(i),a=Math.cos(i),u=Math.sin(r),l=Math.cos(r),c=Math.sin(o),h=Math.cos(o);return Math.atan2(Math.sqrt((n=h*s)*n+(n=l*c-u*h*a)*n),u*c+l*h*a)},is.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return is.range(Math.ceil(o/y)*y,r,y).map(f).concat(is.range(Math.ceil(l/m)*m,u,m).map(p)).concat(is.range(Math.ceil(i/d)*d,n,d).filter(function(t){return gs(t%y)>Ps}).map(c)).concat(is.range(Math.ceil(a/g)*g,s,g).filter(function(t){return gs(t%m)>Ps}).map(h))}var n,i,r,o,s,a,u,l,c,h,f,p,d=10,g=d,y=90,m=360,v=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[f(o).concat(p(u).slice(1),f(r).reverse().slice(1),p(l).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.majorExtent(e).minorExtent(e):t.minorExtent()},t.majorExtent=function(e){return arguments.length?(o=+e[0][0],r=+e[1][0],l=+e[0][1],u=+e[1][1],o>r&&(e=o,o=r,r=e),l>u&&(e=l,l=u,u=e),t.precision(v)):[[o,l],[r,u]]},t.minorExtent=function(e){return arguments.length?(i=+e[0][0],n=+e[1][0],a=+e[0][1],s=+e[1][1],i>n&&(e=i,i=n,n=e),a>s&&(e=a,a=s,s=e),t.precision(v)):[[i,a],[n,s]]},t.step=function(e){return arguments.length?t.majorStep(e).minorStep(e):t.minorStep()},t.majorStep=function(e){return arguments.length?(y=+e[0],m=+e[1],t):[y,m]},t.minorStep=function(e){return arguments.length?(d=+e[0],g=+e[1],t):[d,g]},t.precision=function(e){return arguments.length?(v=+e,c=mn(a,s,90),h=vn(i,n,v),f=mn(l,u,90),p=vn(o,r,v),t):v},t.majorExtent([[-180,-90+Ps],[180,90-Ps]]).minorExtent([[-180,-80-Ps],[180,80+Ps]])},is.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[e||i.apply(this,arguments),n||r.apply(this,arguments)]}}var e,n,i=_n,r=wn;return t.distance=function(){return is.geo.distance(e||i.apply(this,arguments),n||r.apply(this,arguments))},t.source=function(n){return arguments.length?(i=n,e="function"==typeof n?null:n,t):i},t.target=function(e){return arguments.length?(r=e,n="function"==typeof e?null:e,t):r},t.precision=function(){return arguments.length?t:0},t},is.geo.interpolate=function(t,e){return bn(t[0]*Ls,t[1]*Ls,e[0]*Ls,e[1]*Ls)},is.geo.length=function(t){return Wa=0,is.geo.stream(t,Ya),Wa};var Wa,Ya={sphere:x,point:x,lineStart:xn,lineEnd:x,polygonStart:x,polygonEnd:x},Qa=Sn(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(is.geo.azimuthalEqualArea=function(){return sn(Qa)}).raw=Qa;var Ha=Sn(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},_);(is.geo.azimuthalEquidistant=function(){return sn(Ha)}).raw=Ha,(is.geo.conicConformal=function(){return Ve(Mn)}).raw=Mn,(is.geo.conicEquidistant=function(){return Ve(Tn)}).raw=Tn;var $a=Sn(function(t){return 1/t},Math.atan);(is.geo.gnomonic=function(){return sn($a)}).raw=$a,An.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-Cs]},(is.geo.mercator=function(){return En(An)}).raw=An;var Za=Sn(function(){return 1},Math.asin);(is.geo.orthographic=function(){return sn(Za)}).raw=Za;var Xa=Sn(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});(is.geo.stereographic=function(){return sn(Xa)}).raw=Xa,kn.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-Cs]},(is.geo.transverseMercator=function(){var t=En(kn),e=t.center,n=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return t?n([t[0],t[1],t.length>2?t[2]+90:90]):(t=n(),[t[0],t[1],t[2]-90])},n([0,0,90])}).raw=kn,is.geom={},is.geom.hull=function(t){function e(t){if(t.length<3)return[];var e,r=Et(n),o=Et(i),s=t.length,a=[],u=[];for(e=0;s>e;e++)a.push([+r.call(this,t[e],e),+o.call(this,t[e],e),e]);for(a.sort(On),e=0;s>e;e++)u.push([a[e][0],-a[e][1]]);var l=Pn(a),c=Pn(u),h=c[0]===l[0],f=c[c.length-1]===l[l.length-1],p=[];for(e=l.length-1;e>=0;--e)p.push(t[a[l[e]][2]]);for(e=+h;e<c.length-f;++e)p.push(t[a[c[e]][2]]);return p}var n=jn,i=qn;return arguments.length?e(t):(e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(i=t,e):i},e)},is.geom.polygon=function(t){return ws(t,Ja),t};var Ja=is.geom.polygon.prototype=[];Ja.area=function(){for(var t,e=-1,n=this.length,i=this[n-1],r=0;++e<n;)t=i,i=this[e],r+=t[1]*i[0]-t[0]*i[1];return.5*r},Ja.centroid=function(t){var e,n,i=-1,r=this.length,o=0,s=0,a=this[r-1];for(arguments.length||(t=-1/(6*this.area()));++i<r;)e=a,a=this[i],n=e[0]*a[1]-a[0]*e[1],o+=(e[0]+a[0])*n,s+=(e[1]+a[1])*n;return[o*t,s*t]},Ja.clip=function(t){for(var e,n,i,r,o,s,a=Nn(t),u=-1,l=this.length-Nn(this),c=this[l-1];++u<l;){for(e=t.slice(),t.length=0,r=this[u],o=e[(i=e.length-a)-1],n=-1;++n<i;)s=e[n],Fn(s,c,r)?(Fn(o,c,r)||t.push(Rn(o,s,c,r)),t.push(s)):Fn(o,c,r)&&t.push(Rn(o,s,c,r)),o=s;a&&t.push(t[0]),c=r}return t};var Ka,tu,eu,nu,iu,ru=[],ou=[];Gn.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)t=e[n].edge,t.b&&t.a||e.splice(n,1);return e.sort(Wn),e.length},ei.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},ni.prototype={insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=si(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)i=n.U,n===i.L?(r=i.R,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(ri(this,n),t=n,n=t.U),n.C=!1,i.C=!0,oi(this,i))):(r=i.L,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(oi(this,n),t=n,n=t.U),n.C=!1,i.C=!0,ri(this,i))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,o=t.L,s=t.R;if(n=o?s?si(s):o:s,r?r.L===t?r.L=n:r.R=n:this._=n,o&&s?(i=n.C,n.C=t.C,n.L=o,o.U=n,n!==s?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=s,s.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i){if(t&&t.C)return void(t.C=!1);do{if(t===this._)break;if(t===r.L){if(e=r.R,e.C&&(e.C=!1,r.C=!0,ri(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,oi(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,ri(this,r),t=this._;break}}else if(e=r.L,e.C&&(e.C=!1,r.C=!0,oi(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,ri(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,oi(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}},is.geom.voronoi=function(t){function e(t){var e=new Array(t.length),i=a[0][0],r=a[0][1],o=a[1][0],s=a[1][1];return ai(n(t),a).cells.forEach(function(n,a){var u=n.edges,l=n.site,c=e[a]=u.length?u.map(function(t){var e=t.start();return[e.x,e.y]}):l.x>=i&&l.x<=o&&l.y>=r&&l.y<=s?[[i,s],[o,s],[o,r],[i,r]]:[];c.point=t[a]}),e}function n(t){return t.map(function(t,e){return{x:Math.round(o(t,e)/Ps)*Ps,y:Math.round(s(t,e)/Ps)*Ps,i:e}})}var i=jn,r=qn,o=i,s=r,a=su;return t?e(t):(e.links=function(t){return ai(n(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},e.triangles=function(t){var e=[];return ai(n(t)).cells.forEach(function(n,i){for(var r,o,s=n.site,a=n.edges.sort(Wn),u=-1,l=a.length,c=a[l-1].edge,h=c.l===s?c.r:c.l;++u<l;)r=c,o=h,c=a[u].edge,h=c.l===s?c.r:c.l,i<o.i&&i<h.i&&li(s,o,h)<0&&e.push([t[i],t[o.i],t[h.i]])}),e},e.x=function(t){return arguments.length?(o=Et(i=t),e):i},e.y=function(t){return arguments.length?(s=Et(r=t),e):r},e.clipExtent=function(t){return arguments.length?(a=null==t?su:t,e):a===su?null:a},e.size=function(t){return arguments.length?e.clipExtent(t&&[[0,0],t]):a===su?null:a&&a[1]},e)};var su=[[-1e6,-1e6],[1e6,1e6]];is.geom.delaunay=function(t){return is.geom.voronoi().triangles(t)},is.geom.quadtree=function(t,e,n,i,r){function o(t){function o(t,e,n,i,r,o,s,a){if(!isNaN(n)&&!isNaN(i))if(t.leaf){var u=t.x,c=t.y;if(null!=u)if(gs(u-n)+gs(c-i)<.01)l(t,e,n,i,r,o,s,a);else{var h=t.point;t.x=t.y=t.point=null,l(t,h,u,c,r,o,s,a),l(t,e,n,i,r,o,s,a)}else t.x=n,t.y=i,t.point=e}else l(t,e,n,i,r,o,s,a)}function l(t,e,n,i,r,s,a,u){var l=.5*(r+a),c=.5*(s+u),h=n>=l,f=i>=c,p=f<<1|h;t.leaf=!1,t=t.nodes[p]||(t.nodes[p]=fi()),h?r=l:a=l,f?s=c:u=c,o(t,e,n,i,r,s,a,u)}var c,h,f,p,d,g,y,m,v,_=Et(a),w=Et(u);if(null!=e)g=e,y=n,m=i,v=r;else if(m=v=-(g=y=1/0),h=[],f=[],d=t.length,s)for(p=0;d>p;++p)c=t[p],c.x<g&&(g=c.x),c.y<y&&(y=c.y),c.x>m&&(m=c.x),c.y>v&&(v=c.y),h.push(c.x),f.push(c.y);else for(p=0;d>p;++p){var b=+_(c=t[p],p),x=+w(c,p);g>b&&(g=b),y>x&&(y=x),b>m&&(m=b),x>v&&(v=x),h.push(b),f.push(x)}var S=m-g,M=v-y;S>M?v=y+S:m=g+M;var T=fi();if(T.add=function(t){o(T,t,+_(t,++p),+w(t,p),g,y,m,v)},T.visit=function(t){pi(t,T,g,y,m,v)},T.find=function(t){return di(T,t[0],t[1],g,y,m,v)},p=-1,null==e){for(;++p<d;)o(T,t[p],h[p],f[p],g,y,m,v);--p}else t.forEach(T.add);return h=f=t=c=null,T}var s,a=jn,u=qn;return(s=arguments.length)?(a=ci,u=hi,3===s&&(r=n,i=e,n=e=0),o(t)):(o.x=function(t){return arguments.length?(a=t,o):a},o.y=function(t){return arguments.length?(u=t,o):u},o.extent=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=+t[0][0],n=+t[0][1],i=+t[1][0],r=+t[1][1]),o):null==e?null:[[e,n],[i,r]]},o.size=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=n=0,i=+t[0],r=+t[1]),o):null==e?null:[i-e,r-n]},o)},is.interpolateRgb=gi,is.interpolateObject=yi,is.interpolateNumber=mi,is.interpolateString=vi;var au=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,uu=new RegExp(au.source,"g");is.interpolate=_i,is.interpolators=[function(t,e){var n=typeof e;return("string"===n?Ks.has(e.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(e)?gi:vi:e instanceof at?gi:Array.isArray(e)?wi:"object"===n&&isNaN(e)?yi:mi)(t,e)}],is.interpolateArray=wi;var lu=function(){return _},cu=is.map({linear:lu,poly:Ei,quad:function(){return Mi},cubic:function(){return Ti},sin:function(){return ki},exp:function(){return ji},circle:function(){return qi},elastic:Pi,back:Oi,bounce:function(){return Fi}}),hu=is.map({"in":_,out:xi,"in-out":Si,"out-in":function(t){return Si(xi(t))}});is.ease=function(t){var e=t.indexOf("-"),n=e>=0?t.slice(0,e):t,i=e>=0?t.slice(e+1):"in";return n=cu.get(n)||lu,i=hu.get(i)||_,bi(i(n.apply(null,rs.call(arguments,1))))},is.interpolateHcl=Ri,is.interpolateHsl=Ni,is.interpolateLab=Ci,is.interpolateRound=Li,is.transform=function(t){var e=ss.createElementNS(is.ns.prefix.svg,"g");return(is.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new Di(n?n.matrix:fu)})(t)},Di.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var fu={a:1,b:0,c:0,d:1,e:0,f:0};is.interpolateTransform=Ui,is.layout={},is.layout.bundle=function(){return function(t){for(var e=[],n=-1,i=t.length;++n<i;)e.push(Wi(t[n]));return e}},is.layout.chord=function(){function t(){var t,l,h,f,p,d={},g=[],y=is.range(o),m=[];for(n=[],i=[],t=0,f=-1;++f<o;){for(l=0,p=-1;++p<o;)l+=r[f][p];g.push(l),m.push(is.range(o)),t+=l}for(s&&y.sort(function(t,e){return s(g[t],g[e])}),a&&m.forEach(function(t,e){t.sort(function(t,n){return a(r[e][t],r[e][n])})}),t=(Rs-c*o)/t,l=0,f=-1;++f<o;){for(h=l,p=-1;++p<o;){var v=y[f],_=m[v][p],w=r[v][_],b=l,x=l+=w*t;d[v+"-"+_]={index:v,subindex:_,startAngle:b,endAngle:x,value:w}}i[v]={index:v,startAngle:h,endAngle:l,value:(l-h)/t},l+=c}for(f=-1;++f<o;)for(p=f-1;++p<o;){var S=d[f+"-"+p],M=d[p+"-"+f];(S.value||M.value)&&n.push(S.value<M.value?{source:M,target:S}:{source:S,target:M})}u&&e()}function e(){n.sort(function(t,e){return u((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var n,i,r,o,s,a,u,l={},c=0;return l.matrix=function(t){return arguments.length?(o=(r=t)&&r.length,n=i=null,l):r},l.padding=function(t){return arguments.length?(c=t,n=i=null,l):c},l.sortGroups=function(t){return arguments.length?(s=t,n=i=null,l):s},l.sortSubgroups=function(t){return arguments.length?(a=t,n=null,l):a},l.sortChords=function(t){return arguments.length?(u=t,n&&e(),l):u},l.chords=function(){return n||t(),n},l.groups=function(){return i||t(),i},l},is.layout.force=function(){function t(t){return function(e,n,i,r){if(e.point!==t){var o=e.cx-t.x,s=e.cy-t.y,a=r-n,u=o*o+s*s;if(u>a*a/y){if(d>u){var l=e.charge/u;t.px-=o*l,t.py-=s*l}return!0}if(e.point&&u&&d>u){var l=e.pointCharge/u;t.px-=o*l,t.py-=s*l}}return!e.charge}}function e(t){t.px=is.event.x,t.py=is.event.y,a.resume()}var n,i,r,o,s,a={},u=is.dispatch("start","tick","end"),l=[1,1],c=.9,h=pu,f=du,p=-30,d=gu,g=.1,y=.64,m=[],v=[];return a.tick=function(){if((i*=.99)<.005)return u.end({type:"end",alpha:i=0}),!0;var e,n,a,h,f,d,y,_,w,b=m.length,x=v.length;for(n=0;x>n;++n)a=v[n],h=a.source,f=a.target,_=f.x-h.x,w=f.y-h.y,(d=_*_+w*w)&&(d=i*o[n]*((d=Math.sqrt(d))-r[n])/d,_*=d,w*=d,f.x-=_*(y=h.weight/(f.weight+h.weight)),f.y-=w*y,h.x+=_*(y=1-y),h.y+=w*y);if((y=i*g)&&(_=l[0]/2,w=l[1]/2,n=-1,y))for(;++n<b;)a=m[n],a.x+=(_-a.x)*y,a.y+=(w-a.y)*y;if(p)for(Ji(e=is.geom.quadtree(m),i,s),n=-1;++n<b;)(a=m[n]).fixed||e.visit(t(a));for(n=-1;++n<b;)a=m[n],a.fixed?(a.x=a.px,a.y=a.py):(a.x-=(a.px-(a.px=a.x))*c,a.y-=(a.py-(a.py=a.y))*c);u.tick({type:"tick",alpha:i})},a.nodes=function(t){return arguments.length?(m=t,a):m},a.links=function(t){return arguments.length?(v=t,a):v},a.size=function(t){return arguments.length?(l=t,a):l},a.linkDistance=function(t){return arguments.length?(h="function"==typeof t?t:+t,a):h},a.distance=a.linkDistance,a.linkStrength=function(t){return arguments.length?(f="function"==typeof t?t:+t,a):f},a.friction=function(t){return arguments.length?(c=+t,a):c},a.charge=function(t){return arguments.length?(p="function"==typeof t?t:+t,a):p},a.chargeDistance=function(t){return arguments.length?(d=t*t,a):Math.sqrt(d)},a.gravity=function(t){return arguments.length?(g=+t,a):g},a.theta=function(t){return arguments.length?(y=t*t,a):Math.sqrt(y)},a.alpha=function(t){return arguments.length?(t=+t,i?i=t>0?t:0:t>0&&(u.start({type:"start",alpha:i=t}),is.timer(a.tick)),a):i},a.start=function(){function t(t,i){if(!n){for(n=new Array(u),a=0;u>a;++a)n[a]=[];for(a=0;c>a;++a){var r=v[a];n[r.source.index].push(r.target),n[r.target.index].push(r.source)}}for(var o,s=n[e],a=-1,l=s.length;++a<l;)if(!isNaN(o=s[a][t]))return o;return Math.random()*i}var e,n,i,u=m.length,c=v.length,d=l[0],g=l[1];for(e=0;u>e;++e)(i=m[e]).index=e,i.weight=0;for(e=0;c>e;++e)i=v[e],"number"==typeof i.source&&(i.source=m[i.source]),"number"==typeof i.target&&(i.target=m[i.target]),++i.source.weight,++i.target.weight;for(e=0;u>e;++e)i=m[e],isNaN(i.x)&&(i.x=t("x",d)),isNaN(i.y)&&(i.y=t("y",g)),isNaN(i.px)&&(i.px=i.x),isNaN(i.py)&&(i.py=i.y);if(r=[],"function"==typeof h)for(e=0;c>e;++e)r[e]=+h.call(this,v[e],e);else for(e=0;c>e;++e)r[e]=h;if(o=[],"function"==typeof f)for(e=0;c>e;++e)o[e]=+f.call(this,v[e],e);else for(e=0;c>e;++e)o[e]=f;if(s=[],"function"==typeof p)for(e=0;u>e;++e)s[e]=+p.call(this,m[e],e);else for(e=0;u>e;++e)s[e]=p;return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){return n||(n=is.behavior.drag().origin(_).on("dragstart.force",Hi).on("drag.force",e).on("dragend.force",$i)),arguments.length?void this.on("mouseover.force",Zi).on("mouseout.force",Xi).call(n):n},is.rebind(a,u,"on")};var pu=20,du=1,gu=1/0;is.layout.hierarchy=function(){function t(r){var o,s=[r],a=[];for(r.depth=0;null!=(o=s.pop());)if(a.push(o),(l=n.call(t,o,o.depth))&&(u=l.length)){for(var u,l,c;--u>=0;)s.push(c=l[u]),c.parent=o,c.depth=o.depth+1;i&&(o.value=0),o.children=l}else i&&(o.value=+i.call(t,o,o.depth)||0),delete o.children;return er(r,function(t){var n,r;e&&(n=t.children)&&n.sort(e),i&&(r=t.parent)&&(r.value+=t.value)}),a}var e=rr,n=nr,i=ir;return t.sort=function(n){return arguments.length?(e=n,t):e},t.children=function(e){return arguments.length?(n=e,t):n},t.value=function(e){return arguments.length?(i=e,t):i},t.revalue=function(e){return i&&(tr(e,function(t){t.children&&(t.value=0)}),er(e,function(e){var n;e.children||(e.value=+i.call(t,e,e.depth)||0),(n=e.parent)&&(n.value+=e.value)})),e},t},is.layout.partition=function(){function t(e,n,i,r){var o=e.children;if(e.x=n,e.y=e.depth*r,e.dx=i,e.dy=r,o&&(s=o.length)){var s,a,u,l=-1;for(i=e.value?i/e.value:0;++l<s;)t(a=o[l],n,u=a.value*i,r),n+=u}}function e(t){var n=t.children,i=0;if(n&&(r=n.length))for(var r,o=-1;++o<r;)i=Math.max(i,e(n[o]));return 1+i}function n(n,o){var s=i.call(this,n,o);return t(s[0],0,r[0],r[1]/e(s[0])),s}var i=is.layout.hierarchy(),r=[1,1];return n.size=function(t){return arguments.length?(r=t,n):r},Ki(n,i)},is.layout.pie=function(){function t(s){var a,u=s.length,l=s.map(function(n,i){return+e.call(t,n,i)}),c=+("function"==typeof i?i.apply(this,arguments):i),h=("function"==typeof r?r.apply(this,arguments):r)-c,f=Math.min(Math.abs(h)/u,+("function"==typeof o?o.apply(this,arguments):o)),p=f*(0>h?-1:1),d=(h-u*p)/is.sum(l),g=is.range(u),y=[];return null!=n&&g.sort(n===yu?function(t,e){return l[e]-l[t]}:function(t,e){return n(s[t],s[e])}),g.forEach(function(t){y[t]={data:s[t],value:a=l[t],startAngle:c,endAngle:c+=a*d+p,padAngle:f}}),y}var e=Number,n=yu,i=0,r=Rs,o=0;return t.value=function(n){return arguments.length?(e=n,t):e},t.sort=function(e){return arguments.length?(n=e,t):n},t.startAngle=function(e){return arguments.length?(i=e,t):i},t.endAngle=function(e){return arguments.length?(r=e,t):r},t.padAngle=function(e){return arguments.length?(o=e,t):o},t};var yu={};is.layout.stack=function(){function t(a,u){if(!(f=a.length))return a;var l=a.map(function(n,i){return e.call(t,n,i)}),c=l.map(function(e){return e.map(function(e,n){return[o.call(t,e,n),s.call(t,e,n)]})}),h=n.call(t,c,u);l=is.permute(l,h),c=is.permute(c,h);var f,p,d,g,y=i.call(t,c,u),m=l[0].length;for(d=0;m>d;++d)for(r.call(t,l[0][d],g=y[d],c[0][d][1]),p=1;f>p;++p)r.call(t,l[p][d],g+=c[p-1][d][1],c[p][d][1]);return a}var e=_,n=lr,i=cr,r=ur,o=sr,s=ar;return t.values=function(n){return arguments.length?(e=n,t):e},t.order=function(e){return arguments.length?(n="function"==typeof e?e:mu.get(e)||lr,t):n},t.offset=function(e){return arguments.length?(i="function"==typeof e?e:vu.get(e)||cr,t):i},t.x=function(e){return arguments.length?(o=e,t):o},t.y=function(e){return arguments.length?(s=e,t):s},t.out=function(e){return arguments.length?(r=e,t):r},t};var mu=is.map({"inside-out":function(t){var e,n,i=t.length,r=t.map(hr),o=t.map(fr),s=is.range(i).sort(function(t,e){return r[t]-r[e]}),a=0,u=0,l=[],c=[];for(e=0;i>e;++e)n=s[e],u>a?(a+=o[n],l.push(n)):(u+=o[n],c.push(n));return c.reverse().concat(l)},reverse:function(t){return is.range(t.length).reverse()},"default":lr}),vu=is.map({silhouette:function(t){var e,n,i,r=t.length,o=t[0].length,s=[],a=0,u=[];for(n=0;o>n;++n){for(e=0,i=0;r>e;e++)i+=t[e][n][1];i>a&&(a=i),s.push(i)}for(n=0;o>n;++n)u[n]=(a-s[n])/2;return u},wiggle:function(t){var e,n,i,r,o,s,a,u,l,c=t.length,h=t[0],f=h.length,p=[];for(p[0]=u=l=0,n=1;f>n;++n){for(e=0,r=0;c>e;++e)r+=t[e][n][1];for(e=0,o=0,a=h[n][0]-h[n-1][0];c>e;++e){for(i=0,s=(t[e][n][1]-t[e][n-1][1])/(2*a);e>i;++i)s+=(t[i][n][1]-t[i][n-1][1])/a;o+=s*t[e][n][1]}p[n]=u-=r?o/r*a:0,l>u&&(l=u)}for(n=0;f>n;++n)p[n]-=l;return p},expand:function(t){var e,n,i,r=t.length,o=t[0].length,s=1/r,a=[];for(n=0;o>n;++n){for(e=0,i=0;r>e;e++)i+=t[e][n][1];if(i)for(e=0;r>e;e++)t[e][n][1]/=i;else for(e=0;r>e;e++)t[e][n][1]=s}for(n=0;o>n;++n)a[n]=0;return a},zero:cr});is.layout.histogram=function(){function t(t,o){for(var s,a,u=[],l=t.map(n,this),c=i.call(this,l,o),h=r.call(this,c,l,o),o=-1,f=l.length,p=h.length-1,d=e?1:1/f;++o<p;)s=u[o]=[],s.dx=h[o+1]-(s.x=h[o]),s.y=0;if(p>0)for(o=-1;++o<f;)a=l[o],a>=c[0]&&a<=c[1]&&(s=u[is.bisect(h,a,1,p)-1],s.y+=d,s.push(t[o]));return u}var e=!0,n=Number,i=yr,r=dr;return t.value=function(e){return arguments.length?(n=e,t):n},t.range=function(e){return arguments.length?(i=Et(e),t):i},t.bins=function(e){return arguments.length?(r="number"==typeof e?function(t){return gr(t,e)}:Et(e),t):r},t.frequency=function(n){return arguments.length?(e=!!n,t):e},t},is.layout.pack=function(){function t(t,o){var s=n.call(this,t,o),a=s[0],u=r[0],l=r[1],c=null==e?Math.sqrt:"function"==typeof e?e:function(){return e};if(a.x=a.y=0,er(a,function(t){t.r=+c(t.value)}),er(a,br),i){var h=i*(e?1:Math.max(2*a.r/u,2*a.r/l))/2;er(a,function(t){t.r+=h}),er(a,br),er(a,function(t){t.r-=h})}return Mr(a,u/2,l/2,e?1:1/Math.max(2*a.r/u,2*a.r/l)),s}var e,n=is.layout.hierarchy().sort(mr),i=0,r=[1,1];return t.size=function(e){return arguments.length?(r=e,t):r},t.radius=function(n){return arguments.length?(e=null==n||"function"==typeof n?n:+n,t):e},t.padding=function(e){return arguments.length?(i=+e,t):i},Ki(t,n)},is.layout.tree=function(){function t(t,r){var c=s.call(this,t,r),h=c[0],f=e(h);if(er(f,n),f.parent.m=-f.z,tr(f,i),l)tr(h,o);else{var p=h,d=h,g=h;tr(h,function(t){t.x<p.x&&(p=t),t.x>d.x&&(d=t),t.depth>g.depth&&(g=t)});var y=a(p,d)/2-p.x,m=u[0]/(d.x+a(d,p)/2+y),v=u[1]/(g.depth||1);tr(h,function(t){t.x=(t.x+y)*m,t.y=t.depth*v})}return c}function e(t){for(var e,n={A:null,children:[t]},i=[n];null!=(e=i.pop());)for(var r,o=e.children,s=0,a=o.length;a>s;++s)i.push((o[s]=r={_:o[s],parent:e,children:(r=o[s].children)&&r.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:s}).a=r);return n.children[0]}function n(t){var e=t.children,n=t.parent.children,i=t.i?n[t.i-1]:null;if(e.length){qr(t);var o=(e[0].z+e[e.length-1].z)/2;i?(t.z=i.z+a(t._,i._),t.m=t.z-o):t.z=o}else i&&(t.z=i.z+a(t._,i._));t.parent.A=r(t,i,t.parent.A||n[0])}function i(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function r(t,e,n){if(e){for(var i,r=t,o=t,s=e,u=r.parent.children[0],l=r.m,c=o.m,h=s.m,f=u.m;s=kr(s),r=Er(r),s&&r;)u=Er(u),o=kr(o),o.a=t,i=s.z+h-r.z-l+a(s._,r._),i>0&&(jr(Pr(s,t,n),t,i),l+=i,c+=i),h+=s.m,l+=r.m,f+=u.m,c+=o.m;s&&!kr(o)&&(o.t=s,o.m+=h-c),r&&!Er(u)&&(u.t=r,u.m+=l-f,n=t)}return n}function o(t){t.x*=u[0],t.y=t.depth*u[1]}var s=is.layout.hierarchy().sort(null).value(null),a=Ar,u=[1,1],l=null;return t.separation=function(e){return arguments.length?(a=e,t):a},t.size=function(e){return arguments.length?(l=null==(u=e)?o:null,t):l?null:u},t.nodeSize=function(e){return arguments.length?(l=null==(u=e)?null:o,t):l?u:null},Ki(t,s)},is.layout.cluster=function(){function t(t,o){var s,a=e.call(this,t,o),u=a[0],l=0;er(u,function(t){var e=t.children;e&&e.length?(t.x=Fr(e),t.y=Or(e)):(t.x=s?l+=n(t,s):0,t.y=0,s=t)});var c=Rr(u),h=Nr(u),f=c.x-n(c,h)/2,p=h.x+n(h,c)/2;return er(u,r?function(t){t.x=(t.x-u.x)*i[0],t.y=(u.y-t.y)*i[1]}:function(t){t.x=(t.x-f)/(p-f)*i[0],t.y=(1-(u.y?t.y/u.y:1))*i[1]}),a}var e=is.layout.hierarchy().sort(null).value(null),n=Ar,i=[1,1],r=!1;return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(e){return arguments.length?(r=null==(i=e),t):r?null:i},t.nodeSize=function(e){return arguments.length?(r=null!=(i=e),t):r?i:null},Ki(t,e)},is.layout.treemap=function(){function t(t,e){for(var n,i,r=-1,o=t.length;++r<o;)i=(n=t[r]).value*(0>e?0:e),n.area=isNaN(i)||0>=i?0:i}function e(n){var o=n.children;if(o&&o.length){var s,a,u,l=h(n),c=[],f=o.slice(),d=1/0,g="slice"===p?l.dx:"dice"===p?l.dy:"slice-dice"===p?1&n.depth?l.dy:l.dx:Math.min(l.dx,l.dy);for(t(f,l.dx*l.dy/n.value),c.area=0;(u=f.length)>0;)c.push(s=f[u-1]),c.area+=s.area,"squarify"!==p||(a=i(c,g))<=d?(f.pop(),d=a):(c.area-=c.pop().area,r(c,g,l,!1),g=Math.min(l.dx,l.dy),c.length=c.area=0,d=1/0);c.length&&(r(c,g,l,!0),c.length=c.area=0),o.forEach(e)}}function n(e){var i=e.children;if(i&&i.length){var o,s=h(e),a=i.slice(),u=[];for(t(a,s.dx*s.dy/e.value),u.area=0;o=a.pop();)u.push(o),u.area+=o.area,null!=o.z&&(r(u,o.z?s.dx:s.dy,s,!a.length),u.length=u.area=0);i.forEach(n)}}function i(t,e){for(var n,i=t.area,r=0,o=1/0,s=-1,a=t.length;++s<a;)(n=t[s].area)&&(o>n&&(o=n),n>r&&(r=n));return i*=i,e*=e,i?Math.max(e*r*d/i,i/(e*o*d)):1/0}function r(t,e,n,i){var r,o=-1,s=t.length,a=n.x,l=n.y,c=e?u(t.area/e):0;if(e==n.dx){for((i||c>n.dy)&&(c=n.dy);++o<s;)r=t[o],r.x=a,r.y=l,r.dy=c,a+=r.dx=Math.min(n.x+n.dx-a,c?u(r.area/c):0);r.z=!0,r.dx+=n.x+n.dx-a,n.y+=c,n.dy-=c}else{for((i||c>n.dx)&&(c=n.dx);++o<s;)r=t[o],r.x=a,r.y=l,r.dx=c,l+=r.dy=Math.min(n.y+n.dy-l,c?u(r.area/c):0);r.z=!1,r.dy+=n.y+n.dy-l,n.x+=c,n.dx-=c}}function o(i){var r=s||a(i),o=r[0];return o.x=0,o.y=0,o.dx=l[0],o.dy=l[1],s&&a.revalue(o),t([o],o.dx*o.dy/o.value),(s?n:e)(o),f&&(s=r),r}var s,a=is.layout.hierarchy(),u=Math.round,l=[1,1],c=null,h=Cr,f=!1,p="squarify",d=.5*(1+Math.sqrt(5));return o.size=function(t){return arguments.length?(l=t,o):l},o.padding=function(t){function e(e){var n=t.call(o,e,e.depth);return null==n?Cr(e):Lr(e,"number"==typeof n?[n,n,n,n]:n)}function n(e){return Lr(e,t)}if(!arguments.length)return c;var i;return h=null==(c=t)?Cr:"function"==(i=typeof t)?e:"number"===i?(t=[t,t,t,t],n):n,o},o.round=function(t){return arguments.length?(u=t?Math.round:Number,o):u!=Number},o.sticky=function(t){return arguments.length?(f=t,s=null,o):f},o.ratio=function(t){return arguments.length?(d=t,o):d},o.mode=function(t){return arguments.length?(p=t+"",o):p},Ki(o,a)},is.random={normal:function(t,e){var n=arguments.length;return 2>n&&(e=1),1>n&&(t=0),function(){var n,i,r;do n=2*Math.random()-1,i=2*Math.random()-1,r=n*n+i*i;while(!r||r>1);return t+e*n*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var t=is.random.normal.apply(is,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=is.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,n=0;t>n;n++)e+=Math.random();return e}}},is.scale={};var _u={floor:_,ceil:_};is.scale.linear=function(){return Vr([0,1],[0,1],_i,!1)};var wu={s:1,g:1,p:1,r:1,e:1};is.scale.log=function(){return Jr(is.scale.linear().domain([0,1]),10,!0,[1,10])};var bu=is.format(".0e"),xu={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};is.scale.pow=function(){return Kr(is.scale.linear(),1,[0,1])},is.scale.sqrt=function(){return is.scale.pow().exponent(.5)},is.scale.ordinal=function(){return eo([],{t:"range",a:[[]]})},is.scale.category10=function(){return is.scale.ordinal().range(Su)},is.scale.category20=function(){return is.scale.ordinal().range(Mu)},is.scale.category20b=function(){return is.scale.ordinal().range(Tu)},is.scale.category20c=function(){return is.scale.ordinal().range(Au)};var Su=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(wt),Mu=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(wt),Tu=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(wt),Au=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(wt);is.scale.quantile=function(){return no([],[])},is.scale.quantize=function(){return io(0,1,[0,1])},is.scale.threshold=function(){return ro([.5],[0,1])},is.scale.identity=function(){return oo([0,1])},is.svg={},is.svg.arc=function(){function t(){var t=Math.max(0,+n.apply(this,arguments)),l=Math.max(0,+i.apply(this,arguments)),c=s.apply(this,arguments)-Cs,h=a.apply(this,arguments)-Cs,f=Math.abs(h-c),p=c>h?0:1;if(t>l&&(d=l,l=t,t=d),f>=Ns)return e(l,p)+(t?e(t,1-p):"")+"Z";var d,g,y,m,v,_,w,b,x,S,M,T,A=0,E=0,k=[];if((m=(+u.apply(this,arguments)||0)/2)&&(y=o===Eu?Math.sqrt(t*t+l*l):+o.apply(this,arguments),p||(E*=-1),l&&(E=nt(y/l*Math.sin(m))),t&&(A=nt(y/t*Math.sin(m)))),l){v=l*Math.cos(c+E),_=l*Math.sin(c+E),w=l*Math.cos(h-E),b=l*Math.sin(h-E);var j=Math.abs(h-c-2*E)<=Fs?0:1;if(E&&fo(v,_,w,b)===p^j){var q=(c+h)/2;v=l*Math.cos(q),_=l*Math.sin(q),w=b=null}}else v=_=0;if(t){x=t*Math.cos(h-A),S=t*Math.sin(h-A),M=t*Math.cos(c+A),T=t*Math.sin(c+A);var P=Math.abs(c-h+2*A)<=Fs?0:1;if(A&&fo(x,S,M,T)===1-p^P){var O=(c+h)/2;x=t*Math.cos(O),S=t*Math.sin(O),M=T=null}}else x=S=0;if((d=Math.min(Math.abs(l-t)/2,+r.apply(this,arguments)))>.001){g=l>t^p?0:1;var F=null==M?[x,S]:null==w?[v,_]:Rn([v,_],[M,T],[w,b],[x,S]),R=v-F[0],N=_-F[1],C=w-F[0],L=b-F[1],D=1/Math.sin(Math.acos((R*C+N*L)/(Math.sqrt(R*R+N*N)*Math.sqrt(C*C+L*L)))/2),B=Math.sqrt(F[0]*F[0]+F[1]*F[1]);if(null!=w){var z=Math.min(d,(l-B)/(D+1)),I=po(null==M?[x,S]:[M,T],[v,_],l,z,p),U=po([w,b],[x,S],l,z,p);d===z?k.push("M",I[0],"A",z,",",z," 0 0,",g," ",I[1],"A",l,",",l," 0 ",1-p^fo(I[1][0],I[1][1],U[1][0],U[1][1]),",",p," ",U[1],"A",z,",",z," 0 0,",g," ",U[0]):k.push("M",I[0],"A",z,",",z," 0 1,",g," ",U[0])}else k.push("M",v,",",_);if(null!=M){var G=Math.min(d,(t-B)/(D-1)),V=po([v,_],[M,T],t,-G,p),W=po([x,S],null==w?[v,_]:[w,b],t,-G,p);d===G?k.push("L",W[0],"A",G,",",G," 0 0,",g," ",W[1],"A",t,",",t," 0 ",p^fo(W[1][0],W[1][1],V[1][0],V[1][1]),",",1-p," ",V[1],"A",G,",",G," 0 0,",g," ",V[0]):k.push("L",W[0],"A",G,",",G," 0 0,",g," ",V[0])}else k.push("L",x,",",S)}else k.push("M",v,",",_),null!=w&&k.push("A",l,",",l," 0 ",j,",",p," ",w,",",b),k.push("L",x,",",S),null!=M&&k.push("A",t,",",t," 0 ",P,",",1-p," ",M,",",T);return k.push("Z"),k.join("")}function e(t,e){return"M0,"+t+"A"+t+","+t+" 0 1,"+e+" 0,"+-t+"A"+t+","+t+" 0 1,"+e+" 0,"+t}var n=ao,i=uo,r=so,o=Eu,s=lo,a=co,u=ho;return t.innerRadius=function(e){return arguments.length?(n=Et(e),t):n},t.outerRadius=function(e){return arguments.length?(i=Et(e),t):i},t.cornerRadius=function(e){return arguments.length?(r=Et(e),t):r},t.padRadius=function(e){return arguments.length?(o=e==Eu?Eu:Et(e),t):o},t.startAngle=function(e){return arguments.length?(s=Et(e),t):s},t.endAngle=function(e){return arguments.length?(a=Et(e),t):a},t.padAngle=function(e){return arguments.length?(u=Et(e),t):u},t.centroid=function(){var t=(+n.apply(this,arguments)+ +i.apply(this,arguments))/2,e=(+s.apply(this,arguments)+ +a.apply(this,arguments))/2-Cs;return[Math.cos(e)*t,Math.sin(e)*t]},t};var Eu="auto";is.svg.line=function(){return go(_)};var ku=is.map({linear:yo,"linear-closed":mo,step:vo,"step-before":_o,"step-after":wo,basis:Ao,"basis-open":Eo,"basis-closed":ko,bundle:jo,cardinal:So,"cardinal-open":bo,"cardinal-closed":xo,monotone:No});ku.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var ju=[0,2/3,1/3,0],qu=[0,1/3,2/3,0],Pu=[0,1/6,2/3,1/6];is.svg.line.radial=function(){var t=go(Co);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},_o.reverse=wo,wo.reverse=_o,is.svg.area=function(){return Lo(_)},is.svg.area.radial=function(){
var t=Lo(Co);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},is.svg.chord=function(){function t(t,a){var u=e(this,o,t,a),l=e(this,s,t,a);return"M"+u.p0+i(u.r,u.p1,u.a1-u.a0)+(n(u,l)?r(u.r,u.p1,u.r,u.p0):r(u.r,u.p1,l.r,l.p0)+i(l.r,l.p1,l.a1-l.a0)+r(l.r,l.p1,u.r,u.p0))+"Z"}function e(t,e,n,i){var r=e.call(t,n,i),o=a.call(t,r,i),s=u.call(t,r,i)-Cs,c=l.call(t,r,i)-Cs;return{r:o,a0:s,a1:c,p0:[o*Math.cos(s),o*Math.sin(s)],p1:[o*Math.cos(c),o*Math.sin(c)]}}function n(t,e){return t.a0==e.a0&&t.a1==e.a1}function i(t,e,n){return"A"+t+","+t+" 0 "+ +(n>Fs)+",1 "+e}function r(t,e,n,i){return"Q 0,0 "+i}var o=_n,s=wn,a=Do,u=lo,l=co;return t.radius=function(e){return arguments.length?(a=Et(e),t):a},t.source=function(e){return arguments.length?(o=Et(e),t):o},t.target=function(e){return arguments.length?(s=Et(e),t):s},t.startAngle=function(e){return arguments.length?(u=Et(e),t):u},t.endAngle=function(e){return arguments.length?(l=Et(e),t):l},t},is.svg.diagonal=function(){function t(t,r){var o=e.call(this,t,r),s=n.call(this,t,r),a=(o.y+s.y)/2,u=[o,{x:o.x,y:a},{x:s.x,y:a},s];return u=u.map(i),"M"+u[0]+"C"+u[1]+" "+u[2]+" "+u[3]}var e=_n,n=wn,i=Bo;return t.source=function(n){return arguments.length?(e=Et(n),t):e},t.target=function(e){return arguments.length?(n=Et(e),t):n},t.projection=function(e){return arguments.length?(i=e,t):i},t},is.svg.diagonal.radial=function(){var t=is.svg.diagonal(),e=Bo,n=t.projection;return t.projection=function(t){return arguments.length?n(zo(e=t)):e},t},is.svg.symbol=function(){function t(t,i){return(Ou.get(e.call(this,t,i))||Go)(n.call(this,t,i))}var e=Uo,n=Io;return t.type=function(n){return arguments.length?(e=Et(n),t):e},t.size=function(e){return arguments.length?(n=Et(e),t):n},t};var Ou=is.map({circle:Go,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*Ru)),n=e*Ru;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/Fu),n=e*Fu/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/Fu),n=e*Fu/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});is.svg.symbolTypes=Ou.keys();var Fu=Math.sqrt(3),Ru=Math.tan(30*Ls);Ms.transition=function(t){for(var e,n,i=Nu||++Bu,r=Ho(t),o=[],s=Cu||{time:Date.now(),ease:Ai,delay:0,duration:250},a=-1,u=this.length;++a<u;){o.push(e=[]);for(var l=this[a],c=-1,h=l.length;++c<h;)(n=l[c])&&$o(n,c,r,i,s),e.push(n)}return Wo(o,r,i)},Ms.interrupt=function(t){return this.each(null==t?Lu:Vo(Ho(t)))};var Nu,Cu,Lu=Vo(Ho()),Du=[],Bu=0;Du.call=Ms.call,Du.empty=Ms.empty,Du.node=Ms.node,Du.size=Ms.size,is.transition=function(t,e){return t&&t.transition?Nu?t.transition(e):t:is.selection().transition(t)},is.transition.prototype=Du,Du.select=function(t){var e,n,i,r=this.id,o=this.namespace,s=[];t=j(t);for(var a=-1,u=this.length;++a<u;){s.push(e=[]);for(var l=this[a],c=-1,h=l.length;++c<h;)(i=l[c])&&(n=t.call(i,i.__data__,c,a))?("__data__"in i&&(n.__data__=i.__data__),$o(n,c,o,r,i[o][r]),e.push(n)):e.push(null)}return Wo(s,o,r)},Du.selectAll=function(t){var e,n,i,r,o,s=this.id,a=this.namespace,u=[];t=q(t);for(var l=-1,c=this.length;++l<c;)for(var h=this[l],f=-1,p=h.length;++f<p;)if(i=h[f]){o=i[a][s],n=t.call(i,i.__data__,f,l),u.push(e=[]);for(var d=-1,g=n.length;++d<g;)(r=n[d])&&$o(r,d,a,s,o),e.push(r)}return Wo(u,a,s)},Du.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=U(t));for(var o=0,s=this.length;s>o;o++){r.push(e=[]);for(var n=this[o],a=0,u=n.length;u>a;a++)(i=n[a])&&t.call(i,i.__data__,a,o)&&e.push(i)}return Wo(r,this.namespace,this.id)},Du.tween=function(t,e){var n=this.id,i=this.namespace;return arguments.length<2?this.node()[i][n].tween.get(t):V(this,null==e?function(e){e[i][n].tween.remove(t)}:function(r){r[i][n].tween.set(t,e)})},Du.attr=function(t,e){function n(){this.removeAttribute(a)}function i(){this.removeAttributeNS(a.space,a.local)}function r(t){return null==t?n:(t+="",function(){var e,n=this.getAttribute(a);return n!==t&&(e=s(n,t),function(t){this.setAttribute(a,e(t))})})}function o(t){return null==t?i:(t+="",function(){var e,n=this.getAttributeNS(a.space,a.local);return n!==t&&(e=s(n,t),function(t){this.setAttributeNS(a.space,a.local,e(t))})})}if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var s="transform"==t?Ui:_i,a=is.ns.qualify(t);return Yo(this,"attr."+t,e,a.local?o:r)},Du.attrTween=function(t,e){function n(t,n){var i=e.call(this,t,n,this.getAttribute(r));return i&&function(t){this.setAttribute(r,i(t))}}function i(t,n){var i=e.call(this,t,n,this.getAttributeNS(r.space,r.local));return i&&function(t){this.setAttributeNS(r.space,r.local,i(t))}}var r=is.ns.qualify(t);return this.tween("attr."+t,r.local?i:n)},Du.style=function(t,e,i){function r(){this.style.removeProperty(t)}function o(e){return null==e?r:(e+="",function(){var r,o=n(this).getComputedStyle(this,null).getPropertyValue(t);return o!==e&&(r=_i(o,e),function(e){this.style.setProperty(t,r(e),i)})})}var s=arguments.length;if(3>s){if("string"!=typeof t){2>s&&(e="");for(i in t)this.style(i,t[i],e);return this}i=""}return Yo(this,"style."+t,e,o)},Du.styleTween=function(t,e,i){function r(r,o){var s=e.call(this,r,o,n(this).getComputedStyle(this,null).getPropertyValue(t));return s&&function(e){this.style.setProperty(t,s(e),i)}}return arguments.length<3&&(i=""),this.tween("style."+t,r)},Du.text=function(t){return Yo(this,"text",t,Qo)},Du.remove=function(){var t=this.namespace;return this.each("end.transition",function(){var e;this[t].count<2&&(e=this.parentNode)&&e.removeChild(this)})},Du.ease=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].ease:("function"!=typeof t&&(t=is.ease.apply(is,arguments)),V(this,function(i){i[n][e].ease=t}))},Du.delay=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].delay:V(this,"function"==typeof t?function(i,r,o){i[n][e].delay=+t.call(i,i.__data__,r,o)}:(t=+t,function(i){i[n][e].delay=t}))},Du.duration=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].duration:V(this,"function"==typeof t?function(i,r,o){i[n][e].duration=Math.max(1,t.call(i,i.__data__,r,o))}:(t=Math.max(1,t),function(i){i[n][e].duration=t}))},Du.each=function(t,e){var n=this.id,i=this.namespace;if(arguments.length<2){var r=Cu,o=Nu;try{Nu=n,V(this,function(e,r,o){Cu=e[i][n],t.call(e,e.__data__,r,o)})}finally{Cu=r,Nu=o}}else V(this,function(r){var o=r[i][n];(o.event||(o.event=is.dispatch("start","end","interrupt"))).on(t,e)});return this},Du.transition=function(){for(var t,e,n,i,r=this.id,o=++Bu,s=this.namespace,a=[],u=0,l=this.length;l>u;u++){a.push(t=[]);for(var e=this[u],c=0,h=e.length;h>c;c++)(n=e[c])&&(i=n[s][r],$o(n,c,s,o,{time:i.time,ease:i.ease,delay:i.delay+i.duration,duration:i.duration})),t.push(n)}return Wo(a,s,o)},is.svg.axis=function(){function t(t){t.each(function(){var t,l=is.select(this),c=this.__chart__||n,h=this.__chart__=n.copy(),f=null==u?h.ticks?h.ticks.apply(h,a):h.domain():u,p=null==e?h.tickFormat?h.tickFormat.apply(h,a):_:e,d=l.selectAll(".tick").data(f,h),g=d.enter().insert("g",".domain").attr("class","tick").style("opacity",Ps),y=is.transition(d.exit()).style("opacity",Ps).remove(),m=is.transition(d.order()).style("opacity",1),v=Math.max(r,0)+s,w=Br(h),b=l.selectAll(".domain").data([0]),x=(b.enter().append("path").attr("class","domain"),is.transition(b));g.append("line"),g.append("text");var S,M,T,A,E=g.select("line"),k=m.select("line"),j=d.select("text").text(p),q=g.select("text"),P=m.select("text"),O="top"===i||"left"===i?-1:1;if("bottom"===i||"top"===i?(t=Zo,S="x",T="y",M="x2",A="y2",j.attr("dy",0>O?"0em":".71em").style("text-anchor","middle"),x.attr("d","M"+w[0]+","+O*o+"V0H"+w[1]+"V"+O*o)):(t=Xo,S="y",T="x",M="y2",A="x2",j.attr("dy",".32em").style("text-anchor",0>O?"end":"start"),x.attr("d","M"+O*o+","+w[0]+"H0V"+w[1]+"H"+O*o)),E.attr(A,O*r),q.attr(T,O*v),k.attr(M,0).attr(A,O*r),P.attr(S,0).attr(T,O*v),h.rangeBand){var F=h,R=F.rangeBand()/2;c=h=function(t){return F(t)+R}}else c.rangeBand?c=h:y.call(t,h,c);g.call(t,c,h),m.call(t,h,h)})}var e,n=is.scale.linear(),i=zu,r=6,o=6,s=3,a=[10],u=null;return t.scale=function(e){return arguments.length?(n=e,t):n},t.orient=function(e){return arguments.length?(i=e in Iu?e+"":zu,t):i},t.ticks=function(){return arguments.length?(a=arguments,t):a},t.tickValues=function(e){return arguments.length?(u=e,t):u},t.tickFormat=function(n){return arguments.length?(e=n,t):e},t.tickSize=function(e){var n=arguments.length;return n?(r=+e,o=+arguments[n-1],t):r},t.innerTickSize=function(e){return arguments.length?(r=+e,t):r},t.outerTickSize=function(e){return arguments.length?(o=+e,t):o},t.tickPadding=function(e){return arguments.length?(s=+e,t):s},t.tickSubdivide=function(){return arguments.length&&t},t};var zu="bottom",Iu={top:1,right:1,bottom:1,left:1};is.svg.brush=function(){function t(n){n.each(function(){var n=is.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",o).on("touchstart.brush",o),s=n.selectAll(".background").data([0]);s.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),n.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var a=n.selectAll(".resize").data(g,_);a.exit().remove(),a.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return Uu[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),a.style("display",t.empty()?"none":null);var u,h=is.transition(n),f=is.transition(s);l&&(u=Br(l),f.attr("x",u[0]).attr("width",u[1]-u[0]),i(h)),c&&(u=Br(c),f.attr("y",u[0]).attr("height",u[1]-u[0]),r(h)),e(h)})}function e(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+h[+/e$/.test(t)]+","+f[+/^s/.test(t)]+")"})}function i(t){t.select(".extent").attr("x",h[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",h[1]-h[0])}function r(t){t.select(".extent").attr("y",f[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",f[1]-f[0])}function o(){function o(){32==is.event.keyCode&&(j||(_=null,P[0]-=h[1],P[1]-=f[1],j=2),T())}function g(){32==is.event.keyCode&&2==j&&(P[0]+=h[1],P[1]+=f[1],j=0,T())}function y(){var t=is.mouse(b),n=!1;w&&(t[0]+=w[0],t[1]+=w[1]),j||(is.event.altKey?(_||(_=[(h[0]+h[1])/2,(f[0]+f[1])/2]),P[0]=h[+(t[0]<_[0])],P[1]=f[+(t[1]<_[1])]):_=null),E&&m(t,l,0)&&(i(M),n=!0),k&&m(t,c,1)&&(r(M),n=!0),n&&(e(M),S({type:"brush",mode:j?"move":"resize"}))}function m(t,e,n){var i,r,o=Br(e),u=o[0],l=o[1],c=P[n],g=n?f:h,y=g[1]-g[0];return j&&(u-=c,l-=y+c),i=(n?d:p)?Math.max(u,Math.min(l,t[n])):t[n],j?r=(i+=c)+y:(_&&(c=Math.max(u,Math.min(l,2*_[n]-i))),i>c?(r=i,i=c):r=c),g[0]!=i||g[1]!=r?(n?a=null:s=null,g[0]=i,g[1]=r,!0):void 0}function v(){y(),M.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),is.select("body").style("cursor",null),O.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),q(),S({type:"brushend"})}var _,w,b=this,x=is.select(is.event.target),S=u.of(b,arguments),M=is.select(b),A=x.datum(),E=!/^(n|s)$/.test(A)&&l,k=!/^(e|w)$/.test(A)&&c,j=x.classed("extent"),q=Z(b),P=is.mouse(b),O=is.select(n(b)).on("keydown.brush",o).on("keyup.brush",g);if(is.event.changedTouches?O.on("touchmove.brush",y).on("touchend.brush",v):O.on("mousemove.brush",y).on("mouseup.brush",v),M.interrupt().selectAll("*").interrupt(),j)P[0]=h[0]-P[0],P[1]=f[0]-P[1];else if(A){var F=+/w$/.test(A),R=+/^n/.test(A);w=[h[1-F]-P[0],f[1-R]-P[1]],P[0]=h[F],P[1]=f[R]}else is.event.altKey&&(_=P.slice());M.style("pointer-events","none").selectAll(".resize").style("display",null),is.select("body").style("cursor",x.style("cursor")),S({type:"brushstart"}),y()}var s,a,u=E(t,"brushstart","brush","brushend"),l=null,c=null,h=[0,0],f=[0,0],p=!0,d=!0,g=Gu[0];return t.event=function(t){t.each(function(){var t=u.of(this,arguments),e={x:h,y:f,i:s,j:a},n=this.__chart__||e;this.__chart__=e,Nu?is.select(this).transition().each("start.brush",function(){s=n.i,a=n.j,h=n.x,f=n.y,t({type:"brushstart"})}).tween("brush:brush",function(){var n=wi(h,e.x),i=wi(f,e.y);return s=a=null,function(r){h=e.x=n(r),f=e.y=i(r),t({type:"brush",mode:"resize"})}}).each("end.brush",function(){s=e.i,a=e.j,t({type:"brush",mode:"resize"}),t({type:"brushend"})}):(t({type:"brushstart"}),t({type:"brush",mode:"resize"}),t({type:"brushend"}))})},t.x=function(e){return arguments.length?(l=e,g=Gu[!l<<1|!c],t):l},t.y=function(e){return arguments.length?(c=e,g=Gu[!l<<1|!c],t):c},t.clamp=function(e){return arguments.length?(l&&c?(p=!!e[0],d=!!e[1]):l?p=!!e:c&&(d=!!e),t):l&&c?[p,d]:l?p:c?d:null},t.extent=function(e){var n,i,r,o,u;return arguments.length?(l&&(n=e[0],i=e[1],c&&(n=n[0],i=i[0]),s=[n,i],l.invert&&(n=l(n),i=l(i)),n>i&&(u=n,n=i,i=u),(n!=h[0]||i!=h[1])&&(h=[n,i])),c&&(r=e[0],o=e[1],l&&(r=r[1],o=o[1]),a=[r,o],c.invert&&(r=c(r),o=c(o)),r>o&&(u=r,r=o,o=u),(r!=f[0]||o!=f[1])&&(f=[r,o])),t):(l&&(s?(n=s[0],i=s[1]):(n=h[0],i=h[1],l.invert&&(n=l.invert(n),i=l.invert(i)),n>i&&(u=n,n=i,i=u))),c&&(a?(r=a[0],o=a[1]):(r=f[0],o=f[1],c.invert&&(r=c.invert(r),o=c.invert(o)),r>o&&(u=r,r=o,o=u))),l&&c?[[n,r],[i,o]]:l?[n,i]:c&&[r,o])},t.clear=function(){return t.empty()||(h=[0,0],f=[0,0],s=a=null),t},t.empty=function(){return!!l&&h[0]==h[1]||!!c&&f[0]==f[1]},is.rebind(t,u,"on")};var Uu={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Gu=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Vu=la.format=ga.timeFormat,Wu=Vu.utc,Yu=Wu("%Y-%m-%dT%H:%M:%S.%LZ");Vu.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Jo:Yu,Jo.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},Jo.toString=Yu.toString,la.second=zt(function(t){return new ca(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),la.seconds=la.second.range,la.seconds.utc=la.second.utc.range,la.minute=zt(function(t){return new ca(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),la.minutes=la.minute.range,la.minutes.utc=la.minute.utc.range,la.hour=zt(function(t){var e=t.getTimezoneOffset()/60;return new ca(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),la.hours=la.hour.range,la.hours.utc=la.hour.utc.range,la.month=zt(function(t){return t=la.day(t),t.setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),la.months=la.month.range,la.months.utc=la.month.utc.range;var Qu=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Hu=[[la.second,1],[la.second,5],[la.second,15],[la.second,30],[la.minute,1],[la.minute,5],[la.minute,15],[la.minute,30],[la.hour,1],[la.hour,3],[la.hour,6],[la.hour,12],[la.day,1],[la.day,2],[la.week,1],[la.month,1],[la.month,3],[la.year,1]],$u=Vu.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",je]]),Zu={range:function(t,e,n){return is.range(Math.ceil(t/n)*n,+e,n).map(ts)},floor:_,ceil:_};Hu.year=la.year,la.scale=function(){return Ko(is.scale.linear(),Hu,$u)};var Xu=Hu.map(function(t){return[t[0].utc,t[1]]}),Ju=Wu.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",je]]);Xu.year=la.year.utc,la.scale.utc=function(){return Ko(is.scale.linear(),Xu,Ju)},is.text=kt(function(t){return t.responseText}),is.json=function(t,e){return jt(t,"application/json",es,e)},is.html=function(t,e){return jt(t,"text/html",ns,e)},is.xml=kt(function(t){return t.responseXML}),"function"==typeof define&&define.amd?define(is):"object"==typeof e&&e.exports&&(e.exports=is),this.d3=is}()},{}],41:[function(t,e,n){(function(i,r){!function(t,i){"use strict";"function"==typeof define&&define.amd?define(i):"object"==typeof n?e.exports=i():t.deepcopy=i()}(this,function(){"use strict";function e(t,n,i,o){var h,f,p,d,g,y,m,v,_,w,b;if(null===t||"object"!=typeof t)return t;if(s.isDate(t))return new Date(+t);if(s.isRegExp(t))return h=String(t),f=h.lastIndexOf("/"),new RegExp(h.slice(1,f),h.slice(f+1));if(a(t))return p=new r(t.length),t.copy(p),p;for(d=u(t).concat(l(t)),g=0,y=d.length;y>g;++g)m=d[g],v=t[m],null!==v&&"object"==typeof v&&(_=c(i,v),-1===_?(w=s.isArray(v)?[]:{},i.push(v),o.push(w)):b=o[_]),n[m]=b||e(v,w,i,o);return n}function n(t){var n=s.isArray(t)?[]:{},i=[t],r=[n];return e(t,n,i,r)}var o,s,a,u,l,c;return o="undefined"!=typeof i&&"undefined"!=typeof t,s=o?t("util"):function(){function t(t){return"object"==typeof t&&"[object Array]"===Object.prototype.toString.call(t)}function e(t){return"object"==typeof t&&"[object Date]"===Object.prototype.toString.call(t)}function n(t){return"object"==typeof t&&"[object RegExp]"===Object.prototype.toString.call(t)}function i(t){return"symbol"==typeof t}return{isArray:"function"==typeof Array.isArray?function(t){return Array.isArray(t)}:t,isDate:e,isRegExp:n,isSymbol:"function"==typeof Symbol?i:function(){return!1}}}(),a=o?function(t){return r.isBuffer(t)}:function(){return!1},u="function"==typeof Object.keys?function(t){return Object.keys(t)}:function(t){var e,n=[];if(null===t||"object"!=typeof t)throw new TypeError("obj is not an Object");for(e in t)t.hasOwnProperty(e)&&n.push(e);return n},l="function"==typeof Symbol?function(t){return Object.getOwnPropertySymbols(t)}:function(){return[]},c="function"==typeof Array.prototype.indexOf?function(t,e){return t.indexOf(e)}:function(t,e){var n,i;if(!s.isArray(t))throw new TypeError("array is not an Array");for(n=0,i=t.length;i>n;++n)if(t[n]===e)return n;return-1},n})}).call(this,t("_process"),t("buffer").Buffer)},{_process:9,buffer:4,util:11}],42:[function(t,e,n){var i=function(){var t=0,e={},n=[],i=[],r=[];this.addVertexAND=function(o){void 0===e[o]&&(e[o]=t,n[t]=o,i[t]=!0,r[t]=[],t++)},this.addVertexOR=function(o){void 0===e[o]&&(e[o]=t,n[t]=o,i[t]=!1,r[t]=[],t++)},this.addEdge=function(t,n){if(Array.isArray(n))n.forEach(function(t){if(!(t in e))throw new Error("Not a vertex name:",t)}),Array.prototype.push.apply(r[e[t]],n.map(function(t){return e[t]}));else{if(!(n in e))throw new Error("Not a vertex name:",n);r[e[t]].push(e[n])}},this.adj=function(t){return r[e[t]].map(function(t){return n[t]})},this.V=function(){return t},this.isTerminal=function(t){return 0===r[e[t]].length},this.isVertex=function(t){return t in e},this.isTypeAND=function(t){return i[e[t]]},this.vertices=function(){return Object.keys(e)}};e.exports=i},{}],43:[function(t,e,n){var i=t("./parse-grammar"),r=t("./guided-decision-graph"),o=t("./recognizer.js"),s=function(t,e,n){var s=i(t,n);this.vertices=function(){return s.vertices()},this.adj=function(t){return s.adj(t)},this.isTypeAND=function(t){return s.isTypeAND(t)},this.createGuide=function(t){return new r(s,t)},this.createRecognizer=function(t){return new o(s,t)}};e.exports=s},{"./guided-decision-graph":44,"./parse-grammar":45,"./recognizer.js":46}],44:[function(t,e,n){var i=t("./utils/clone.js"),r=function(t,e){function n(e){a=!1;for(var n={};0!==e.length;){var r=e.pop();if(0===r.length)a=!0;else{var o=r.pop();if(t.isTerminal(o))o in n||(n[o]=[]),n[o].push(r);else if(t.isTypeAND(o)){for(var s=t.adj(o),u=s.length-1;u>=0;u--)r.push(s[u]);e.push(r)}else{var l=t.adj(o);l.forEach(function(t){var n=i(r);n.push(t),e.push(n)})}}}return n}if(!t.isVertex(e))throw new Error("given start is not a vertex in dg:",e);var r,s=[],a=!1,u=[],l=[],c=this;r=n([[e]]),this.construction=function(){return i(s)},this.isComplete=function(){return a},this.choose=function(t){if(Array.isArray(t))t.forEach(function(t){c.choose(t)});else{if(!(t in r))throw new Error("Not a valid next terminal:",t);s.push(t),u.push(i(r)),l.push(a),r=n(r[t])}},this.constructs=function(){var t=[];for(var e in r)r[e].forEach(function(n){var r=i(n);r.push(e),r.reverse();var o=s.length>0?s.join(" "):"",a=r.join(" "),u=o&&a?o+" "+a:o+a;t.push(u)});return c.isComplete()&&t.push(c.construction().join(" ")),t.sort()},this.pop=function(){if(0===s.length)throw new Error("Cannot pop empty construction.");return r=u.pop(),a=l.pop(),s.pop()},this.choices=function(t){return void 0===t||1===t?Object.keys(r):Object.keys(r).map(function(e){var n=new o(e);return c.choose(e),n.next=t-1>1?c.choices(t-1):c.choices(t-1).map(o),c.pop(),n})}},o=function(t){return this instanceof o?(this.val=t,void(this.next=[])):new o(t)};e.exports=r},{"./utils/clone.js":48}],45:[function(t,e,n){var i=t("./reduce-grammar.js"),r=t("./decision-graph.js"),o=function(t,e){e=void 0===e?/\s+/:e,t=i(t,e);var n=new r,o=Object.keys(t);return o.forEach(function(e){t[e].length>1?n.addVertexOR(e):n.addVertexAND(e)}),o.forEach(function(i){t[i].forEach(function(r){var o=r.split(e);o.forEach(function(e){e in t||n.addVertexAND(e)}),n.addEdge(i,o)})}),n};e.exports=o},{"./decision-graph.js":42,"./reduce-grammar.js":47}],46:[function(t,e,n){var i=t("./guided-decision-graph.js"),r=function(t,e,n){n=n||/\s+/;var r=function(t,e){for(var n=0;n<e.length;n++){if(-1===t.choices().indexOf(e[n]))return!1;t.choose(e[n])}return!0};this.isValid=function(o){if(0===o.length)return!0;var s=new i(t,e);return r(s,o.split(n))},this.isComplete=function(o){var s=new i(t,e);return r(s,o.split(n))?s.isComplete():!1}};e.exports=r},{"./guided-decision-graph.js":44}],47:[function(t,e,n){var i=t("./utils/clone.js"),r=function(t,e){t=i(t),e=void 0===e?/\s+/:e;var n=Object.keys(t);return n.forEach(function(n){if(t[n].length>1){var i=1;t[n].forEach(function(r,o){var s=r.split(e);if(s.length>1){var a="_"+n+"_"+i;t[a]=[r],t[n][o]=a,i++}})}}),t};e.exports=r},{"./utils/clone.js":48}],48:[function(t,e,n){function i(t){return JSON.parse(JSON.stringify(t))}e.exports=i},{}],49:[function(t,e,n){var i=t("nmusic").intervalQuality,r="MmPAd",o=function(t){for(var e="",n=0;n<arguments.length;n++){if(-1===r.indexOf(arguments[n]))throw new Error("Not a valid quality char:",arguments[n]);e+=arguments[n]}return function(t,n){if(0===n.length)return t;var r=n[n.length-1];return t.filter(function(t){return-1!==e.indexOf(i(r,t))})}};e.exports=o},{nmusic:60}],50:[function(t,e,n){function i(t){return function(e,n){return n.length<t?e:[]}}e.exports=i},{}],51:[function(t,e,n){function i(t){return function(e,n){if(0===n.length)return e;var i=o(n),s=i[0],a=i[i.length-1];return e.filter(function(e){return r(s,e)<=t&&r(a,e)<=t})}}var r=t("nmusic").intervalSize,o=t("../utils/sort-pitches.js");e.exports=i},{"../utils/sort-pitches.js":55,nmusic:60}],52:[function(t,e,n){var i=t("nmusic").Key,r=t("nmusic").Pitch,o=t("./utils/clone.js"),s=function(t,e,n){e=e||new i("C","major"),n=n||[1];var s=[],u=[],l=this,c=function(){return s[s.length-1]},h=function(t){return 0===u.length?t:u.reduce(function(t,e){return e(t,l.construction())},t)};this.addFilter=function(t){u.push(t)},this.construction=function(){return o(s)},this.tonic=function(){return e.tonic.pitchClass()},this.isComplete=function(){return t.isComplete()},this.choose=function(e){if(Array.isArray(e))e.forEach(l.choose);else{var n=l.choices();if(0===s.length){if(-1===n.indexOf(r(e).pitchClass()))throw new Error("Not a valid initial pitch:",e);s.push(r(e).sciPitch())}else{if(-1===n.indexOf(r(e).sciPitch()))throw new Error("Not a valid next pitch:",e);var i=r(e),o=i>r(c())?"":"-",a=o+i.intervalSize(c());t.choose(a),s.push(i.sciPitch())}}},this.pop=function(){if(0===s.length)throw new Error("Cannot pop empty construction.");return s.length>1&&t.pop(),s.pop()},this.choices=function(i){var r;return r=0===s.length?n.map(function(t){return e.pitchAtDegree(t).pitchClass()}):t.choices().map(function(t){return e.plusInterval(c(),t).sciPitch()}),r=h(r),void 0===i||1===i?r:r.map(function(t){var e=new a(t);return l.choose(t),e.next=i-1>1?l.choices(i-1):l.choices(i-1).map(a),l.pop(),e})},this.constructs=function(){return t.constructs()}},a=function(t){return this instanceof a?(this.val=t,void(this.next=[])):new a(t)};e.exports=s},{"./utils/clone.js":54,nmusic:60}],53:[function(t,e,n){var i=t("grammar-graph"),r=t("./guided-music-machine.js"),o=t("nmusic").Key,s=function(t,e,n){var s=new i(t),a=[];this.vertices=function(){return s.vertices()},this.addFilter=function(t){a.push(t)},this.createGuide=function(t){t=t||"C major";var i=t.split(/\s+/),u=new o(i[0],i[1]),l=new r(s.createGuide(e),u,n);return a.forEach(l.addFilter),l}};s.filter={maxLength:t("./filters/max-length.js"),maxRange:t("./filters/max-range.js"),allowedIntervalQualities:t("./filters/allowed-interval-qualities.js")},e.exports=s},{"./filters/allowed-interval-qualities.js":49,"./filters/max-length.js":50,"./filters/max-range.js":51,"./guided-music-machine.js":52,"grammar-graph":43,nmusic:60}],54:[function(t,e,n){arguments[4][48][0].apply(n,arguments)},{dup:48}],55:[function(t,e,n){function i(t){return t.map(r).sort(function(t,e){return t-e}).map(function(t){return t.sciPitch()})}var r=t("nmusic").Pitch;e.exports=i},{nmusic:60}],56:[function(t,e,n){var i=t("../pitch/pitch.js"),r=t("./mode-intervals.js"),o=t("./scale-set.js"),s=t("../pitch/parse-pitch.js"),a=t("../pitch/interval-size.js"),u=function(t,e){return this instanceof u?(this.tonic=i(t),this.modeName="string"==typeof e?e.toLowerCase():"custom-scale",this.mode="string"==typeof e?r(e):e,this.scale=o(this.tonic.pitchClass(),this.mode),Object.freeze(this.scale),void Object.freeze(this)):new u(t,e)};u.prototype={constructor:u,toString:function(){return this.tonic.pitchClass()+" "+this.modeName},inKey:function(t){return this.scale.indexOf(i(t).pitchClass())>-1},accidentalOn:function(t){var e=a.simple(this.tonic.name,i(t).letter()+(this.tonic.octave()+1));return s(this.scale[e-1]).accidental},pitchAtDegree:function(t){return i(this.scale[(t-1)%this.scale.length])},scaleDegree:function(t){return this.inKey(t)?this.scale.indexOf(i(t).pitchClass())+1:-1},plusInterval:function(t,e){var n=i(t).plusInterval(e);return new i(n.letter()+this.accidentalOn(n)+n.octave())}},e.exports=u},{"../pitch/interval-size.js":62,"../pitch/parse-pitch.js":65,"../pitch/pitch.js":66,"./mode-intervals.js":57,"./scale-set.js":58}],57:[function(t,e,n){arguments[4][24][0].apply(n,arguments)},{dup:24}],58:[function(t,e,n){var i=t("./scale.js"),r=t("../pitch/parse-pitch.js"),o=function(t,e){return i(t,e).map(function(t){var e=r(t);return e.letter+e.accidental})};e.exports=o},{"../pitch/parse-pitch.js":65,"./scale.js":59}],59:[function(t,e,n){var i=t("../pitch/plus-interval.js"),r=t("./mode-intervals.js"),o=function(t,e){return e="string"==typeof e?r(e):e,e.map(i(t))};e.exports=o},{"../pitch/plus-interval.js":67,"./mode-intervals.js":57}],60:[function(t,e,n){var i=t("./pitch/pitch.js"),r=t("./pitch/parse-pitch.js"),o=function(t){return t instanceof i?t:r(t)?new i(t):null};o.Pitch=i,o.intervalQuality=t("./pitch/interval-quality.js"),o.intervalSize=t("./pitch/interval-size.js"),o.interval=t("./pitch/interval.js"),o.parseInterval=t("./pitch/parse-interval.js"),o.parsePitch=t("./pitch/parse-pitch.js"),o.plusInterval=t("./pitch/plus-interval.js"),o.semitonesBetween=t("./pitch/semitones-between.js"),o.simplifyIntervalSize=t("./pitch/simplify-interval-size.js"),o.toMidi=t("./pitch/to-midi.js"),o.Key=t("./key/key.js"),o.modeIntervals=t("./key/mode-intervals.js"),o.scaleSet=t("./key/scale-set.js"),o.scale=t("./key/scale.js"),n=e.exports=o},{"./key/key.js":56,"./key/mode-intervals.js":57,"./key/scale-set.js":58,"./key/scale.js":59,"./pitch/interval-quality.js":61,"./pitch/interval-size.js":62,"./pitch/interval.js":63,"./pitch/parse-interval.js":64,"./pitch/parse-pitch.js":65,"./pitch/pitch.js":66,"./pitch/plus-interval.js":67,"./pitch/semitones-between.js":68,"./pitch/simplify-interval-size.js":69,"./pitch/to-midi.js":70}],61:[function(t,e,n){var i=t("./interval-size.js"),r=t("./semitones-between.js"),o={1:{0:"P",1:"A",11:"d"},2:{0:"d",1:"m",2:"M",3:"A"},3:{2:"d",3:"m",4:"M",5:"A"},4:{4:"d",5:"P",6:"A"},5:{6:"d",7:"P",8:"A"},6:{7:"d",8:"m",9:"M",10:"A"},7:{9:"d",10:"m",11:"M",0:"A"},8:{11:"d",12:"P",13:"A"}},s=function(t,e){var n=i.simple(t,e),s=r(t,e)%12;return o[n][s]};e.exports=s},{"./interval-size.js":62,"./semitones-between.js":68}],62:[function(t,e,n){var i=t("./parse-pitch.js"),r=t("./simplify-interval-size.js"),o="CDEFGAB",s=function(t,e){var n=i(t),r=i(e);if(!n||!r)throw Error("At least one invalid pitch name:",t,e);return Math.abs(o.indexOf(n.letter)-o.indexOf(r.letter)+o.length*(n.octave-r.octave))+1};s.simple=function(t,e){return r(s(t,e))},e.exports=s},{"./parse-pitch.js":65,"./simplify-interval-size.js":69}],63:[function(t,e,n){var i=t("./interval-size.js"),r=t("./interval-quality.js"),o=function(t,e){return r(t,e)+i(t,e)};o.simple=function(t,e){return r(t,e)+i.simple(t,e)},e.exports=o},{"./interval-quality.js":61,"./interval-size.js":62}],64:[function(t,e,n){arguments[4][32][0].apply(n,arguments)},{"./simplify-interval-size.js":69,dup:32}],65:[function(t,e,n){var i=function(t){var e=/^([a-gA-G])(b{1,2}|#{1,2})?(\d{1,2})?$/.exec(t);if(!e)return!1;var n={};return n.letter=e[1].toUpperCase(),n.accidental=void 0===e[2]?"":e[2],n.numAccidental=n.accidental.length>0&&"b"===n.accidental[0]?-1*n.accidental.length:n.accidental.length,n.octave=void 0===e[3]?4:Number(e[3]),n.sciPitch=n.letter+n.accidental+n.octave,n};e.exports=i},{}],66:[function(t,e,n){function i(t){if(t instanceof i)return t;if(!(this instanceof i))return new i(t);var e=r(t);if(!e)throw Error("Invalid pitch name: "+t);this.name=e.sciPitch,Object.freeze(this)}var r=t("./parse-pitch.js"),o=t("./to-midi.js"),s=t("./semitones-between.js"),a=t("./interval-size.js"),u=t("./interval.js"),l=t("./plus-interval.js");i.prototype={constructor:i,toString:function(){return this.name},valueOf:function(){return this.midi()},equals:function(t){return this.name===i(t).name},isEnharmonic:function(t){return this.midi()===i(t).midi()},sciPitch:function(){return this.name},letter:function(){return r(this.name).letter},accidental:function(){return r(this.name).accidental},octave:function(){return r(this.name).octave},pitchClass:function(){var t=r(this.name);return t.letter+t.accidental},numAccidental:function(){return r(this.name).numAccidental},midi:function(){return o(this.name)},semitonesTo:function(t){return s(this.name,i(t).name)},intervalSize:function(t){return a(this.name,i(t).name)},simpleIntervalSize:function(t){return a.simple(this.name,i(t).name)},interval:function(t){return u(this.name,i(t).name)},simpleInterval:function(t){return u.simple(this.name,i(t).name)},plusInterval:function(t){return new i(l(this.name,t))}},e.exports=i},{"./interval-size.js":62,"./interval.js":63,"./parse-pitch.js":65,"./plus-interval.js":67,"./semitones-between.js":68,"./to-midi.js":70}],67:[function(t,e,n){var i=t("./parse-pitch.js"),r=t("./parse-interval.js"),o=t("./semitones-between.js"),s="CDEFGAB",a={"-2":"bb","-1":"b",0:"",1:"#",2:"##"},u=function(t,e){if(1===arguments.length){var n=arguments[0];return function(t){return i(n)!==!1?u(n,t):u(t,n)}}var l=i(t),c=r(e);
if(!l||!c)throw new Error("Invalid pitch or interval:",t,e);if(1===c.size&&c.quality){if("P"===c.quality)return l.sciPitch;var h=1===c.direction?"":"-",f=1===c.direction?"-":"";if("A"===c.quality)return u(u(l.sciPitch,h+"M2"),f+"m2");if("d"===c.quality)return u(u(l.sciPitch,h+"m2"),f+"M2")}var p=s.indexOf(l.letter)+(c.simpleSize-1)*c.direction;p>=s.length?(c.octaves+=1,p%=s.length):0>p&&(c.octaves+=1,p+=s.length);var d=s[p]+String(c.direction*c.octaves+l.octave);if(null===c.quality)return d;var g=c.direction*(c.halfsteps-o(l.sciPitch,d));return s[p]+a[g]+String(c.direction*c.octaves+l.octave)};e.exports=u},{"./parse-interval.js":64,"./parse-pitch.js":65,"./semitones-between.js":68}],68:[function(t,e,n){var i=t("./to-midi.js"),r=function(t,e){return Math.abs(i(t)-i(e))};e.exports=r},{"./to-midi.js":70}],69:[function(t,e,n){arguments[4][37][0].apply(n,arguments)},{dup:37}],70:[function(t,e,n){var i=t("./parse-pitch.js"),r={C:0,D:2,E:4,F:5,G:7,A:9,B:11},o=12,s=function(t){var e=i(t);if(!e)throw Error("Invalid pitch name: "+t);return r[e.letter]+o*(e.octave+1)+e.numAccidental};e.exports=s},{"./parse-pitch.js":65}],71:[function(t,e,n){arguments[4][23][0].apply(n,arguments)},{"../pitch/interval-size.js":77,"../pitch/parse-pitch.js":81,"../pitch/pitch.js":82,"./mode-intervals.js":72,"./scale-set.js":73,dup:23}],72:[function(t,e,n){arguments[4][24][0].apply(n,arguments)},{dup:24}],73:[function(t,e,n){arguments[4][25][0].apply(n,arguments)},{"../pitch/parse-pitch.js":81,"./scale.js":74,dup:25}],74:[function(t,e,n){arguments[4][26][0].apply(n,arguments)},{"../pitch/plus-interval.js":83,"./mode-intervals.js":72,dup:26}],75:[function(t,e,n){arguments[4][27][0].apply(n,arguments)},{"./key/key.js":71,"./key/mode-intervals.js":72,"./key/scale-set.js":73,"./key/scale.js":74,"./pitch/interval-quality.js":76,"./pitch/interval-size.js":77,"./pitch/interval.js":78,"./pitch/is-higher.js":79,"./pitch/parse-interval.js":80,"./pitch/parse-pitch.js":81,"./pitch/pitch.js":82,"./pitch/plus-interval.js":83,"./pitch/semitones-between.js":84,"./pitch/simplify-interval-size.js":85,"./pitch/sort-pitches.js":86,"./pitch/to-midi.js":87,dup:27}],76:[function(t,e,n){var i=t("./interval-size.js"),r=t("./semitones-between.js"),o={1:{0:"P",1:"A",2:"AA",11:"d"},2:{11:"dd",0:"d",1:"m",2:"M",3:"A",4:"AA"},3:{2:"d",3:"m",4:"M",5:"A",6:"AA"},4:{4:"d",5:"P",6:"A",7:"AA"},5:{6:"d",7:"P",8:"A",9:"AA"},6:{7:"d",8:"m",9:"M",10:"A",11:"AA"},7:{9:"d",10:"m",11:"M",0:"A",1:"AA"},8:{11:"d",12:"P",13:"A"}},s=function(t,e){var n=i.simple(t,e),s=r(t,e)%12;return o[n][s]};e.exports=s},{"./interval-size.js":77,"./semitones-between.js":84}],77:[function(t,e,n){arguments[4][29][0].apply(n,arguments)},{"./parse-pitch.js":81,"./simplify-interval-size.js":85,dup:29}],78:[function(t,e,n){arguments[4][30][0].apply(n,arguments)},{"./interval-quality.js":76,"./interval-size.js":77,dup:30}],79:[function(t,e,n){arguments[4][31][0].apply(n,arguments)},{"./to-midi.js":87,dup:31}],80:[function(t,e,n){var i=t("./simplify-interval-size.js"),r=[1,4,5],o="dAP",s="MmAd",a=7,u=12,l={1:{P:0,A:1,d:-1},2:{d:0,m:1,M:2,A:3},3:{d:2,m:3,M:4,A:5},4:{d:4,P:5,A:6},5:{d:6,P:7,A:8},6:{d:7,m:8,M:9,A:10},7:{d:9,m:10,M:11,A:12}},c=function(t){var e=/^(-)?([mMP]|A+|d+)?(\d{1,2})$/.exec(String(t));if(!e||"0"===e[3])return!1;var n={};if(n.interval=e[0],n.direction=void 0===e[1]?1:-1,n.quality=void 0===e[2]?null:e[2],n.size=Number(e[3]),n.simpleSize=i(n.size),n.perfectable=r.indexOf(n.simpleSize)>-1,n.simpleSize=i(n.size),n.octaves=Math.floor((n.size-1)/a),null!==n.quality){if(n.perfectable&&-1===o.indexOf(n.quality[0])||!n.perfectable&&-1===s.indexOf(n.quality[0]))return!1;n.halfsteps=l[n.simpleSize][n.quality[0]]+n.octaves*u,n.quality.length>1&&(n.halfsteps+="A"===n.quality[0]?n.quality.length-1:-(n.quality.length-1))}return n};e.exports=c},{"./simplify-interval-size.js":85}],81:[function(t,e,n){arguments[4][33][0].apply(n,arguments)},{dup:33}],82:[function(t,e,n){arguments[4][34][0].apply(n,arguments)},{"./interval-size.js":77,"./interval.js":78,"./is-higher.js":79,"./parse-pitch.js":81,"./plus-interval.js":83,"./semitones-between.js":84,"./to-midi.js":87,dup:34}],83:[function(t,e,n){arguments[4][35][0].apply(n,arguments)},{"./parse-interval.js":80,"./parse-pitch.js":81,"./semitones-between.js":84,dup:35}],84:[function(t,e,n){arguments[4][36][0].apply(n,arguments)},{"./to-midi.js":87,dup:36}],85:[function(t,e,n){arguments[4][37][0].apply(n,arguments)},{dup:37}],86:[function(t,e,n){arguments[4][38][0].apply(n,arguments)},{"./pitch.js":82,dup:38}],87:[function(t,e,n){arguments[4][39][0].apply(n,arguments)},{"./parse-pitch.js":81,dup:39}],88:[function(require,module,exports){!function(root){"use strict";function Main(t){Tone=t()}function Module(t){t(Tone)}var Tone;Main(function(){function t(t){return void 0===t}function e(t){return"function"==typeof t}var n;if(t(window.AudioContext)&&(window.AudioContext=window.webkitAudioContext),t(window.OfflineAudioContext)&&(window.OfflineAudioContext=window.webkitOfflineAudioContext),t(AudioContext))throw new Error("Web Audio is not supported in this browser");n=new AudioContext,e(AudioContext.prototype.createGain)||(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),e(AudioContext.prototype.createDelay)||(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),e(AudioContext.prototype.createPeriodicWave)||(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),e(AudioBufferSourceNode.prototype.start)||(AudioBufferSourceNode.prototype.start=AudioBufferSourceNode.prototype.noteGrainOn),e(AudioBufferSourceNode.prototype.stop)||(AudioBufferSourceNode.prototype.stop=AudioBufferSourceNode.prototype.noteOff),e(OscillatorNode.prototype.start)||(OscillatorNode.prototype.start=OscillatorNode.prototype.noteOn),e(OscillatorNode.prototype.stop)||(OscillatorNode.prototype.stop=OscillatorNode.prototype.noteOff),e(OscillatorNode.prototype.setPeriodicWave)||(OscillatorNode.prototype.setPeriodicWave=OscillatorNode.prototype.setWaveTable),AudioNode.prototype._nativeConnect=AudioNode.prototype.connect,AudioNode.prototype.connect=function(e,n,i){if(e.input)Array.isArray(e.input)?(t(i)&&(i=0),this.connect(e.input[i])):this.connect(e.input,n,i);else try{e instanceof AudioNode?this._nativeConnect(e,n,i):this._nativeConnect(e,n)}catch(r){throw new Error("error connecting to node: "+e)}};var i=function(e,n){t(e)||1===e?this.input=this.context.createGain():e>1&&(this.input=new Array(e)),t(n)||1===n?this.output=this.context.createGain():n>1&&(this.output=new Array(e))};i.prototype.set=function(e,n,r){if("object"==typeof e)r=n;else if("string"==typeof e){var o={};o[e]=n,e=o}for(var s in e){n=e[s];var a=this;if(-1!==s.indexOf(".")){for(var u=s.split("."),l=0;l<u.length-1;l++)a=a[u[l]];s=u[u.length-1]}var c=a[s];t(c)||(c instanceof i.Signal?c.value!==n&&(t(r)?c.value=n:c.rampTo(n,r)):c instanceof AudioParam?c.value!==n&&(c.value=n):c instanceof i?c.set(n):c!==n&&(a[s]=n))}return this},i.prototype.get=function(n){t(n)?n=this._collectDefaults(this.constructor):"string"==typeof n&&(n=[n]);for(var r={},o=0;o<n.length;o++){var s=n[o],a=this,u=r;if(-1!==s.indexOf(".")){for(var l=s.split("."),c=0;c<l.length-1;c++){var h=l[c];u[h]=u[h]||{},u=u[h],a=a[h]}s=l[l.length-1]}var f=a[s];"object"==typeof n[s]?u[s]=f.get():f instanceof i.Signal?u[s]=f.value:f instanceof AudioParam?u[s]=f.value:f instanceof i?u[s]=f.get():e(f)||t(f)||(u[s]=f)}return r},i.prototype._collectDefaults=function(e){var n=[];if(t(e.defaults)||(n=Object.keys(e.defaults)),!t(e._super))for(var i=this._collectDefaults(e._super),r=0;r<i.length;r++)-1===n.indexOf(i[r])&&n.push(i[r]);return n},i.prototype.setPreset=function(t){return!this.isUndef(this.preset)&&this.preset.hasOwnProperty(t)&&this.set(this.preset[t]),this},i.prototype.toString=function(){for(var t in i){var n=t[0].match(/^[A-Z]$/),r=i[t]===this.constructor;if(e(i[t])&&n&&r)return t}return"Tone"},i.context=n,i.prototype.context=i.context,i.prototype.bufferSize=2048,i.prototype.bufferTime=i.prototype.bufferSize/i.context.sampleRate,i.prototype.dispose=function(){return this.isUndef(this.input)||(this.input instanceof AudioNode&&this.input.disconnect(),this.input=null),this.isUndef(this.output)||(this.output instanceof AudioNode&&this.output.disconnect(),this.output=null),this};var r=null;i.prototype.noGC=function(){return this.output.connect(r),this},AudioNode.prototype.noGC=function(){return this.connect(r),this},i.prototype.connect=function(t,e,n){return Array.isArray(this.output)?(e=this.defaultArg(e,0),this.output[e].connect(t,0,n)):this.output.connect(t,e,n),this},i.prototype.disconnect=function(t){return Array.isArray(this.output)?(t=this.defaultArg(t,0),this.output[t].disconnect()):this.output.disconnect(),this},i.prototype.connectSeries=function(){if(arguments.length>1)for(var t=arguments[0],e=1;e<arguments.length;e++){var n=arguments[e];t.connect(n),t=n}return this},i.prototype.connectParallel=function(){var t=arguments[0];if(arguments.length>1)for(var e=1;e<arguments.length;e++){var n=arguments[e];t.connect(n)}return this},i.prototype.chain=function(){if(arguments.length>0)for(var t=this,e=0;e<arguments.length;e++){var n=arguments[e];t.connect(n),t=n}return this},i.prototype.fan=function(){if(arguments.length>0)for(var t=0;t<arguments.length;t++)this.connect(arguments[t]);return this},AudioNode.prototype.chain=i.prototype.chain,AudioNode.prototype.fan=i.prototype.fan,i.prototype.defaultArg=function(e,n){if("object"==typeof e&&"object"==typeof n){var i={};for(var r in e)i[r]=this.defaultArg(e[r],e[r]);for(var o in n)i[o]=this.defaultArg(e[o],n[o]);return i}return t(e)?n:e},i.prototype.optionsObject=function(t,e,n){var i={};if(1===t.length&&"object"==typeof t[0])i=t[0];else for(var r=0;r<e.length;r++)i[e[r]]=t[r];return this.isUndef(n)?i:this.defaultArg(i,n)},i.prototype.isUndef=t,i.prototype.isFunction=e,i.prototype._readOnly=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this._readOnly(t[e]);else Object.defineProperty(this,t,{writable:!1,enumerable:!0})},i.prototype._writable=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this._writable(t[e]);else Object.defineProperty(this,t,{writable:!0})},i.prototype.equalPowerScale=function(t){var e=.5*Math.PI;return Math.sin(t*e)},i.prototype.dbToGain=function(t){return Math.pow(2,t/6)},i.prototype.gainToDb=function(t){return 20*(Math.log(t)/Math.LN10)},i.prototype.now=function(){return this.context.currentTime},i.prototype.samplesToSeconds=function(t){return t/this.context.sampleRate},i.prototype.toSamples=function(t){var e=this.toSeconds(t);return Math.round(e*this.context.sampleRate)},i.prototype.toSeconds=function(t,e){if(e=this.defaultArg(e,this.now()),"number"==typeof t)return t;if("string"==typeof t){var n=0;return"+"===t.charAt(0)&&(t=t.slice(1),n=e),parseFloat(t)+n}return e},i.prototype.isFrequency=function(){var t=new RegExp(/\d*\.?\d+hz$/i);return function(e){return t.test(e)}}(),i.prototype.frequencyToSeconds=function(t){return 1/parseFloat(t)},i.prototype.secondsToFrequency=function(t){return 1/t},i.extend=function(e,n){function r(){}t(n)&&(n=i),r.prototype=n.prototype,e.prototype=new r,e.prototype.constructor=e,e._super=n},i.Type={Default:"number",Time:"time",Frequency:"frequency",Gain:"gain",NormalRange:"normalrange",AudioRange:"audiorange",Decibels:"db",Interval:"interval",BPM:"bpm",Positive:"positive",Cents:"cents",Degrees:"degrees",MIDI:"midi",TransportTime:"transporttime"},i.State={Started:"started",Stopped:"stopped",Paused:"paused"},i.noOp=function(){};var o=[];return i._initAudioContext=function(t){t(i.context),o.push(t)},i.setContext=function(t){i.prototype.context=t,i.context=t;for(var e=0;e<o.length;e++)o[e](t)},i.startMobile=function(){var t=i.context.createOscillator(),e=i.context.createGain();e.gain.value=0,t.connect(e),e.connect(i.context.destination);var n=i.context.currentTime;t.start(n),t.stop(n+1)},i._initAudioContext(function(t){i.prototype.bufferTime=i.prototype.bufferSize/t.sampleRate,r=t.createGain(),r.gain.value=0,r.connect(t.destination)}),i.version="r5",console.log("%c * Tone.js "+i.version+" * ","background: #000; color: #fff"),i}),Module(function(t){return t.SignalBase=function(){},t.extend(t.SignalBase),t.SignalBase.prototype.connect=function(e,n,i){return e.constructor===t.Signal?(e._value.cancelScheduledValues(0),e._value.value=0,e.overridden=!0):e instanceof AudioParam&&(e.cancelScheduledValues(0),e.value=0),t.prototype.connect.call(this,e,n,i),this},t.SignalBase}),Module(function(t){return t.WaveShaper=function(t,e){this._shaper=this.input=this.output=this.context.createWaveShaper(),this._curve=null,Array.isArray(t)?this.curve=t:isFinite(t)||this.isUndef(t)?this._curve=new Float32Array(this.defaultArg(t,1024)):this.isFunction(t)&&(this._curve=new Float32Array(this.defaultArg(e,1024)),this.setMap(t))},t.extend(t.WaveShaper,t.SignalBase),t.WaveShaper.prototype.setMap=function(t){for(var e=0,n=this._curve.length;n>e;e++){var i=e/n*2-1;this._curve[e]=t(i,e)}return this._shaper.curve=this._curve,this},Object.defineProperty(t.WaveShaper.prototype,"curve",{get:function(){return this._shaper.curve},set:function(t){if(this._isSafari()){var e=t[0];t.unshift(e)}this._curve=new Float32Array(t),this._shaper.curve=this._curve}}),Object.defineProperty(t.WaveShaper.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(t){this._shaper.oversample=t}}),t.WaveShaper.prototype._isSafari=function(){var t=navigator.userAgent.toLowerCase();return-1!==t.indexOf("safari")&&-1===t.indexOf("chrome")},t.WaveShaper.prototype.dispose=function(){return t.prototype.dispose.call(this),this._shaper.disconnect(),this._shaper=null,this._curve=null,this},t.WaveShaper}),Module(function(t){return t.Signal=function(){var e=this.optionsObject(arguments,["value","units"],t.Signal.defaults);this.units=e.units,this.convert=e.convert,this.overridden=!1,this.output=this._scaler=this.context.createGain(),this.input=this._value=this._scaler.gain,e.value instanceof AudioParam?(this._scaler.connect(e.value),e.value.value=0):(this.isUndef(e.param)||(this._scaler.connect(e.param),e.param.value=0),this.value=e.value),t.Signal._constant.chain(this._scaler)},t.extend(t.Signal,t.SignalBase),t.Signal.defaults={value:0,param:void 0,units:t.Type.Default,convert:!0},Object.defineProperty(t.Signal.prototype,"value",{get:function(){return this._toUnits(this._value.value)},set:function(t){var e=this._fromUnits(t);this.cancelScheduledValues(0),this._value.value=e}}),t.Signal.prototype._fromUnits=function(e){if(!this.convert&&!this.isUndef(this.convert))return e;switch(this.units){case t.Type.Time:return this.toSeconds(e);case t.Type.Frequency:return this.toFrequency(e);case t.Type.Decibels:return this.dbToGain(e);case t.Type.NormalRange:return Math.min(Math.max(e,0),1);case t.Type.AudioRange:return Math.min(Math.max(e,-1),1);case t.Type.Positive:return Math.max(e,0);default:return e}},t.Signal.prototype._toUnits=function(e){if(!this.convert&&!this.isUndef(this.convert))return e;switch(this.units){case t.Type.Decibels:return this.gainToDb(e);default:return e}},t.Signal.prototype.setValueAtTime=function(t,e){return t=this._fromUnits(t),this._value.setValueAtTime(t,this.toSeconds(e)),this},t.Signal.prototype.setCurrentValueNow=function(t){t=this.defaultArg(t,this.now());var e=this._value.value;return this.cancelScheduledValues(t),this._value.setValueAtTime(e,t),this},t.Signal.prototype.linearRampToValueAtTime=function(t,e){return t=this._fromUnits(t),this._value.linearRampToValueAtTime(t,this.toSeconds(e)),this},t.Signal.prototype.exponentialRampToValueAtTime=function(t,e){return t=this._fromUnits(t),t=Math.max(1e-5,t),this._value.exponentialRampToValueAtTime(t,this.toSeconds(e)),this},t.Signal.prototype.exponentialRampToValueNow=function(t,e){var n=this.now(),i=this.value;return this.setValueAtTime(Math.max(i,1e-4),n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this},t.Signal.prototype.linearRampToValueNow=function(t,e){var n=this.now();return this.setCurrentValueNow(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this},t.Signal.prototype.setTargetAtTime=function(t,e,n){return t=this._fromUnits(t),n=Math.max(1e-5,n),this._value.setTargetAtTime(t,this.toSeconds(e),n),this},t.Signal.prototype.setValueCurveAtTime=function(t,e,n){for(var i=0;i<t.length;i++)t[i]=this._fromUnits(t[i]);return this._value.setValueCurveAtTime(t,this.toSeconds(e),this.toSeconds(n)),this},t.Signal.prototype.cancelScheduledValues=function(t){return this._value.cancelScheduledValues(this.toSeconds(t)),this},t.Signal.prototype.rampTo=function(e,n){return n=this.defaultArg(n,0),this.units===t.Type.Frequency||this.units===t.Type.BPM?this.exponentialRampToValueNow(e,n):this.linearRampToValueNow(e,n),this},t.Signal.prototype.dispose=function(){return t.prototype.dispose.call(this),this._value=null,this._scaler=null,this},t.Signal._generator=null,t.Signal._constant=null,t._initAudioContext(function(e){t.Signal._generator=e.createOscillator(),t.Signal._constant=new t.WaveShaper([1,1]),t.Signal._generator.connect(t.Signal._constant),t.Signal._generator.start(0),t.Signal._generator.noGC()}),t.Signal}),Module(function(t){return t.Pow=function(e){this._exp=this.defaultArg(e,1),this._expScaler=this.input=this.output=new t.WaveShaper(this._expFunc(this._exp),8192)},t.extend(t.Pow,t.SignalBase),Object.defineProperty(t.Pow.prototype,"value",{get:function(){return this._exp},set:function(t){this._exp=t,this._expScaler.setMap(this._expFunc(this._exp))}}),t.Pow.prototype._expFunc=function(t){return function(e){return Math.pow(Math.abs(e),t)}},t.Pow.prototype.dispose=function(){return t.prototype.dispose.call(this),this._expScaler.dispose(),this._expScaler=null,this},t.Pow}),Module(function(t){return t.Envelope=function(){var e=this.optionsObject(arguments,["attack","decay","sustain","release"],t.Envelope.defaults);this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this._nextAttack=1/0,this._nextDecay=1/0,this._nextSustain=1/0,this._nextRelease=1/0,this._nextStandby=1/0,this._attackCurve=t.Envelope.Type.Linear,this._peakValue=1,this._minOutput=1e-4,this._sig=this.output=new t.Signal(0),this.attackCurve=e.attackCurve},t.extend(t.Envelope),t.Envelope.defaults={attack:.01,decay:.1,sustain:.5,release:1,attackCurve:"linear"},t.Envelope.prototype._timeMult=.25,Object.defineProperty(t.Envelope.prototype,"value",{get:function(){return this._sig.value}}),Object.defineProperty(t.Envelope.prototype,"attackCurve",{get:function(){return this._attackCurve},set:function(e){if(e!==t.Envelope.Type.Linear&&e!==t.Envelope.Type.Exponential)throw Error('attackCurve must be either "linear" or "exponential". Invalid type: ',e);this._attackCurve=e}}),t.Envelope.prototype._phaseAtTime=function(e){return this._nextRelease>e?this._nextAttack<=e&&this._nextDecay>e?t.Envelope.Phase.Attack:this._nextDecay<=e&&this._nextSustain>e?t.Envelope.Phase.Decay:this._nextSustain<=e&&this._nextRelease>e?t.Envelope.Phase.Sustain:t.Envelope.Phase.Standby:this._nextRelease<e&&this._nextStandby>e?t.Envelope.Phase.Release:t.Envelope.Phase.Standby},t.Envelope.prototype._exponentialApproach=function(t,e,n,i,r){return n+(e-n)*Math.exp(-(r-t)/i)},t.Envelope.prototype._linearInterpolate=function(t,e,n,i,r){return e+(i-e)*((r-t)/(n-t))},t.Envelope.prototype._exponentialInterpolate=function(t,e,n,i,r){return e*Math.pow(i/e,(r-t)/(n-t))},t.Envelope.prototype._valueAtTime=function(e){var n=this.toSeconds(this.attack),i=this.toSeconds(this.decay),r=this.toSeconds(this.release);switch(this._phaseAtTime(e)){case t.Envelope.Phase.Attack:return this._attackCurve===t.Envelope.Type.Linear?this._linearInterpolate(this._nextAttack,this._minOutput,this._nextAttack+n,this._peakValue,e):this._exponentialInterpolate(this._nextAttack,this._minOutput,this._nextAttack+n,this._peakValue,e);case t.Envelope.Phase.Decay:return this._exponentialApproach(this._nextDecay,this._peakValue,this.sustain*this._peakValue,i*this._timeMult,e);case t.Envelope.Phase.Release:return this._exponentialApproach(this._nextRelease,this._peakValue,this._minOutput,r*this._timeMult,e);case t.Envelope.Phase.Sustain:return this.sustain*this._peakValue;case t.Envelope.Phase.Standby:return this._minOutput}},t.Envelope.prototype.triggerAttack=function(e,n){e=this.toSeconds(e);var i=this.toSeconds(this.attack),r=this.toSeconds(this.decay),o=this._valueAtTime(e),s=o*i;this._nextAttack=e-s,this._nextDecay=this._nextAttack+i,this._nextSustain=this._nextDecay+r,this._nextRelease=1/0,this._peakValue=this.defaultArg(n,1);var a=this._peakValue,u=this.sustain*a;return this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(o,e),this._attackCurve===t.Envelope.Type.Linear?this._sig.linearRampToValueAtTime(a,this._nextDecay):this._sig.exponentialRampToValueAtTime(a,this._nextDecay),this._sig.setTargetAtTime(u,this._nextDecay,r*this._timeMult),this},t.Envelope.prototype.triggerRelease=function(e){e=this.toSeconds(e);var n=this._phaseAtTime(e),i=this.toSeconds(this.release),r=this._valueAtTime(e);return this._peakValue=r,this._nextRelease=e,this._nextStandby=this._nextRelease+i,this._sig.cancelScheduledValues(this._nextRelease),n===t.Envelope.Phase.Attack?(this._sig.setCurrentValueNow(),this.attackCurve===t.Envelope.Type.Linear?this._sig.linearRampToValueAtTime(this._peakValue,this._nextRelease):this._sig.exponentialRampToValueAtTime(this._peakValue,this._nextRelease)):this._sig.setValueAtTime(this._peakValue,this._nextRelease),this._sig.setTargetAtTime(this._minOutput,this._nextRelease,i*this._timeMult),this},t.Envelope.prototype.triggerAttackRelease=function(t,e,n){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this},t.Envelope.prototype.connect=t.Signal.prototype.connect,t.Envelope.prototype.dispose=function(){return t.prototype.dispose.call(this),this._sig.dispose(),this._sig=null,this},t.Envelope.Phase={Attack:"attack",Decay:"decay",Sustain:"sustain",Release:"release",Standby:"standby"},t.Envelope.Type={Linear:"linear",Exponential:"exponential"},t.Envelope}),Module(function(t){return t.AmplitudeEnvelope=function(){t.Envelope.apply(this,arguments),this.input=this.output=this.context.createGain(),this._sig.connect(this.output.gain)},t.extend(t.AmplitudeEnvelope,t.Envelope),t.AmplitudeEnvelope}),Module(function(t){return t.Compressor=function(){var e=this.optionsObject(arguments,["threshold","ratio"],t.Compressor.defaults);this._compressor=this.input=this.output=this.context.createDynamicsCompressor(),this.threshold=this._compressor.threshold,this.attack=new t.Signal(this._compressor.attack,t.Type.Time),this.release=new t.Signal(this._compressor.release,t.Type.Time),this.knee=this._compressor.knee,this.ratio=this._compressor.ratio,this._readOnly(["knee","release","attack","ratio","threshold"]),this.set(e)},t.extend(t.Compressor),t.Compressor.defaults={ratio:12,threshold:-24,release:.25,attack:.003,knee:30},t.Compressor.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable(["knee","release","attack","ratio","threshold"]),this._compressor.disconnect(),this._compressor=null,this.attack.dispose(),this.attack=null,this.release.dispose(),this.release=null,this.threshold=null,this.ratio=null,this.knee=null,this},t.Compressor}),Module(function(t){return t.Add=function(e){t.call(this,2,0),this._sum=this.input[0]=this.input[1]=this.output=this.context.createGain(),this._value=this.input[1]=new t.Signal(e),this._value.connect(this._sum)},t.extend(t.Add,t.Signal),t.Add.prototype.dispose=function(){return t.prototype.dispose.call(this),this._sum.disconnect(),this._sum=null,this._value.dispose(),this._value=null,this},t.Add}),Module(function(t){return t.Multiply=function(e){t.call(this,2,0),this._mult=this.input[0]=this.output=this.context.createGain(),this._value=this.input[1]=this.output.gain,this._value.value=this.defaultArg(e,0)},t.extend(t.Multiply,t.Signal),t.Multiply.prototype.dispose=function(){return t.prototype.dispose.call(this),this._mult.disconnect(),this._mult=null,this._value=null,this},t.Multiply}),Module(function(t){return t.Negate=function(){this._multiply=this.input=this.output=new t.Multiply(-1)},t.extend(t.Negate,t.SignalBase),t.Negate.prototype.dispose=function(){return t.prototype.dispose.call(this),this._multiply.dispose(),this._multiply=null,this},t.Negate}),Module(function(t){return t.Subtract=function(e){t.call(this,2,0),this._sum=this.input[0]=this.output=this.context.createGain(),this._neg=new t.Negate,this._value=this.input[1]=new t.Signal(e),this._value.chain(this._neg,this._sum)},t.extend(t.Subtract,t.Signal),t.Subtract.prototype.dispose=function(){return t.prototype.dispose.call(this),this._neg.dispose(),this._neg=null,this._sum.disconnect(),this._sum=null,this._value.dispose(),this._value=null,this},t.Subtract}),Module(function(t){return t.GreaterThanZero=function(){this._thresh=this.output=new t.WaveShaper(function(t){return 0>=t?0:1}),this._scale=this.input=new t.Multiply(1e4),this._scale.connect(this._thresh)},t.extend(t.GreaterThanZero,t.SignalBase),t.GreaterThanZero.prototype.dispose=function(){return t.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._thresh.dispose(),this._thresh=null,this},t.GreaterThanZero}),Module(function(t){return t.EqualZero=function(){this._scale=this.input=new t.Multiply(1e4),this._thresh=new t.WaveShaper(function(t){return 0===t?1:0},128),this._gtz=this.output=new t.GreaterThanZero,this._scale.chain(this._thresh,this._gtz)},t.extend(t.EqualZero,t.SignalBase),t.EqualZero.prototype.dispose=function(){return t.prototype.dispose.call(this),this._gtz.dispose(),this._gtz=null,this._scale.dispose(),this._scale=null,this._thresh.dispose(),this._thresh=null,this},t.EqualZero}),Module(function(t){return t.Equal=function(e){t.call(this,2,0),this._sub=this.input[0]=new t.Subtract(e),this._equals=this.output=new t.EqualZero,this._sub.connect(this._equals),this.input[1]=this._sub.input[1]},t.extend(t.Equal,t.SignalBase),Object.defineProperty(t.Equal.prototype,"value",{get:function(){return this._sub.value},set:function(t){this._sub.value=t}}),t.Equal.prototype.dispose=function(){return t.prototype.dispose.call(this),this._equals.dispose(),this._equals=null,this._sub.dispose(),this._sub=null,this},t.Equal}),Module(function(t){t.Select=function(n){n=this.defaultArg(n,2),t.call(this,n,1),this.gate=new t.Signal(0),this._readOnly("gate");for(var i=0;n>i;i++){var r=new e(i);this.input[i]=r,this.gate.connect(r.selecter),r.connect(this.output)}},t.extend(t.Select,t.SignalBase),t.Select.prototype.select=function(t,e){return t=Math.floor(t),this.gate.setValueAtTime(t,this.toSeconds(e)),this},t.Select.prototype.dispose=function(){this._writable("gate"),this.gate.dispose(),this.gate=null;for(var e=0;e<this.input.length;e++)this.input[e].dispose(),this.input[e]=null;return t.prototype.dispose.call(this),this};var e=function(e){this.selecter=new t.Equal(e),this.gate=this.input=this.output=this.context.createGain(),this.selecter.connect(this.gate.gain)};return t.extend(e),e.prototype.dispose=function(){t.prototype.dispose.call(this),this.selecter.dispose(),this.gate.disconnect(),this.selecter=null,this.gate=null},t.Select}),Module(function(t){return t.IfThenElse=function(){t.call(this,3,0),this._selector=this.output=new t.Select(2),this["if"]=this.input[0]=this._selector.gate,this.then=this.input[1]=this._selector.input[1],this["else"]=this.input[2]=this._selector.input[0]},t.extend(t.IfThenElse,t.SignalBase),t.IfThenElse.prototype.dispose=function(){return t.prototype.dispose.call(this),this._selector.dispose(),this._selector=null,this["if"]=null,this.then=null,this["else"]=null,this},t.IfThenElse}),Module(function(t){return t.OR=function(e){e=this.defaultArg(e,2),t.call(this,e,0),this._sum=this.context.createGain(),this._gtz=this.output=new t.GreaterThanZero;for(var n=0;e>n;n++)this.input[n]=this._sum;this._sum.connect(this._gtz)},t.extend(t.OR,t.SignalBase),t.OR.prototype.dispose=function(){return t.prototype.dispose.call(this),this._gtz.dispose(),this._gtz=null,this._sum.disconnect(),this._sum=null,this},t.OR}),Module(function(t){return t.AND=function(e){e=this.defaultArg(e,2),t.call(this,e,0),this._equals=this.output=new t.Equal(e);for(var n=0;e>n;n++)this.input[n]=this._equals},t.extend(t.AND,t.SignalBase),t.AND.prototype.dispose=function(){return t.prototype.dispose.call(this),this._equals.dispose(),this._equals=null,this},t.AND}),Module(function(t){return t.NOT=t.EqualZero,t.NOT}),Module(function(t){return t.GreaterThan=function(e){t.call(this,2,0),this._value=this.input[0]=new t.Subtract(e),this.input[1]=this._value.input[1],this._gtz=this.output=new t.GreaterThanZero,this._value.connect(this._gtz)},t.extend(t.GreaterThan,t.Signal),t.GreaterThan.prototype.dispose=function(){return t.prototype.dispose.call(this),this._value.dispose(),this._value=null,this._gtz.dispose(),this._gtz=null,this},t.GreaterThan}),Module(function(t){return t.LessThan=function(e){t.call(this,2,0),this._neg=this.input[0]=new t.Negate,this._gt=this.output=new t.GreaterThan,this._rhNeg=new t.Negate,this._value=this.input[1]=new t.Signal(e),this._neg.connect(this._gt),this._value.connect(this._rhNeg),this._rhNeg.connect(this._gt,0,1)},t.extend(t.LessThan,t.Signal),t.LessThan.prototype.dispose=function(){return t.prototype.dispose.call(this),this._neg.dispose(),this._neg=null,this._gt.dispose(),this._gt=null,this._rhNeg.dispose(),this._rhNeg=null,this._value.dispose(),this._value=null,this},t.LessThan}),Module(function(t){return t.Abs=function(){t.call(this,1,0),this._ltz=new t.LessThan(0),this._switch=this.output=new t.Select(2),this._negate=new t.Negate,this.input.connect(this._switch,0,0),this.input.connect(this._negate),this._negate.connect(this._switch,0,1),this.input.chain(this._ltz,this._switch.gate)},t.extend(t.Abs,t.SignalBase),t.Abs.prototype.dispose=function(){return t.prototype.dispose.call(this),this._switch.dispose(),this._switch=null,this._ltz.dispose(),this._ltz=null,this._negate.dispose(),this._negate=null,this},t.Abs}),Module(function(t){return t.Max=function(e){t.call(this,2,0),this.input[0]=this.context.createGain(),this._value=this.input[1]=new t.Signal(e),this._ifThenElse=this.output=new t.IfThenElse,this._gt=new t.GreaterThan,this.input[0].chain(this._gt,this._ifThenElse["if"]),this.input[0].connect(this._ifThenElse.then),this._value.connect(this._ifThenElse["else"]),this._value.connect(this._gt,0,1)},t.extend(t.Max,t.Signal),t.Max.prototype.dispose=function(){return t.prototype.dispose.call(this),this._value.dispose(),this._ifThenElse.dispose(),this._gt.dispose(),this._value=null,this._ifThenElse=null,this._gt=null,this},t.Max}),Module(function(t){return t.Min=function(e){t.call(this,2,0),this.input[0]=this.context.createGain(),this._ifThenElse=this.output=new t.IfThenElse,this._lt=new t.LessThan,this._value=this.input[1]=new t.Signal(e),this.input[0].chain(this._lt,this._ifThenElse["if"]),this.input[0].connect(this._ifThenElse.then),this._value.connect(this._ifThenElse["else"]),this._value.connect(this._lt,0,1)},t.extend(t.Min,t.Signal),t.Min.prototype.dispose=function(){return t.prototype.dispose.call(this),this._value.dispose(),this._ifThenElse.dispose(),this._lt.dispose(),this._value=null,this._ifThenElse=null,this._lt=null,this},t.Min}),Module(function(t){return t.Modulo=function(e){t.call(this,1,1),this._shaper=new t.WaveShaper(Math.pow(2,16)),this._multiply=new t.Multiply,this._subtract=this.output=new t.Subtract,this._modSignal=new t.Signal(e),this.input.fan(this._shaper,this._subtract),this._modSignal.connect(this._multiply,0,0),this._shaper.connect(this._multiply,0,1),this._multiply.connect(this._subtract,0,1),this._setWaveShaper(e)},t.extend(t.Modulo,t.SignalBase),t.Modulo.prototype._setWaveShaper=function(t){this._shaper.setMap(function(e){var n=Math.floor((e+1e-4)/t);return n})},Object.defineProperty(t.Modulo.prototype,"value",{get:function(){return this._modSignal.value},set:function(t){
this._modSignal.value=t,this._setWaveShaper(t)}}),t.Modulo.prototype.dispose=function(){return t.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this._multiply.dispose(),this._multiply=null,this._subtract.dispose(),this._subtract=null,this._modSignal.dispose(),this._modSignal=null,this},t.Modulo}),Module(function(t){function e(t,e,n){var i=new t;return n._eval(e[0]).connect(i,0,0),n._eval(e[1]).connect(i,0,1),i}function n(t,e,n){var i=new t;return n._eval(e[0]).connect(i,0,0),i}function i(t){return t?parseFloat(t):void 0}function r(t){return t&&t.args?parseFloat(t.args):void 0}return t.Expr=function(){var t=this._replacements(Array.prototype.slice.call(arguments)),e=this._parseInputs(t);this._nodes=[],this.input=new Array(e);for(var n=0;e>n;n++)this.input[n]=this.context.createGain();var i,r=this._parseTree(t);try{i=this._eval(r)}catch(o){throw this._disposeNodes(),new Error("Could evaluate expression: "+t)}this.output=i},t.extend(t.Expr,t.SignalBase),t.Expr._Expressions={value:{signal:{regexp:/^\d+\.\d+|^\d+/,method:function(e){var n=new t.Signal(i(e));return n}},input:{regexp:/^\$\d/,method:function(t,e){return e.input[i(t.substr(1))]}}},glue:{"(":{regexp:/^\(/},")":{regexp:/^\)/},",":{regexp:/^,/}},func:{abs:{regexp:/^abs/,method:n.bind(this,t.Abs)},min:{regexp:/^min/,method:e.bind(this,t.Min)},max:{regexp:/^max/,method:e.bind(this,t.Max)},"if":{regexp:/^if/,method:function(e,n){var i=new t.IfThenElse;return n._eval(e[0]).connect(i["if"]),n._eval(e[1]).connect(i.then),n._eval(e[2]).connect(i["else"]),i}},gt0:{regexp:/^gt0/,method:n.bind(this,t.GreaterThanZero)},eq0:{regexp:/^eq0/,method:n.bind(this,t.EqualZero)},mod:{regexp:/^mod/,method:function(e,n){var i=r(e[1]),o=new t.Modulo(i);return n._eval(e[0]).connect(o),o}},pow:{regexp:/^pow/,method:function(e,n){var i=r(e[1]),o=new t.Pow(i);return n._eval(e[0]).connect(o),o}}},binary:{"+":{regexp:/^\+/,precedence:1,method:e.bind(this,t.Add)},"-":{regexp:/^\-/,precedence:1,method:function(i,r){return 1===i.length?n(t.Negate,i,r):e(t.Subtract,i,r)}},"*":{regexp:/^\*/,precedence:0,method:e.bind(this,t.Multiply)},">":{regexp:/^\>/,precedence:2,method:e.bind(this,t.GreaterThan)},"<":{regexp:/^</,precedence:2,method:e.bind(this,t.LessThan)},"==":{regexp:/^==/,precedence:3,method:e.bind(this,t.Equal)},"&&":{regexp:/^&&/,precedence:4,method:e.bind(this,t.AND)},"||":{regexp:/^\|\|/,precedence:5,method:e.bind(this,t.OR)}},unary:{"-":{regexp:/^\-/,method:n.bind(this,t.Negate)},"!":{regexp:/^\!/,method:n.bind(this,t.NOT)}}},t.Expr.prototype._parseInputs=function(t){var e=t.match(/\$\d/g),n=0;if(null!==e)for(var i=0;i<e.length;i++){var r=parseInt(e[i].substr(1))+1;n=Math.max(n,r)}return n},t.Expr.prototype._replacements=function(t){for(var e=t.shift(),n=0;n<t.length;n++)e=e.replace(/\%/i,t[n]);return e},t.Expr.prototype._tokenize=function(e){function n(e){for(var n in t.Expr._Expressions){var i=t.Expr._Expressions[n];for(var r in i){var o=i[r],s=o.regexp,a=e.match(s);if(null!==a)return{type:n,value:a[0],method:o.method}}}throw new SyntaxError("Unexpected token "+e)}for(var i=-1,r=[];e.length>0;){e=e.trim();var o=n(e);r.push(o),e=e.substr(o.value.length)}return{next:function(){return r[++i]},peek:function(){return r[i+1]}}},t.Expr.prototype._parseTree=function(e){function n(t,e){return!c(t)&&"glue"===t.type&&t.value===e}function i(e,n,i){var r=!1,o=t.Expr._Expressions[n];if(!c(e))for(var s in o){var a=o[s];if(a.regexp.test(e.value)){if(c(i))return!0;if(a.precedence===i)return!0}}return r}function r(t){c(t)&&(t=5);var e;e=0>t?o():r(t-1);for(var n=l.peek();i(n,"binary",t);)n=l.next(),e={operator:n.value,method:n.method,args:[e,r(t)]},n=l.peek();return e}function o(){var t,e;return t=l.peek(),i(t,"unary")?(t=l.next(),e=o(),{operator:t.value,method:t.method,args:[e]}):s()}function s(){var t,e;if(t=l.peek(),c(t))throw new SyntaxError("Unexpected termination of expression");if("func"===t.type)return t=l.next(),a(t);if("value"===t.type)return t=l.next(),{method:t.method,args:t.value};if(n(t,"(")){if(l.next(),e=r(),t=l.next(),!n(t,")"))throw new SyntaxError("Expected )");return e}throw new SyntaxError("Parse error, cannot process token "+t.value)}function a(t){var e,i=[];if(e=l.next(),!n(e,"("))throw new SyntaxError('Expected ( in a function call "'+t.value+'"');if(e=l.peek(),n(e,")")||(i=u()),e=l.next(),!n(e,")"))throw new SyntaxError('Expected ) in a function call "'+t.value+'"');return{method:t.method,args:i,name:name}}function u(){for(var t,e,i=[];;){if(e=r(),c(e))break;if(i.push(e),t=l.peek(),!n(t,","))break;l.next()}return i}var l=this._tokenize(e),c=this.isUndef.bind(this);return r()},t.Expr.prototype._eval=function(t){if(!this.isUndef(t)){var e=t.method(t.args,this);return this._nodes.push(e),e}},t.Expr.prototype._disposeNodes=function(){for(var t=0;t<this._nodes.length;t++){var e=this._nodes[t];this.isFunction(e.dispose)?e.dispose():this.isFunction(e.disconnect)&&e.disconnect(),e=null,this._nodes[t]=null}this._nodes=null},t.Expr.prototype.dispose=function(){t.prototype.dispose.call(this),this._disposeNodes()},t.Expr}),Module(function(t){return t.EqualPowerGain=function(){this._eqPower=this.input=this.output=new t.WaveShaper(function(t){return Math.abs(t)<.001?0:this.equalPowerScale(t)}.bind(this),4096)},t.extend(t.EqualPowerGain,t.SignalBase),t.EqualPowerGain.prototype.dispose=function(){return t.prototype.dispose.call(this),this._eqPower.dispose(),this._eqPower=null,this},t.EqualPowerGain}),Module(function(t){return t.CrossFade=function(e){t.call(this,2,1),this.a=this.input[0]=this.context.createGain(),this.b=this.input[1]=this.context.createGain(),this.fade=new t.Signal(this.defaultArg(e,.5),t.Type.NormalRange),this._equalPowerA=new t.EqualPowerGain,this._equalPowerB=new t.EqualPowerGain,this._invert=new t.Expr("1 - $0"),this.a.connect(this.output),this.b.connect(this.output),this.fade.chain(this._equalPowerB,this.b.gain),this.fade.chain(this._invert,this._equalPowerA,this.a.gain),this._readOnly("fade")},t.extend(t.CrossFade),t.CrossFade.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable("fade"),this._equalPowerA.dispose(),this._equalPowerA=null,this._equalPowerB.dispose(),this._equalPowerB=null,this.fade.dispose(),this.fade=null,this._invert.dispose(),this._invert=null,this.a.disconnect(),this.a=null,this.b.disconnect(),this.b=null,this},t.CrossFade}),Module(function(t){return t.Filter=function(){t.call(this);var e=this.optionsObject(arguments,["frequency","type","rolloff"],t.Filter.defaults);this._filters=[],this.frequency=new t.Signal(e.frequency,t.Type.Frequency),this.detune=new t.Signal(0,t.Type.Cents),this.gain=new t.Signal({value:e.gain,units:t.Type.Decibels,convert:!1}),this.Q=new t.Signal(e.Q),this._type=e.type,this._rolloff=e.rolloff,this.rolloff=e.rolloff,this._readOnly(["detune","frequency","gain","Q"])},t.extend(t.Filter),t.Filter.defaults={type:"lowpass",frequency:350,rolloff:-12,Q:1,gain:0},Object.defineProperty(t.Filter.prototype,"type",{get:function(){return this._type},set:function(t){var e=["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"];if(-1===e.indexOf(t))throw new TypeError("Tone.Filter does not have filter type "+t);this._type=t;for(var n=0;n<this._filters.length;n++)this._filters[n].type=t}}),Object.defineProperty(t.Filter.prototype,"rolloff",{get:function(){return this._rolloff},set:function(t){var e=[-12,-24,-48],n=e.indexOf(t);if(-1===n)throw new RangeError("Filter rolloff can only be -12, -24, or -48");n++,this._rolloff=t,this.input.disconnect();for(var i=0;i<this._filters.length;i++)this._filters[i].disconnect(),this._filters[i]=null;this._filters=new Array(n);for(var r=0;n>r;r++){var o=this.context.createBiquadFilter();o.type=this._type,this.frequency.connect(o.frequency),this.detune.connect(o.detune),this.Q.connect(o.Q),this.gain.connect(o.gain),this._filters[r]=o}var s=[this.input].concat(this._filters).concat([this.output]);this.connectSeries.apply(this,s)}}),t.Filter.prototype.dispose=function(){t.prototype.dispose.call(this);for(var e=0;e<this._filters.length;e++)this._filters[e].disconnect(),this._filters[e]=null;return this._filters=null,this._writable(["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.frequency=null,this.Q=null,this.detune.dispose(),this.detune=null,this.gain.dispose(),this.gain=null,this},t.Filter}),Module(function(t){return t.MultibandSplit=function(){var e=this.optionsObject(arguments,["lowFrequency","highFrequency"],t.MultibandSplit.defaults);this.input=this.context.createGain(),this.output=new Array(3),this.low=this.output[0]=new t.Filter(0,"lowpass"),this._lowMidFilter=new t.Filter(0,"highpass"),this.mid=this.output[1]=new t.Filter(0,"lowpass"),this.high=this.output[2]=new t.Filter(0,"highpass"),this.lowFrequency=new t.Signal(e.lowFrequency,t.Type.Frequency),this.highFrequency=new t.Signal(e.highFrequency,t.Type.Frequency),this.Q=new t.Signal(e.Q),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.connect(this.low.frequency),this.lowFrequency.connect(this._lowMidFilter.frequency),this.highFrequency.connect(this.mid.frequency),this.highFrequency.connect(this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),this._readOnly(["high","mid","low","highFrequency","lowFrequency"])},t.extend(t.MultibandSplit),t.MultibandSplit.defaults={lowFrequency:400,highFrequency:2500,Q:1},t.MultibandSplit.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable(["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this.low=null,this._lowMidFilter.dispose(),this._lowMidFilter=null,this.mid.dispose(),this.mid=null,this.high.dispose(),this.high=null,this.lowFrequency.dispose(),this.lowFrequency=null,this.highFrequency.dispose(),this.highFrequency=null,this.Q.dispose(),this.Q=null,this},t.MultibandSplit}),Module(function(t){return t.EQ3=function(){var e=this.optionsObject(arguments,["low","mid","high"],t.EQ3.defaults);this.output=this.context.createGain(),this._multibandSplit=this.input=new t.MultibandSplit({lowFrequency:e.lowFrequency,highFrequency:e.highFrequency}),this._lowGain=this.context.createGain(),this._midGain=this.context.createGain(),this._highGain=this.context.createGain(),this.low=new t.Signal(this._lowGain.gain,t.Type.Decibels),this.mid=new t.Signal(this._midGain.gain,t.Type.Decibels),this.high=new t.Signal(this._highGain.gain,t.Type.Decibels),this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),this.low.value=e.low,this.mid.value=e.mid,this.high.value=e.high,this._readOnly(["low","mid","high","lowFrequency","highFrequency"])},t.extend(t.EQ3),t.EQ3.defaults={low:0,mid:0,high:0,lowFrequency:400,highFrequency:2500},t.EQ3.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable(["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this._multibandSplit=null,this.lowFrequency=null,this.highFrequency=null,this._lowGain.disconnect(),this._lowGain=null,this._midGain.disconnect(),this._midGain=null,this._highGain.disconnect(),this._highGain=null,this.low.dispose(),this.low=null,this.mid.dispose(),this.mid=null,this.high.dispose(),this.high=null,this.Q=null,this},t.EQ3}),Module(function(t){return t.Scale=function(e,n){this._outputMin=this.defaultArg(e,0),this._outputMax=this.defaultArg(n,1),this._scale=this.input=new t.Multiply(1),this._add=this.output=new t.Add(0),this._scale.connect(this._add),this._setRange()},t.extend(t.Scale,t.SignalBase),Object.defineProperty(t.Scale.prototype,"min",{get:function(){return this._outputMin},set:function(t){this._outputMin=t,this._setRange()}}),Object.defineProperty(t.Scale.prototype,"max",{get:function(){return this._outputMax},set:function(t){this._outputMax=t,this._setRange()}}),t.Scale.prototype._setRange=function(){this._add.value=this._outputMin,this._scale.value=this._outputMax-this._outputMin},t.Scale.prototype.dispose=function(){return t.prototype.dispose.call(this),this._add.dispose(),this._add=null,this._scale.dispose(),this._scale=null,this},t.Scale}),Module(function(t){return t.ScaleExp=function(e,n,i){this._scale=this.output=new t.Scale(e,n),this._exp=this.input=new t.Pow(this.defaultArg(i,2)),this._exp.connect(this._scale)},t.extend(t.ScaleExp,t.SignalBase),Object.defineProperty(t.ScaleExp.prototype,"exponent",{get:function(){return this._exp.value},set:function(t){this._exp.value=t}}),Object.defineProperty(t.ScaleExp.prototype,"min",{get:function(){return this._scale.min},set:function(t){this._scale.min=t}}),Object.defineProperty(t.ScaleExp.prototype,"max",{get:function(){return this._scale.max},set:function(t){this._scale.max=t}}),t.ScaleExp.prototype.dispose=function(){return t.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._exp.dispose(),this._exp=null,this},t.ScaleExp}),Module(function(t){return t.FeedbackCombFilter=function(){t.call(this);var e=this.optionsObject(arguments,["delayTime","resonance"],t.FeedbackCombFilter.defaults);this.resonance=new t.Signal(e.resonance,t.Type.NormalRange),this._delay=this.input=this.output=this.context.createDelay(1),this.delayTime=new t.Signal(e.delayTime,t.Type.Time),this._feedback=this.context.createGain(),this._delay.chain(this._feedback,this._delay),this.resonance.connect(this._feedback.gain),this.delayTime.connect(this._delay.delayTime),this._readOnly(["resonance","delayTime"])},t.extend(t.FeedbackCombFilter),t.FeedbackCombFilter.defaults={delayTime:.1,resonance:.5},t.FeedbackCombFilter.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable(["resonance","delayTime"]),this._delay.disconnect(),this._delay=null,this.delayTime.dispose(),this.delayTime=null,this.resonance.dispose(),this.resonance=null,this._feedback.disconnect(),this._feedback=null,this},t.FeedbackCombFilter}),Module(function(t){return t.Follower=function(){t.call(this);var e=this.optionsObject(arguments,["attack","release"],t.Follower.defaults);this._abs=new t.Abs,this._filter=this.context.createBiquadFilter(),this._filter.type="lowpass",this._filter.frequency.value=0,this._filter.Q.value=-100,this._frequencyValues=new t.WaveShaper,this._sub=new t.Subtract,this._delay=this.context.createDelay(),this._delay.delayTime.value=this.bufferTime,this._mult=new t.Multiply(1e4),this._attack=e.attack,this._release=e.release,this.input.chain(this._abs,this._filter,this.output),this._abs.connect(this._sub,0,1),this._filter.chain(this._delay,this._sub),this._sub.chain(this._mult,this._frequencyValues,this._filter.frequency),this._setAttackRelease(this._attack,this._release)},t.extend(t.Follower),t.Follower.defaults={attack:.05,release:.5},t.Follower.prototype._setAttackRelease=function(t,e){var n=this.bufferTime;t=this.secondsToFrequency(this.toSeconds(t)),e=this.secondsToFrequency(this.toSeconds(e)),t=Math.max(t,n),e=Math.max(e,n),this._frequencyValues.setMap(function(n){return 0>=n?t:e})},Object.defineProperty(t.Follower.prototype,"attack",{get:function(){return this._attack},set:function(t){this._attack=t,this._setAttackRelease(this._attack,this._release)}}),Object.defineProperty(t.Follower.prototype,"release",{get:function(){return this._release},set:function(t){this._release=t,this._setAttackRelease(this._attack,this._release)}}),t.Follower.prototype.connect=t.Signal.prototype.connect,t.Follower.prototype.dispose=function(){return t.prototype.dispose.call(this),this._filter.disconnect(),this._filter=null,this._frequencyValues.disconnect(),this._frequencyValues=null,this._delay.disconnect(),this._delay=null,this._sub.disconnect(),this._sub=null,this._abs.dispose(),this._abs=null,this._mult.dispose(),this._mult=null,this._curve=null,this},t.Follower}),Module(function(t){return t.Gate=function(){t.call(this);var e=this.optionsObject(arguments,["threshold","attack","release"],t.Gate.defaults);this._follower=new t.Follower(e.attack,e.release),this._gt=new t.GreaterThan(this.dbToGain(e.threshold)),this.input.connect(this.output),this.input.chain(this._gt,this._follower,this.output.gain)},t.extend(t.Gate),t.Gate.defaults={attack:.1,release:.1,threshold:-40},Object.defineProperty(t.Gate.prototype,"threshold",{get:function(){return this.gainToDb(this._gt.value)},set:function(t){this._gt.value=this.dbToGain(t)}}),Object.defineProperty(t.Gate.prototype,"attack",{get:function(){return this._follower.attack},set:function(t){this._follower.attack=t}}),Object.defineProperty(t.Gate.prototype,"release",{get:function(){return this._follower.release},set:function(t){this._follower.release=t}}),t.Gate.prototype.dispose=function(){return t.prototype.dispose.call(this),this._follower.dispose(),this._gt.dispose(),this._follower=null,this._gt=null,this},t.Gate}),Module(function(t){return t.Clock=function(e,n){this._oscillator=null,this._jsNode=this.context.createScriptProcessor(this.bufferSize,1,1),this._jsNode.onaudioprocess=this._processBuffer.bind(this),this.frequency=new t.Signal(e,t.Type.Frequency),this._upTick=!1,this.tick=n,this.onended=t.noOp,this._jsNode.noGC()},t.extend(t.Clock),t.Clock.prototype.start=function(t){if(!this._oscillator){this._oscillator=this.context.createOscillator(),this._oscillator.type="square",this._oscillator.connect(this._jsNode),this.frequency.connect(this._oscillator.frequency),this._upTick=!1;var e=this.toSeconds(t);this._oscillator.start(e)}return this},t.Clock.prototype.stop=function(t){if(this._oscillator){var e=this.now(),n=this.toSeconds(t,e);this._oscillator.stop(n),this._oscillator=null,t?setTimeout(this.onended,1e3*(n-e)):this.onended()}return this},t.Clock.prototype._processBuffer=function(t){for(var e=this.defaultArg(t.playbackTime,this.now()),n=this._jsNode.bufferSize,i=t.inputBuffer.getChannelData(0),r=this._upTick,o=this,s=0;n>s;s++){var a=i[s];a>0&&!r?(r=!0,setTimeout(function(){var t=e+o.samplesToSeconds(s+2*n);return function(){o.tick&&o.tick(t)}}(),0)):0>a&&r&&(r=!1)}this._upTick=r},t.Clock.prototype.dispose=function(){return this._jsNode.disconnect(),this.frequency.dispose(),this.frequency=null,this._oscillator&&(this._oscillator.disconnect(),this._oscillator=null),this._jsNode.onaudioprocess=t.noOp,this._jsNode=null,this.tick=null,this.onended=t.noOp,this},t.Clock}),Module(function(Tone){Tone.Transport=function(){this._clock=new Tone.Clock(0,this._processTick.bind(this)),this._clock.onended=this._onended.bind(this),this.loop=!1,this.bpm=new Tone.Signal(120,Tone.Type.BPM),this._bpmMult=new Tone.Multiply(1/60*tatum),this.state=Tone.State.Stopped,this.bpm.chain(this._bpmMult,this._clock.frequency)},Tone.extend(Tone.Transport),Tone.Transport.defaults={bpm:120,swing:0,swingSubdivision:"16n",timeSignature:4,loopStart:0,loopEnd:"4m"};var tatum=12,timelineTicks=0,transportTicks=0,swingSubdivision="16n",swingTatum=3,swingAmount=0,transportTimeSignature=4,loopStart=0,loopEnd=4*tatum,intervals=[],timeouts=[],transportTimeline=[],timelineProgress=0,SyncedSources=[],SyncedSignals=[];Tone.Transport.prototype._processTick=function(t){this.state===Tone.State.Started&&(swingAmount>0&&timelineTicks%tatum!==0&&timelineTicks%swingTatum===0&&(t+=this._ticksToSeconds(swingTatum)*swingAmount),processIntervals(t),processTimeouts(t),processTimeline(t),transportTicks+=1,timelineTicks+=1,this.loop&&timelineTicks===loopEnd&&this._setTicks(loopStart))},Tone.Transport.prototype._setTicks=function(t){timelineTicks=t;for(var e=0;e<transportTimeline.length;e++){var n=transportTimeline[e];if(n.callbackTick()>=t){timelineProgress=e;break}}};var processIntervals=function(t){for(var e=0,n=intervals.length;n>e;e++){var i=intervals[e];i.testInterval(transportTicks)&&i.doCallback(t)}},processTimeouts=function(t){for(var e=0,n=0,i=timeouts.length;i>n;n++){var r=timeouts[n],o=r.callbackTick();if(transportTicks>=o)r.doCallback(t),e++;else if(o>transportTicks)break}timeouts.splice(0,e)},processTimeline=function(t){for(var e=timelineProgress,n=transportTimeline.length;n>e;e++){var i=transportTimeline[e],r=i.callbackTick();if(r===timelineTicks)timelineProgress=e,i.doCallback(t);else if(r>timelineTicks)break}};Tone.Transport.prototype.setInterval=function(t,e,n){var i=this._toTicks(e),r=new TimelineEvent(t,n,i,transportTicks);return intervals.push(r),r.id},Tone.Transport.prototype.clearInterval=function(t){for(var e=0;e<intervals.length;e++){var n=intervals[e];if(n.id===t)return intervals.splice(e,1),!0}return!1},Tone.Transport.prototype.clearIntervals=function(){var t=intervals.length>0;return intervals=[],t},Tone.Transport.prototype.setTimeout=function(t,e,n){for(var i=this._toTicks(e),r=new TimelineEvent(t,n,i+transportTicks,0),o=0,s=timeouts.length;s>o;o++){var a=timeouts[o];if(a.callbackTick()>r.callbackTick())return timeouts.splice(o,0,r),r.id}return timeouts.push(r),r.id},Tone.Transport.prototype.clearTimeout=function(t){for(var e=0;e<timeouts.length;e++){var n=timeouts[e];if(n.id===t)return timeouts.splice(e,1),!0}return!1},Tone.Transport.prototype.clearTimeouts=function(){var t=timeouts.length>0;return timeouts=[],t},Tone.Transport.prototype.setTimeline=function(t,e,n){for(var i=this._toTicks(e),r=new TimelineEvent(t,n,i,0),o=timelineProgress,s=transportTimeline.length;s>o;o++){var a=transportTimeline[o];if(a.callbackTick()>r.callbackTick())return transportTimeline.splice(o,0,r),r.id}return transportTimeline.push(r),r.id},Tone.Transport.prototype.clearTimeline=function(t){for(var e=0;e<transportTimeline.length;e++){var n=transportTimeline[e];if(n.id===t)return transportTimeline.splice(e,1),!0}return!1},Tone.Transport.prototype.clearTimelines=function(){timelineProgress=0;var t=transportTimeline.length>0;return transportTimeline=[],t},Tone.Transport.prototype._toTicks=function(t){var e=this.toSeconds(t),n=this.notationToSeconds("4n"),i=e/n,r=i*tatum;return Math.round(r)},Tone.Transport.prototype._ticksToSeconds=function(t,e,n){t=Math.floor(t);var i=this.notationToSeconds("4n",e,n);return i*t/tatum},Tone.Transport.prototype.nextBeat=function(t){t=this.defaultArg(t,"4n");var e=this._toTicks(t),n=transportTicks%e,i=n;return n>0&&(i=e-n),this._ticksToSeconds(i)},Tone.Transport.prototype.start=function(t,e){if(this.state===Tone.State.Stopped||this.state===Tone.State.Paused){this.isUndef(e)||this._setTicks(this._toTicks(e)),this.state=Tone.State.Started;var n=this.toSeconds(t);this._clock.start(n);for(var i=0;i<SyncedSources.length;i++){var r=SyncedSources[i].source,o=SyncedSources[i].delay;r.start(n+o)}}return this},Tone.Transport.prototype.stop=function(t){if(this.state===Tone.State.Started||this.state===Tone.State.Paused){var e=this.toSeconds(t);this._clock.stop(e);for(var n=0;n<SyncedSources.length;n++){var i=SyncedSources[n].source;i.stop(e)}}else this._onended();return this},Tone.Transport.prototype._onended=function(){transportTicks=0,this._setTicks(0),this.clearTimeouts(),this.state=Tone.State.Stopped},Tone.Transport.prototype.pause=function(t){if(this.state===Tone.State.Started){this.state=Tone.State.Paused;var e=this.toSeconds(t);this._clock.stop(e);for(var n=0;n<SyncedSources.length;n++){var i=SyncedSources[n].source;i.pause(e)}}return this},Object.defineProperty(Tone.Transport.prototype,"timeSignature",{get:function(){return transportTimeSignature},set:function(t){transportTimeSignature=t}}),Object.defineProperty(Tone.Transport.prototype,"loopStart",{get:function(){return this._ticksToSeconds(loopStart)},set:function(t){loopStart=this._toTicks(t)}}),Object.defineProperty(Tone.Transport.prototype,"loopEnd",{get:function(){return this._ticksToSeconds(loopEnd)},set:function(t){loopEnd=this._toTicks(t)}}),Tone.Transport.prototype.setLoopPoints=function(t,e){return this.loopStart=t,this.loopEnd=e,this},Object.defineProperty(Tone.Transport.prototype,"swing",{get:function(){return 2*swingAmount},set:function(t){swingAmount=.5*t}}),Object.defineProperty(Tone.Transport.prototype,"swingSubdivision",{get:function(){return swingSubdivision},set:function(t){swingSubdivision=t,swingTatum=this._toTicks(t)}}),Object.defineProperty(Tone.Transport.prototype,"position",{get:function(){var t=timelineTicks/tatum,e=Math.floor(t/transportTimeSignature),n=Math.floor(t%1*4);t=Math.floor(t)%transportTimeSignature;var i=[e,t,n];return i.join(":")},set:function(t){var e=this._toTicks(t);this._setTicks(e)}}),Tone.Transport.prototype.syncSource=function(t,e){return SyncedSources.push({source:t,delay:this.toSeconds(this.defaultArg(e,0))}),this},Tone.Transport.prototype.unsyncSource=function(t){for(var e=0;e<SyncedSources.length;e++)SyncedSources[e].source===t&&SyncedSources.splice(e,1);return this},Tone.Transport.prototype.syncSignal=function(t,e){e||(e=0!==t._value.value?t._value.value/this.bpm.value:0);var n=this.context.createGain();return n.gain.value=e,this.bpm.chain(n,t._value),SyncedSignals.push({ratio:n,signal:t,initial:t._value.value}),t._value.value=0,this},Tone.Transport.prototype.unsyncSignal=function(t){for(var e=0;e<SyncedSignals.length;e++){var n=SyncedSignals[e];n.signal===t&&(n.ratio.disconnect(),n.signal._value.value=n.initial,SyncedSignals.splice(e,1))}return this},Tone.Transport.prototype.dispose=function(){return this._clock.dispose(),this._clock=null,this.bpm.dispose(),this.bpm=null,this._bpmMult.dispose(),this._bpmMult=null,this};var TimelineEventIDCounter=0,TimelineEvent=function(t,e,n,i){this.startTicks=i,this.tickTime=n,this.callback=t,this.context=e,this.id=TimelineEventIDCounter++};TimelineEvent.prototype.doCallback=function(t){this.callback.call(this.context,t)},TimelineEvent.prototype.callbackTick=function(){return this.startTicks+this.tickTime},TimelineEvent.prototype.testInterval=function(t){return(t-this.startTicks)%this.tickTime===0},Tone.prototype.isNotation=function(){var t=new RegExp(/[0-9]+[mnt]$/i);return function(e){return t.test(e)}}(),Tone.prototype.isTransportTime=function(){var t=new RegExp(/^\d+(\.\d+)?:\d+(\.\d+)?(:\d+(\.\d+)?)?$/i);return function(e){return t.test(e)}}(),Tone.prototype.notationToSeconds=function(t,e,n){e=this.defaultArg(e,Tone.Transport.bpm.value),n=this.defaultArg(n,transportTimeSignature);var i=60/e,r=parseInt(t,10),o=0;0===r&&(o=0);var s=t.slice(-1);return o="t"===s?4/r*2/3:"n"===s?4/r:"m"===s?r*n:0,i*o},Tone.prototype.transportTimeToSeconds=function(t,e,n){e=this.defaultArg(e,Tone.Transport.bpm.value),n=this.defaultArg(n,transportTimeSignature);var i=0,r=0,o=0,s=t.split(":");2===s.length?(i=parseFloat(s[0]),r=parseFloat(s[1])):1===s.length?r=parseFloat(s[0]):3===s.length&&(i=parseFloat(s[0]),r=parseFloat(s[1]),o=parseFloat(s[2]));var a=i*n+r+o/4;return a*this.notationToSeconds("4n")},Tone.prototype.toTransportTime=function(t,e,n){var i=this.toSeconds(t,e,n);e=this.defaultArg(e,Tone.Transport.bpm.value),n=this.defaultArg(n,transportTimeSignature);var r=this.notationToSeconds("4n"),o=i/r,s=Math.floor(o/n),a=Math.floor(o%1*4);o=Math.floor(o)%n;var u=[s,o,a];return u.join(":")},Tone.prototype.toFrequency=function(t,e){return this.isFrequency(t)?parseFloat(t):this.isNotation(t)||this.isTransportTime(t)?this.secondsToFrequency(this.toSeconds(t,e)):t},Tone.prototype.toSeconds=function(time,now){if(now=this.defaultArg(now,this.now()),"number"==typeof time)return time;if("string"==typeof time){var plusTime=0;"+"===time.charAt(0)&&(plusTime=now,time=time.slice(1));var components=time.split(/[\(\)\-\+\/\*]/);if(components.length>1){for(var originalTime=time,i=0;i<components.length;i++){var symb=components[i].trim();if(""!==symb){var val=this.toSeconds(symb);time=time.replace(symb,val)}}try{time=eval(time)}catch(e){throw new EvalError("problem evaluating Tone.Type.Time: "+originalTime)}}else time=this.isNotation(time)?this.notationToSeconds(time):this.isTransportTime(time)?this.transportTimeToSeconds(time):this.isFrequency(time)?this.frequencyToSeconds(time):parseFloat(time);return time+plusTime}return now};var TransportConstructor=Tone.Transport;return Tone._initAudioContext(function(){if("function"==typeof Tone.Transport)Tone.Transport=new Tone.Transport;else{Tone.Transport.stop();var t=Tone.Transport.bpm.value;Tone.Transport._clock.dispose(),TransportConstructor.call(Tone.Transport),Tone.Transport.bpm.value=t}}),Tone.Transport}),Module(function(t){t.Master=function(){t.call(this),this._unmutedVolume=1,this._muted=!1,this.volume=new t.Signal(this.output.gain,t.Type.Decibels),this.input.chain(this.output,this.context.destination)},t.extend(t.Master),t.Master.defaults={volume:0,mute:!1},Object.defineProperty(t.Master.prototype,"mute",{get:function(){return this._muted},set:function(t){!this._muted&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-(1/0)):this._muted&&!t&&(this.volume.value=this._unmutedVolume),this._muted=t}}),t.Master.prototype.chain=function(){this.input.disconnect(),this.input.chain.apply(this.input,arguments),arguments[arguments.length-1].connect(this.output)},t.prototype.toMaster=function(){return this.connect(t.Master),this},AudioNode.prototype.toMaster=function(){return this.connect(t.Master),this};var e=t.Master;return t._initAudioContext(function(){t.prototype.isUndef(t.Master)?(e.prototype.dispose.call(t.Master),e.call(t.Master)):t.Master=new e}),t.Master}),Module(function(t){return t.Source=function(e){t.call(this,0,1),e=this.defaultArg(e,t.Source.defaults),this.onended=e.onended,this._nextStart=1/0,this._nextStop=1/0,this.volume=new t.Signal({param:this.output.gain,value:e.volume,units:t.Type.Decibels}),this._readOnly("volume"),this._timeout=-1,this.output.channelCount=2,this.output.channelCountMode="explicit"},t.extend(t.Source),t.Source.defaults={onended:t.noOp,volume:0},Object.defineProperty(t.Source.prototype,"state",{get:function(){return this._stateAtTime(this.now())}}),t.Source.prototype._stateAtTime=function(e){return e=this.toSeconds(e),this._nextStart<=e&&this._nextStop>e?t.State.Started:this._nextStop<=e?t.State.Stopped:t.State.Stopped},t.Source.prototype.start=function(e){return e=this.toSeconds(e),(this._stateAtTime(e)!==t.State.Started||this.retrigger)&&(this._nextStart=e,this._nextStop=1/0,this._start.apply(this,arguments)),this},t.Source.prototype.stop=function(e){var n=this.now();if(e=this.toSeconds(e,n),this._stateAtTime(e)===t.State.Started){this._nextStop=this.toSeconds(e),clearTimeout(this._timeout);var i=e-n;i>0?this._timeout=setTimeout(this.onended,1e3*i+20):this.onended(),this._stop.apply(this,arguments)}return this},t.Source.prototype.pause=function(t){return this.stop(t),this},t.Source.prototype.sync=function(e){return t.Transport.syncSource(this,e),this},t.Source.prototype.unsync=function(){return t.Transport.unsyncSource(this),this},t.Source.prototype.dispose=function(){t.prototype.dispose.call(this),this.stop(),clearTimeout(this._timeout),this.onended=t.noOp,this._writable("volume"),this.volume.dispose(),this.volume=null},t.Source}),Module(function(t){return t.Oscillator=function(){var e=this.optionsObject(arguments,["frequency","type"],t.Oscillator.defaults);t.Source.call(this,e),this._oscillator=null,this.frequency=new t.Signal(e.frequency,t.Type.Frequency),this.detune=new t.Signal(e.detune,t.Type.Cents),this._wave=null,this._phase=e.phase,this._type=null,this.type=e.type,this.phase=this._phase,this._readOnly(["frequency","detune"])},t.extend(t.Oscillator,t.Source),t.Oscillator.defaults={type:"sine",frequency:440,detune:0,phase:0},t.Oscillator.prototype._start=function(t){this._oscillator=this.context.createOscillator(),this._oscillator.setPeriodicWave(this._wave),this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(this.toSeconds(t))},t.Oscillator.prototype._stop=function(t){return this._oscillator&&(this._oscillator.stop(this.toSeconds(t)),this._oscillator=null),this},t.Oscillator.prototype.syncFrequency=function(){
return t.Transport.syncSignal(this.frequency),this},t.Oscillator.prototype.unsyncFrequency=function(){return t.Transport.unsyncSignal(this.frequency),this},Object.defineProperty(t.Oscillator.prototype,"type",{get:function(){return this._type},set:function(t){var e=t,n=4096,i=n/2,r=new Float32Array(i),o=new Float32Array(i),s=1,a=/(sine|triangle|square|sawtooth)(\d+)$/.exec(t);a&&(s=parseInt(a[2]),t=a[1],s=Math.max(s,2),i=s);for(var u=this._phase,l=1;i>l;++l){var c,h=2/(l*Math.PI);switch(t){case"sine":c=s>=l?1:0;break;case"square":c=1&l?2*h:0;break;case"sawtooth":c=h*(1&l?1:-1);break;case"triangle":c=1&l?2*(h*h)*(l-1>>1&1?-1:1):0;break;default:throw new TypeError("invalid oscillator type: "+t)}0!==c?(r[l]=-c*Math.sin(u*l),o[l]=c*Math.cos(u*l)):(r[l]=0,o[l]=0)}var f=this.context.createPeriodicWave(r,o);this._wave=f,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),this._type=e}}),Object.defineProperty(t.Oscillator.prototype,"phase",{get:function(){return this._phase*(180/Math.PI)},set:function(t){this._phase=t*Math.PI/180,this.type=this._type}}),t.Oscillator.prototype.dispose=function(){return t.Source.prototype.dispose.call(this),null!==this._oscillator&&(this._oscillator.disconnect(),this._oscillator=null),this._wave=null,this._writable(["frequency","detune"]),this.frequency.dispose(),this.frequency=null,this.detune.dispose(),this.detune=null,this},t.Oscillator}),Module(function(t){return t.AudioToGain=function(){this._norm=this.input=this.output=new t.WaveShaper(function(t){return(t+1)/2})},t.extend(t.AudioToGain,t.SignalBase),t.AudioToGain.prototype.dispose=function(){return t.prototype.dispose.call(this),this._norm.dispose(),this._norm=null,this},t.AudioToGain}),Module(function(t){return t.LFO=function(){var e=this.optionsObject(arguments,["frequency","min","max"],t.LFO.defaults);this.oscillator=new t.Oscillator({frequency:e.frequency,type:e.type,phase:e.phase+90}),this.frequency=this.oscillator.frequency,this.amplitude=this.oscillator.volume,this.amplitude.units=t.Type.NormalRange,this.amplitude.value=e.amplitude,this._a2g=new t.AudioToGain,this._scaler=this.output=new t.Scale(e.min,e.max),this._units=t.Type.Default,this.oscillator.chain(this._a2g,this._scaler),this._readOnly(["amplitude","frequency","oscillator"])},t.extend(t.LFO,t.Oscillator),t.LFO.defaults={type:"sine",min:0,max:1,phase:0,frequency:"4n",amplitude:1},t.LFO.prototype.start=function(t){return this.oscillator.start(t),this},t.LFO.prototype.stop=function(t){return this.oscillator.stop(t),this},t.LFO.prototype.sync=function(t){return this.oscillator.sync(t),this.oscillator.syncFrequency(),this},t.LFO.prototype.unsync=function(){return this.oscillator.unsync(),this.oscillator.unsyncFrequency(),this},Object.defineProperty(t.LFO.prototype,"min",{get:function(){return this._toUnits(this._scaler.min)},set:function(t){t=this._fromUnits(t),this._scaler.min=t}}),Object.defineProperty(t.LFO.prototype,"max",{get:function(){return this._toUnits(this._scaler.max)},set:function(t){t=this._fromUnits(t),this._scaler.max=t}}),Object.defineProperty(t.LFO.prototype,"type",{get:function(){return this.oscillator.type},set:function(t){this.oscillator.type=t}}),Object.defineProperty(t.LFO.prototype,"phase",{get:function(){return this.oscillator.phase-90},set:function(t){this.oscillator.phase=t+90}}),Object.defineProperty(t.LFO.prototype,"units",{get:function(){return this._units},set:function(t){var e=this.min,n=this.max;this._units=t,this.min=e,this.max=n}}),t.LFO.prototype.connect=function(e){return e.constructor===t.Signal&&(this.convert=e.convert,this.units=e.units),t.Signal.prototype.connect.apply(this,arguments),this},t.LFO.prototype._fromUnits=t.Signal.prototype._fromUnits,t.LFO.prototype._toUnits=t.Signal.prototype._toUnits,t.LFO.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable(["amplitude","frequency","oscillator"]),this.oscillator.dispose(),this.oscillator=null,this._scaler.dispose(),this._scaler=null,this._a2g.dispose(),this._a2g=null,this.frequency=null,this.amplitude=null,this},t.LFO}),Module(function(t){return t.Limiter=function(e){this._compressor=this.input=this.output=new t.Compressor({attack:.001,decay:.001,threshold:e}),this.threshold=this._compressor.threshold,this._readOnly("threshold")},t.extend(t.Limiter),t.Limiter.prototype.dispose=function(){return t.prototype.dispose.call(this),this._compressor.dispose(),this._compressor=null,this._writable("threshold"),this.threshold=null,this},t.Limiter}),Module(function(t){return t.LowpassCombFilter=function(){t.call(this);var e=this.optionsObject(arguments,["delayTime","resonance","dampening"],t.LowpassCombFilter.defaults);this._delay=this.input=this.context.createDelay(1),this.delayTime=new t.Signal(e.delayTime,t.Type.Time),this._lowpass=this.output=this.context.createBiquadFilter(),this._lowpass.Q.value=0,this._lowpass.type="lowpass",this.dampening=new t.Signal(this._lowpass.frequency,t.Type.Frequency),this.dampening.value=e.dampening,this._feedback=this.context.createGain(),this.resonance=new t.Signal(e.resonance,t.Type.NormalRange),this._delay.chain(this._lowpass,this._feedback,this._delay),this.delayTime.connect(this._delay.delayTime),this.resonance.connect(this._feedback.gain),this.dampening.connect(this._lowpass.frequency),this._readOnly(["dampening","resonance","delayTime"])},t.extend(t.LowpassCombFilter),t.LowpassCombFilter.defaults={delayTime:.1,resonance:.5,dampening:3e3},t.LowpassCombFilter.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable(["dampening","resonance","delayTime"]),this.dampening.dispose(),this.dampening=null,this.resonance.dispose(),this.resonance=null,this._delay.disconnect(),this._delay=null,this._lowpass.disconnect(),this._lowpass=null,this._feedback.disconnect(),this._feedback=null,this.delayTime.dispose(),this.delayTime=null,this},t.LowpassCombFilter}),Module(function(t){return t.Merge=function(){t.call(this,2,0),this.left=this.input[0]=this.context.createGain(),this.right=this.input[1]=this.context.createGain(),this._merger=this.output=this.context.createChannelMerger(2),this.left.connect(this._merger,0,0),this.right.connect(this._merger,0,1)},t.extend(t.Merge),t.Merge.prototype.dispose=function(){return t.prototype.dispose.call(this),this.left.disconnect(),this.left=null,this.right.disconnect(),this.right=null,this._merger.disconnect(),this._merger=null,this},t.Merge}),Module(function(t){return t.Meter=function(e,n,i){t.call(this),this._channels=this.defaultArg(e,1),this._smoothing=this.defaultArg(n,.8),this._clipMemory=1e3*this.defaultArg(i,.5),this._volume=new Array(this._channels),this._values=new Array(this._channels);for(var r=0;r<this._channels;r++)this._volume[r]=0,this._values[r]=0;this._lastClip=0,this._jsNode=this.context.createScriptProcessor(this.bufferSize,this._channels,1),this._jsNode.onaudioprocess=this._onprocess.bind(this),this._jsNode.noGC(),this.input.connect(this.output),this.input.connect(this._jsNode)},t.extend(t.Meter),t.Meter.prototype._onprocess=function(t){for(var e=this._jsNode.bufferSize,n=this._smoothing,i=0;i<this._channels;i++){for(var r,o=t.inputBuffer.getChannelData(i),s=0,a=0,u=!1,l=0;e>l;l++)r=o[l],!u&&r>.95&&(u=!0,this._lastClip=Date.now()),a+=r,s+=r*r;var c=a/e,h=Math.sqrt(s/e);this._volume[i]=Math.max(h,this._volume[i]*n),this._values[i]=c}},t.Meter.prototype.getLevel=function(t){t=this.defaultArg(t,0);var e=this._volume[t];return 1e-5>e?0:e},t.Meter.prototype.getValue=function(t){return t=this.defaultArg(t,0),this._values[t]},t.Meter.prototype.getDb=function(t){return this.gainToDb(this.getLevel(t))},t.Meter.prototype.isClipped=function(){return Date.now()-this._lastClip<this._clipMemory},t.Meter.prototype.dispose=function(){return t.prototype.dispose.call(this),this._jsNode.disconnect(),this._jsNode.onaudioprocess=null,this._volume=null,this._values=null,this},t.Meter}),Module(function(t){return t.Split=function(){t.call(this,0,2),this._splitter=this.input=this.context.createChannelSplitter(2),this.left=this.output[0]=this.context.createGain(),this.right=this.output[1]=this.context.createGain(),this._splitter.connect(this.left,0,0),this._splitter.connect(this.right,1,0)},t.extend(t.Split),t.Split.prototype.dispose=function(){return t.prototype.dispose.call(this),this._splitter.disconnect(),this.left.disconnect(),this.right.disconnect(),this.left=null,this.right=null,this._splitter=null,this},t.Split}),Module(function(t){t.MidSideSplit=function(){t.call(this,0,2),this._split=this.input=new t.Split,this.mid=this.output[0]=new t.Expr("($0 + $1) * $2"),this.side=this.output[1]=new t.Expr("($0 - $1) * $2"),this._split.connect(this.mid,0,0),this._split.connect(this.mid,1,1),this._split.connect(this.side,0,0),this._split.connect(this.side,1,1),e.connect(this.mid,0,2),e.connect(this.side,0,2)},t.extend(t.MidSideSplit);var e=null;return t._initAudioContext(function(){e=new t.Signal(1/Math.sqrt(2))}),t.MidSideSplit.prototype.dispose=function(){return t.prototype.dispose.call(this),this.mid.dispose(),this.mid=null,this.side.dispose(),this.side=null,this._split.dispose(),this._split=null,this},t.MidSideSplit}),Module(function(t){t.MidSideMerge=function(){t.call(this,2,0),this.mid=this.input[0]=this.context.createGain(),this._left=new t.Expr("($0 + $1) * $2"),this.side=this.input[1]=this.context.createGain(),this._right=new t.Expr("($0 - $1) * $2"),this._merge=this.output=new t.Merge,this.mid.connect(this._left,0,0),this.side.connect(this._left,0,1),this.mid.connect(this._right,0,0),this.side.connect(this._right,0,1),this._left.connect(this._merge,0,0),this._right.connect(this._merge,0,1),e.connect(this._left,0,2),e.connect(this._right,0,2)},t.extend(t.MidSideMerge);var e=null;return t._initAudioContext(function(){e=new t.Signal(1/Math.sqrt(2))}),t.MidSideMerge.prototype.dispose=function(){return t.prototype.dispose.call(this),this.mid.disconnect(),this.mid=null,this.side.disconnect(),this.side=null,this._left.dispose(),this._left=null,this._right.dispose(),this._right=null,this._merge.dispose(),this._merge=null,this},t.MidSideMerge}),Module(function(t){return t.MidSideCompressor=function(e){e=this.defaultArg(e,t.MidSideCompressor.defaults),this._midSideSplit=this.input=new t.MidSideSplit,this._midSideMerge=this.output=new t.MidSideMerge,this.mid=new t.Compressor(e.mid),this.side=new t.Compressor(e.side),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),this._readOnly(["mid","side"])},t.extend(t.MidSideCompressor),t.MidSideCompressor.defaults={mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}},t.MidSideCompressor.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable(["mid","side"]),this.mid.dispose(),this.mid=null,this.side.dispose(),this.side=null,this._midSideSplit.dispose(),this._midSideSplit=null,this._midSideMerge.dispose(),this._midSideMerge=null,this},t.MidSideCompressor}),Module(function(t){return t.Mono=function(){t.call(this,1,0),this._merge=this.output=new t.Merge,this.input.connect(this._merge,0,0),this.input.connect(this._merge,0,1),this.input.gain.value=this.dbToGain(-10)},t.extend(t.Mono),t.Mono.prototype.dispose=function(){return t.prototype.dispose.call(this),this._merge.dispose(),this._merge=null,this},t.Mono}),Module(function(t){return t.MultibandCompressor=function(e){e=this.defaultArg(arguments,t.MultibandCompressor.defaults),this._splitter=this.input=new t.MultibandSplit({lowFrequency:e.lowFrequency,highFrequency:e.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=this.context.createGain(),this.low=new t.Compressor(e.low),this.mid=new t.Compressor(e.mid),this.high=new t.Compressor(e.high),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),this._readOnly(["high","mid","low","highFrequency","lowFrequency"])},t.extend(t.MultibandCompressor),t.MultibandCompressor.defaults={low:t.Compressor.defaults,mid:t.Compressor.defaults,high:t.Compressor.defaults,lowFrequency:250,highFrequency:2e3},t.MultibandCompressor.prototype.dispose=function(){return t.prototype.dispose.call(this),this._splitter.dispose(),this._writable(["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this._splitter=null,this.low=null,this.mid=null,this.high=null,this.lowFrequency=null,this.highFrequency=null,this},t.MultibandCompressor}),Module(function(t){return t.GainToAudio=function(){this._norm=this.input=this.output=new t.WaveShaper(function(t){return 2*Math.abs(t)-1})},t.extend(t.GainToAudio,t.SignalBase),t.GainToAudio.prototype.dispose=function(){return t.prototype.dispose.call(this),this._norm.dispose(),this._norm=null,this},t.GainToAudio}),Module(function(t){return t.Panner=function(e){t.call(this),this._hasStereoPanner=this.isFunction(this.context.createStereoPanner),this._hasStereoPanner?(this._panner=this.input=this.output=this.context.createStereoPanner(),this.pan=new t.Signal(0,t.Type.NormalRange),this._scalePan=new t.GainToAudio,this.pan.chain(this._scalePan,this._panner.pan)):(this._crossFade=new t.CrossFade,this._merger=this.output=new t.Merge,this._splitter=this.input=new t.Split,this.pan=this._crossFade.fade,this._splitter.connect(this._crossFade,0,0),this._splitter.connect(this._crossFade,1,1),this._crossFade.a.connect(this._merger,0,0),this._crossFade.b.connect(this._merger,0,1)),this.pan.value=this.defaultArg(e,.5),this._readOnly("pan")},t.extend(t.Panner),t.Panner.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable("pan"),this._hasStereoPanner?(this._panner.disconnect(),this._panner=null,this.pan.dispose(),this.pan=null,this._scalePan.dispose(),this._scalePan=null):(this._crossFade.dispose(),this._crossFade=null,this._splitter.dispose(),this._splitter=null,this._merger.dispose(),this._merger=null,this.pan=null),this},t.Panner}),Module(function(t){return t.Volume=function(e){this.output=this.input=this.context.createGain(),this.volume=new t.Signal(this.output.gain,t.Type.Decibels),this.volume.value=this.defaultArg(e,0),this._readOnly("volume")},t.extend(t.Volume),t.Volume.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable("volume"),this.volume.dispose(),this.volume=null,this},t.Volume}),Module(function(t){return t.PanVol=function(e,n){this._panner=this.input=new t.Panner(e),this.pan=this._panner.pan,this._volume=this.output=new t.Volume(n),this.volume=this._volume.volume,this._panner.connect(this._volume),this._readOnly(["pan","volume"])},t.extend(t.PanVol),t.PanVol.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable(["pan","volume"]),this._panner.dispose(),this._panner=null,this._volume.dispose(),this._volume=null,this.pan=null,this.volume=null,this},t.PanVol}),Module(function(t){return t.ScaledEnvelope=function(){var e=this.optionsObject(arguments,["attack","decay","sustain","release"],t.Envelope.defaults);t.Envelope.call(this,e),e=this.defaultArg(e,t.ScaledEnvelope.defaults),this._exp=this.output=new t.Pow(e.exponent),this._scale=this.output=new t.Scale(e.min,e.max),this._sig.chain(this._exp,this._scale)},t.extend(t.ScaledEnvelope,t.Envelope),t.ScaledEnvelope.defaults={min:0,max:1,exponent:1},Object.defineProperty(t.ScaledEnvelope.prototype,"min",{get:function(){return this._scale.min},set:function(t){this._scale.min=t}}),Object.defineProperty(t.ScaledEnvelope.prototype,"max",{get:function(){return this._scale.max},set:function(t){this._scale.max=t}}),Object.defineProperty(t.ScaledEnvelope.prototype,"exponent",{get:function(){return this._exp.value},set:function(t){this._exp.value=t}}),t.ScaledEnvelope.prototype.dispose=function(){return t.Envelope.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._exp.dispose(),this._exp=null,this},t.ScaledEnvelope}),Module(function(t){return t.Buffer=function(){var e=this.optionsObject(arguments,["url","onload"],t.Buffer.defaults);this._buffer=null,this._reversed=e.reverse,this.url=void 0,this.loaded=!1,this.onload=e.onload.bind(this,this),e.url instanceof AudioBuffer?(this._buffer.set(e.url),this.onload(this)):"string"==typeof e.url&&(this.url=e.url,t.Buffer._addToQueue(e.url,this))},t.extend(t.Buffer),t.Buffer.defaults={url:void 0,onload:t.noOp,reverse:!1},t.Buffer.prototype.set=function(e){return e instanceof t.Buffer?this._buffer=e.get():this._buffer=e,this.loaded=!0,this},t.Buffer.prototype.get=function(){return this._buffer},t.Buffer.prototype.load=function(e,n){return this.url=e,this.onload=this.defaultArg(n,this.onload),t.Buffer._addToQueue(e,this),this},t.Buffer.prototype.dispose=function(){return t.prototype.dispose.call(this),t.Buffer._removeFromQueue(this),this._buffer=null,this.onload=t.Buffer.defaults.onload,this},Object.defineProperty(t.Buffer.prototype,"duration",{get:function(){return this._buffer?this._buffer.duration:0}}),t.Buffer.prototype._reverse=function(){if(this.loaded)for(var t=0;t<this._buffer.numberOfChannels;t++)Array.prototype.reverse.call(this._buffer.getChannelData(t));return this},Object.defineProperty(t.Buffer.prototype,"reverse",{get:function(){return this._reversed},set:function(t){this._reversed!==t&&(this._reversed=t,this._reverse())}}),t.Buffer._queue=[],t.Buffer._currentDownloads=[],t.Buffer._totalDownloads=0,t.Buffer.MAX_SIMULTANEOUS_DOWNLOADS=6,t.Buffer._addToQueue=function(e,n){t.Buffer._queue.push({url:e,Buffer:n,progress:0,xhr:null}),this._totalDownloads++,t.Buffer._next()},t.Buffer._removeFromQueue=function(e){var n;for(n=0;n<t.Buffer._queue.length;n++){var i=t.Buffer._queue[n];i.Buffer===e&&t.Buffer._queue.splice(n,1)}for(n=0;n<t.Buffer._currentDownloads.length;n++){var r=t.Buffer._currentDownloads[n];r.Buffer===e&&(t.Buffer._currentDownloads.splice(n,1),r.xhr.abort(),r.xhr.onprogress=null,r.xhr.onload=null,r.xhr.onerror=null)}},t.Buffer._next=function(){if(t.Buffer._queue.length>0){if(t.Buffer._currentDownloads.length<t.Buffer.MAX_SIMULTANEOUS_DOWNLOADS){var e=t.Buffer._queue.shift();t.Buffer._currentDownloads.push(e),e.xhr=t.Buffer.load(e.url,function(n){var i=t.Buffer._currentDownloads.indexOf(e);t.Buffer._currentDownloads.splice(i,1),e.Buffer.set(n),e.Buffer._reversed&&e.Buffer._reverse(),e.Buffer.onload(e.Buffer),t.Buffer._onprogress(),t.Buffer._next()}),e.xhr.onprogress=function(n){e.progress=n.loaded/n.total,t.Buffer._onprogress()},e.xhr.onerror=t.Buffer.onerror}}else 0===t.Buffer._currentDownloads.length&&(t.Buffer.onload(),t.Buffer._totalDownloads=0)},t.Buffer._onprogress=function(){var e=0,n=t.Buffer._currentDownloads.length,i=0;if(n>0){for(var r=0;n>r;r++){var o=t.Buffer._currentDownloads[r];e+=o.progress}i=e}var s=n-i,a=t.Buffer._totalDownloads-t.Buffer._queue.length-s;t.Buffer.onprogress(a/t.Buffer._totalDownloads)},t.Buffer.load=function(e,n){var i=new XMLHttpRequest;return i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=function(){t.context.decodeAudioData(i.response,function(t){if(!t)throw new Error("could not decode audio data:"+e);n(t)})},i.send(),i},t.Buffer.onload=t.noOp,t.Buffer.onprogress=t.noOp,t.Buffer.onerror=t.noOp,t.Buffer}),Module(function(t){var e={};return t.prototype.send=function(t,n){e.hasOwnProperty(t)||(e[t]=this.context.createGain());var i=this.context.createGain();return i.gain.value=this.dbToGain(this.defaultArg(n,1)),this.output.chain(i,e[t]),i},t.prototype.receive=function(t,n){return e.hasOwnProperty(t)||(e[t]=this.context.createGain()),this.isUndef(n)&&(n=this.input),e[t].connect(n),this},t}),Module(function(t){function e(t,e,i){if(n.hasOwnProperty(t))for(var r=n[t],o=0,s=r.length;s>o;o++){var a=r[o];Array.isArray(i)?a.apply(window,[e].concat(i)):a(e,i)}}t.Note=function(e,n,i){this.value=i,this._channel=e,this._timelineID=t.Transport.setTimeline(this._trigger.bind(this),n)},t.Note.prototype._trigger=function(t){e(this._channel,t,this.value)},t.Note.prototype.dispose=function(){return t.Tranport.clearTimeline(this._timelineID),this.value=null,this};var n={};t.Note.route=function(t,e){n.hasOwnProperty(t)?n[t].push(e):n[t]=[e]},t.Note.unroute=function(t,e){if(n.hasOwnProperty(t)){var i=n[t],r=i.indexOf(e);-1!==r&&n[t].splice(r,1)}},t.Note.parseScore=function(e){var n=[];for(var i in e){var r=e[i];if("tempo"===i)t.Transport.bpm.value=r;else if("timeSignature"===i)t.Transport.timeSignature=r[0]/(r[1]/4);else{if(!Array.isArray(r))throw new TypeError("score parts must be Arrays");for(var o=0;o<r.length;o++){var s,a=r[o];if(Array.isArray(a)){var u=a[0],l=a.slice(1);s=new t.Note(i,u,l)}else s=new t.Note(i,a);n.push(s)}}}return n};var i={c:0,"c#":1,db:1,d:2,"d#":3,eb:3,e:4,f:5,"f#":6,gb:6,g:7,"g#":8,ab:8,a:9,"a#":10,bb:10,b:11},r=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],o=261.6255653005986;return t.prototype.noteToFrequency=function(t){var e=t.split(/(\d+)/);if(3===e.length){var n=i[e[0].toLowerCase()],r=e[1],s=n+12*parseInt(r,10);return Math.pow(2,(s-48)/12)*o}return 0},t.prototype.isNote=function(){var t=new RegExp(/[a-g]{1}([b#]{1}|[b#]{0})[0-9]+$/i);return function(e){return"string"==typeof e&&(e=e.toLowerCase()),t.test(e)}}(),t.prototype._overwrittenToFrequency=t.prototype.toFrequency,t.prototype.toFrequency=function(t,e){return this.isNote(t)&&(t=this.noteToFrequency(t)),this._overwrittenToFrequency(t,e)},t.prototype.frequencyToNote=function(t){var e=Math.log(t/o)/Math.LN2,n=Math.round(12*e)+48,i=Math.floor(n/12),s=r[n%12];return s+i.toString()},t.prototype.intervalToFrequencyRatio=function(t){return Math.pow(2,t/12)},t.prototype.midiToNote=function(t){var e=Math.floor(t/12)-2,n=t%12;return r[n]+e},t.prototype.noteToMidi=function(t){var e=t.split(/(\d+)/);if(3===e.length){var n=i[e[0].toLowerCase()],r=e[1];return n+12*(parseInt(r,10)+2)}return 0},t.Note}),Module(function(t){return t.PulseOscillator=function(){var e=this.optionsObject(arguments,["frequency","width"],t.Oscillator.defaults);t.Source.call(this,e),this.width=new t.Signal(e.width,t.Type.NormalRange),this._widthGate=this.context.createGain(),this._sawtooth=new t.Oscillator({frequency:e.frequency,detune:e.detune,type:"sawtooth",phase:e.phase}),this.frequency=this._sawtooth.frequency,this.detune=this._sawtooth.detune,this._thresh=new t.WaveShaper(function(t){return 0>t?-1:1}),this._sawtooth.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),this._readOnly(["width","frequency","detune"])},t.extend(t.PulseOscillator,t.Oscillator),t.PulseOscillator.defaults={frequency:440,detune:0,phase:0,width:.2},t.PulseOscillator.prototype._start=function(t){t=this.toSeconds(t),this._sawtooth.start(t),this._widthGate.gain.setValueAtTime(1,t)},t.PulseOscillator.prototype._stop=function(t){t=this.toSeconds(t),this._sawtooth.stop(t),this._widthGate.gain.setValueAtTime(0,t)},Object.defineProperty(t.PulseOscillator.prototype,"phase",{get:function(){return this._sawtooth.phase},set:function(t){this._sawtooth.phase=t}}),Object.defineProperty(t.PulseOscillator.prototype,"type",{get:function(){return"pulse"}}),t.PulseOscillator.prototype.dispose=function(){return t.Source.prototype.dispose.call(this),this._sawtooth.dispose(),this._sawtooth=null,this._writable(["width","frequency","detune"]),this.width.dispose(),this.width=null,this._widthGate.disconnect(),this._widthGate=null,this._widthGate=null,this._thresh.disconnect(),this._thresh=null,this.frequency=null,this.detune=null,this},t.PulseOscillator}),Module(function(t){return t.PWMOscillator=function(){var e=this.optionsObject(arguments,["frequency","modulationFrequency"],t.PWMOscillator.defaults);t.Source.call(this,e),this._pulse=new t.PulseOscillator(e.modulationFrequency),this._pulse._sawtooth.type="sine",this._modulator=new t.Oscillator({frequency:e.frequency,detune:e.detune}),this._scale=new t.Multiply(1.01),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this.modulationFrequency=this._pulse.frequency,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),this._readOnly(["modulationFrequency","frequency","detune"])},t.extend(t.PWMOscillator,t.Oscillator),t.PWMOscillator.defaults={frequency:440,detune:0,modulationFrequency:.4},t.PWMOscillator.prototype._start=function(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)},t.PWMOscillator.prototype._stop=function(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)},Object.defineProperty(t.PWMOscillator.prototype,"type",{get:function(){return"pwm"}}),Object.defineProperty(t.PWMOscillator.prototype,"phase",{get:function(){return this._modulator.phase},set:function(t){this._modulator.phase=t}}),t.PWMOscillator.prototype.dispose=function(){return t.Source.prototype.dispose.call(this),this._pulse.dispose(),this._pulse=null,this._scale.dispose(),this._scale=null,this._modulator.dispose(),this._modulator=null,this._writable(["modulationFrequency","frequency","detune"]),this.frequency=null,this.detune=null,this.modulationFrequency=null,this},t.PWMOscillator}),Module(function(t){t.OmniOscillator=function(){var e=this.optionsObject(arguments,["frequency","type"],t.OmniOscillator.defaults);t.Source.call(this,e),this.frequency=new t.Signal(e.frequency,t.Type.Frequency),this.detune=new t.Signal(e.detune,t.Type.Cents),this._sourceType=void 0,this._oscillator=null,this.type=e.type,this._readOnly(["frequency","detune"])},t.extend(t.OmniOscillator,t.Oscillator),t.OmniOscillator.defaults={frequency:440,detune:0,type:"sine",width:.4,modulationFrequency:.4};var e={PulseOscillator:"PulseOscillator",PWMOscillator:"PWMOscillator",Oscillator:"Oscillator"};return t.OmniOscillator.prototype._start=function(t){this._oscillator.start(t)},t.OmniOscillator.prototype._stop=function(t){this._oscillator.stop(t)},Object.defineProperty(t.OmniOscillator.prototype,"type",{get:function(){return this._oscillator.type},set:function(n){if(0===n.indexOf("sine")||0===n.indexOf("square")||0===n.indexOf("triangle")||0===n.indexOf("sawtooth"))this._sourceType!==e.Oscillator&&(this._sourceType=e.Oscillator,this._createNewOscillator(t.Oscillator)),this._oscillator.type=n;else if("pwm"===n)this._sourceType!==e.PWMOscillator&&(this._sourceType=e.PWMOscillator,this._createNewOscillator(t.PWMOscillator));else{if("pulse"!==n)throw new TypeError("Tone.OmniOscillator does not support type "+n);this._sourceType!==e.PulseOscillator&&(this._sourceType=e.PulseOscillator,this._createNewOscillator(t.PulseOscillator))}}}),t.OmniOscillator.prototype._createNewOscillator=function(e){var n=this.now()+this.bufferTime;if(null!==this._oscillator){var i=this._oscillator;i.stop(n),i.onended=function(){i.dispose(),i=null}}this._oscillator=new e,this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this.state===t.State.Started&&this._oscillator.start(n)},Object.defineProperty(t.OmniOscillator.prototype,"phase",{get:function(){return this._oscillator.phase},set:function(t){this._oscillator.phase=t}}),Object.defineProperty(t.OmniOscillator.prototype,"width",{get:function(){return this._sourceType===e.PulseOscillator?this._oscillator.width:void 0}}),Object.defineProperty(t.OmniOscillator.prototype,"modulationFrequency",{get:function(){return this._sourceType===e.PWMOscillator?this._oscillator.modulationFrequency:void 0}}),t.OmniOscillator.prototype.dispose=function(){return t.Source.prototype.dispose.call(this),this._writable(["frequency","detune"]),this.detune.dispose(),this.detune=null,this.frequency.dispose(),this.frequency=null,this._oscillator.dispose(),this._oscillator=null,this._sourceType=null,this},t.OmniOscillator}),Module(function(t){return t.Instrument=function(e){e=this.defaultArg(e,t.Instrument.defaults),this.output=this.context.createGain(),this.volume=new t.Signal({param:this.output.gain,units:t.Type.Decibels,value:e.volume}),this._readOnly(["volume"])},t.extend(t.Instrument),t.Instrument.defaults={volume:0},t.Instrument.prototype.triggerAttack=t.noOp,t.Instrument.prototype.triggerRelease=t.noOp,t.Instrument.prototype.triggerAttackRelease=function(t,e,n,i){return n=this.toSeconds(n),e=this.toSeconds(e),this.triggerAttack(t,n,i),this.triggerRelease(n+e),this},t.Instrument.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable(["volume"]),this.volume.dispose(),this.volume=null,this},t.Instrument}),Module(function(t){return t.Monophonic=function(e){e=this.defaultArg(e,t.Monophonic.defaults),t.Instrument.call(this,e),this.portamento=e.portamento},t.extend(t.Monophonic,t.Instrument),t.Monophonic.defaults={portamento:0},t.Monophonic.prototype.triggerAttack=function(t,e,n){return e=this.toSeconds(e),this._triggerEnvelopeAttack(e,n),this.setNote(t,e),this},t.Monophonic.prototype.triggerRelease=function(t){return this._triggerEnvelopeRelease(t),this},t.Monophonic.prototype._triggerEnvelopeAttack=function(){},t.Monophonic.prototype._triggerEnvelopeRelease=function(){},t.Monophonic.prototype.setNote=function(t,e){if(e=this.toSeconds(e),this.portamento>0){var n=this.frequency.value;this.frequency.setValueAtTime(n,e);var i=this.toSeconds(this.portamento);this.frequency.exponentialRampToValueAtTime(t,e+i)}else this.frequency.setValueAtTime(t,e);return this},t.Monophonic}),Module(function(t){return t.MonoSynth=function(e){e=this.defaultArg(e,t.MonoSynth.defaults),t.Monophonic.call(this,e),this.oscillator=new t.OmniOscillator(e.oscillator),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new t.Filter(e.filter),this.filterEnvelope=new t.ScaledEnvelope(e.filterEnvelope),this.envelope=new t.AmplitudeEnvelope(e.envelope),this.oscillator.chain(this.filter,this.envelope,this.output),this.oscillator.start(),this.filterEnvelope.connect(this.filter.frequency),this._readOnly(["oscillator","frequency","detune","filter","filterEnvelope","envelope"])},t.extend(t.MonoSynth,t.Monophonic),t.MonoSynth.defaults={frequency:"C4",detune:0,oscillator:{type:"square"},filter:{Q:6,type:"lowpass",rolloff:-24},envelope:{attack:.005,decay:.1,sustain:.9,release:1},filterEnvelope:{attack:.06,decay:.2,sustain:.5,release:2,min:20,max:4e3,exponent:2}},t.MonoSynth.prototype._triggerEnvelopeAttack=function(t,e){return this.envelope.triggerAttack(t,e),this.filterEnvelope.triggerAttack(t),this},t.MonoSynth.prototype._triggerEnvelopeRelease=function(t){return this.envelope.triggerRelease(t),this.filterEnvelope.triggerRelease(t),this},t.MonoSynth.prototype.dispose=function(){return t.Monophonic.prototype.dispose.call(this),this._writable(["oscillator","frequency","detune","filter","filterEnvelope","envelope"]),this.oscillator.dispose(),this.oscillator=null,this.envelope.dispose(),this.envelope=null,this.filterEnvelope.dispose(),this.filterEnvelope=null,this.filter.dispose(),this.filter=null,this.frequency=null,this.detune=null,this},t.MonoSynth}),Module(function(t){return t.AMSynth=function(e){e=this.defaultArg(e,t.AMSynth.defaults),t.Monophonic.call(this,e),this.carrier=new t.MonoSynth(e.carrier),this.carrier.volume.value=-10,this.modulator=new t.MonoSynth(e.modulator),this.modulator.volume.value=-10,this.frequency=new t.Signal(440,t.Type.Frequency),this.harmonicity=new t.Multiply(e.harmonicity),this.harmonicity.units=t.Type.Positive,this._modulationScale=new t.AudioToGain,this._modulationNode=this.context.createGain(),this.frequency.connect(this.carrier.frequency),this.frequency.chain(this.harmonicity,this.modulator.frequency),this.modulator.chain(this._modulationScale,this._modulationNode.gain),this.carrier.chain(this._modulationNode,this.output),this._readOnly(["carrier","modulator","frequency","harmonicity"])},t.extend(t.AMSynth,t.Monophonic),t.AMSynth.defaults={harmonicity:3,carrier:{volume:-10,oscillator:{type:"sine"},envelope:{attack:.01,decay:.01,sustain:1,release:.5},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5,min:2e4,max:2e4},filter:{Q:6,type:"lowpass",rolloff:-24}},modulator:{
volume:-10,oscillator:{type:"square"},envelope:{attack:2,decay:0,sustain:1,release:.5},filterEnvelope:{attack:4,decay:.2,sustain:.5,release:.5,min:20,max:1500},filter:{Q:6,type:"lowpass",rolloff:-24}}},t.AMSynth.prototype._triggerEnvelopeAttack=function(t,e){return t=this.toSeconds(t),this.carrier.envelope.triggerAttack(t,e),this.modulator.envelope.triggerAttack(t),this.carrier.filterEnvelope.triggerAttack(t),this.modulator.filterEnvelope.triggerAttack(t),this},t.AMSynth.prototype._triggerEnvelopeRelease=function(t){return this.carrier.triggerRelease(t),this.modulator.triggerRelease(t),this},t.AMSynth.prototype.dispose=function(){return t.Monophonic.prototype.dispose.call(this),this._writable(["carrier","modulator","frequency","harmonicity"]),this.carrier.dispose(),this.carrier=null,this.modulator.dispose(),this.modulator=null,this.frequency.dispose(),this.frequency=null,this.harmonicity.dispose(),this.harmonicity=null,this._modulationScale.dispose(),this._modulationScale=null,this._modulationNode.disconnect(),this._modulationNode=null,this},t.AMSynth}),Module(function(t){return t.DrumSynth=function(e){e=this.defaultArg(e,t.DrumSynth.defaults),t.Instrument.call(this,e),this.oscillator=new t.Oscillator(e.oscillator).start(),this.envelope=new t.AmplitudeEnvelope(e.envelope),this.octaves=e.octaves,this.pitchDecay=e.pitchDecay,this.oscillator.chain(this.envelope,this.output),this._readOnly(["oscillator","envelope"])},t.extend(t.DrumSynth,t.Instrument),t.DrumSynth.defaults={pitchDecay:.05,octaves:10,oscillator:{type:"sine"},envelope:{attack:.001,decay:.4,sustain:.01,release:1.4,attackCurve:"exponential"}},t.DrumSynth.prototype.triggerAttack=function(t,e,n){e=this.toSeconds(e),t=this.toFrequency(t);var i=t*this.octaves;return this.oscillator.frequency.setValueAtTime(i,e),this.oscillator.frequency.exponentialRampToValueAtTime(t,e+this.toSeconds(this.pitchDecay)),this.envelope.triggerAttack(e,n),this},t.DrumSynth.prototype.triggerRelease=function(t){return this.envelope.triggerRelease(t),this},t.DrumSynth.prototype.dispose=function(){return t.Instrument.prototype.dispose.call(this),this._writable(["oscillator","envelope"]),this.oscillator.dispose(),this.oscillator=null,this.envelope.dispose(),this.envelope=null,this},t.DrumSynth}),Module(function(t){return t.DuoSynth=function(e){e=this.defaultArg(e,t.DuoSynth.defaults),t.Monophonic.call(this,e),this.voice0=new t.MonoSynth(e.voice0),this.voice0.volume.value=-10,this.voice1=new t.MonoSynth(e.voice1),this.voice1.volume.value=-10,this._vibrato=new t.LFO(e.vibratoRate,-50,50),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=this.context.createGain(),this.vibratoAmount=new t.Signal(this._vibratoGain.gain,t.Type.Gain),this.vibratoAmount.value=e.vibratoAmount,this._vibratoDelay=this.toSeconds(e.vibratoDelay),this.frequency=new t.Signal(440,t.Type.Frequency),this.harmonicity=new t.Multiply(e.harmonicity),this.harmonicity.units=t.Type.Positive,this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),this._readOnly(["voice0","voice1","frequency","vibratoAmount","vibratoRate"])},t.extend(t.DuoSynth,t.Monophonic),t.DuoSynth.defaults={vibratoAmount:.5,vibratoRate:5,vibratoDelay:1,harmonicity:1.5,voice0:{volume:-10,portamento:0,oscillator:{type:"sine"},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}},voice1:{volume:-10,portamento:0,oscillator:{type:"sine"},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}},t.DuoSynth.prototype._triggerEnvelopeAttack=function(t,e){return t=this.toSeconds(t),this.voice0.envelope.triggerAttack(t,e),this.voice1.envelope.triggerAttack(t,e),this.voice0.filterEnvelope.triggerAttack(t),this.voice1.filterEnvelope.triggerAttack(t),this},t.DuoSynth.prototype._triggerEnvelopeRelease=function(t){return this.voice0.triggerRelease(t),this.voice1.triggerRelease(t),this},t.DuoSynth.prototype.dispose=function(){return t.Monophonic.prototype.dispose.call(this),this._writable(["voice0","voice1","frequency","vibratoAmount","vibratoRate"]),this.voice0.dispose(),this.voice0=null,this.voice1.dispose(),this.voice1=null,this.frequency.dispose(),this.frequency=null,this._vibrato.dispose(),this._vibrato=null,this._vibratoGain.disconnect(),this._vibratoGain=null,this.harmonicity.dispose(),this.harmonicity=null,this.vibratoAmount.dispose(),this.vibratoAmount=null,this.vibratoRate=null,this},t.DuoSynth}),Module(function(t){return t.FMSynth=function(e){e=this.defaultArg(e,t.FMSynth.defaults),t.Monophonic.call(this,e),this.carrier=new t.MonoSynth(e.carrier),this.carrier.volume.value=-10,this.modulator=new t.MonoSynth(e.modulator),this.modulator.volume.value=-10,this.frequency=new t.Signal(440,t.Type.Frequency),this.harmonicity=new t.Multiply(e.harmonicity),this.harmonicity.units=t.Type.Positive,this.modulationIndex=new t.Multiply(e.modulationIndex),this.modulationIndex.units=t.Type.Positive,this._modulationNode=this.context.createGain(),this.frequency.connect(this.carrier.frequency),this.frequency.chain(this.harmonicity,this.modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.modulator.connect(this._modulationNode.gain),this._modulationNode.gain.value=0,this._modulationNode.connect(this.carrier.frequency),this.carrier.connect(this.output),this._readOnly(["carrier","modulator","frequency","harmonicity","modulationIndex"])},t.extend(t.FMSynth,t.Monophonic),t.FMSynth.defaults={harmonicity:3,modulationIndex:10,carrier:{volume:-10,portamento:0,oscillator:{type:"sine"},envelope:{attack:.01,decay:0,sustain:1,release:.5},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5,min:2e4,max:2e4}},modulator:{volume:-10,portamento:0,oscillator:{type:"triangle"},envelope:{attack:.01,decay:0,sustain:1,release:.5},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5,min:2e4,max:2e4}}},t.FMSynth.prototype._triggerEnvelopeAttack=function(t,e){return t=this.toSeconds(t),this.carrier.envelope.triggerAttack(t,e),this.modulator.envelope.triggerAttack(t),this.carrier.filterEnvelope.triggerAttack(t),this.modulator.filterEnvelope.triggerAttack(t),this},t.FMSynth.prototype._triggerEnvelopeRelease=function(t){return this.carrier.triggerRelease(t),this.modulator.triggerRelease(t),this},t.FMSynth.prototype.dispose=function(){return t.Monophonic.prototype.dispose.call(this),this._writable(["carrier","modulator","frequency","harmonicity","modulationIndex"]),this.carrier.dispose(),this.carrier=null,this.modulator.dispose(),this.modulator=null,this.frequency.dispose(),this.frequency=null,this.modulationIndex.dispose(),this.modulationIndex=null,this.harmonicity.dispose(),this.harmonicity=null,this._modulationNode.disconnect(),this._modulationNode=null,this},t.FMSynth}),Module(function(t){t.Noise=function(){var e=this.optionsObject(arguments,["type"],t.Noise.defaults);t.Source.call(this,e),this._source=null,this._buffer=null,this.type=e.type},t.extend(t.Noise,t.Source),t.Noise.defaults={type:"white"},Object.defineProperty(t.Noise.prototype,"type",{get:function(){return this._buffer===i?"white":this._buffer===n?"brown":this._buffer===e?"pink":void 0},set:function(r){if(this.type!==r){switch(r){case"white":this._buffer=i;break;case"pink":this._buffer=e;break;case"brown":this._buffer=n;break;default:this._buffer=i}if(this.state===t.State.Started){var o=this.now()+this.bufferTime;this._source.onended=void 0,this._stop(o),this._start(o)}}}}),t.Noise.prototype._start=function(t){this._source=this.context.createBufferSource(),this._source.buffer=this._buffer,this._source.loop=!0,this.connectSeries(this._source,this.output),this._source.start(this.toSeconds(t)),this._source.onended=this.onended},t.Noise.prototype._stop=function(t){this._source&&this._source.stop(this.toSeconds(t))},t.Noise.prototype.dispose=function(){return t.Source.prototype.dispose.call(this),null!==this._source&&(this._source.disconnect(),this._source=null),this._buffer=null,this};var e=null,n=null,i=null;return t._initAudioContext(function(t){var r=t.sampleRate,o=4*r;e=function(){for(var e=t.createBuffer(2,o,r),n=0;n<e.numberOfChannels;n++){var i,s,a,u,l,c,h,f=e.getChannelData(n);i=s=a=u=l=c=h=0;for(var p=0;o>p;p++){var d=2*Math.random()-1;i=.99886*i+.0555179*d,s=.99332*s+.0750759*d,a=.969*a+.153852*d,u=.8665*u+.3104856*d,l=.55*l+.5329522*d,c=-.7616*c-.016898*d,f[p]=i+s+a+u+l+c+h+.5362*d,f[p]*=.11,h=.115926*d}}return e}(),n=function(){for(var e=t.createBuffer(2,o,r),n=0;n<e.numberOfChannels;n++)for(var i=e.getChannelData(n),s=0,a=0;o>a;a++){var u=2*Math.random()-1;i[a]=(s+.02*u)/1.02,s=i[a],i[a]*=3.5}return e}(),i=function(){for(var e=t.createBuffer(2,o,r),n=0;n<e.numberOfChannels;n++)for(var i=e.getChannelData(n),s=0;o>s;s++)i[s]=2*Math.random()-1;return e}()}),t.Noise}),Module(function(t){return t.NoiseSynth=function(e){e=this.defaultArg(e,t.NoiseSynth.defaults),t.Instrument.call(this,e),this.noise=new t.Noise,this.filter=new t.Filter(e.filter),this.filterEnvelope=new t.ScaledEnvelope(e.filterEnvelope),this.envelope=new t.AmplitudeEnvelope(e.envelope),this.noise.chain(this.filter,this.envelope,this.output),this.noise.start(),this.filterEnvelope.connect(this.filter.frequency),this._readOnly(["noise","filter","filterEnvelope","envelope"])},t.extend(t.NoiseSynth,t.Instrument),t.NoiseSynth.defaults={noise:{type:"white"},filter:{Q:6,type:"highpass",rolloff:-24},envelope:{attack:.005,decay:.1,sustain:0},filterEnvelope:{attack:.06,decay:.2,sustain:0,release:2,min:20,max:4e3,exponent:2}},t.NoiseSynth.prototype.triggerAttack=function(t,e){return this.envelope.triggerAttack(t,e),this.filterEnvelope.triggerAttack(t),this},t.NoiseSynth.prototype.triggerRelease=function(t){return this.envelope.triggerRelease(t),this.filterEnvelope.triggerRelease(t),this},t.NoiseSynth.prototype.triggerAttackRelease=function(t,e,n){return e=this.toSeconds(e),t=this.toSeconds(t),this.triggerAttack(e,n),this.triggerRelease(e+t),this},t.NoiseSynth.prototype.dispose=function(){return t.Instrument.prototype.dispose.call(this),this._writable(["noise","filter","filterEnvelope","envelope"]),this.noise.dispose(),this.noise=null,this.envelope.dispose(),this.envelope=null,this.filterEnvelope.dispose(),this.filterEnvelope=null,this.filter.dispose(),this.filter=null,this},t.NoiseSynth}),Module(function(t){return t.PluckSynth=function(e){e=this.defaultArg(e,t.PluckSynth.defaults),t.Instrument.call(this,e),this._noise=new t.Noise("pink"),this.attackNoise=1,this._lfcf=new t.LowpassCombFilter({resonance:e.resonance,dampening:e.dampening}),this.resonance=this._lfcf.resonance,this.dampening=this._lfcf.dampening,this._noise.connect(this._lfcf),this._lfcf.connect(this.output),this._readOnly(["resonance","dampening"])},t.extend(t.PluckSynth,t.Instrument),t.PluckSynth.defaults={attackNoise:1,dampening:4e3,resonance:.9},t.PluckSynth.prototype.triggerAttack=function(t,e){t=this.toFrequency(t),e=this.toSeconds(e);var n=1/t;return this._lfcf.delayTime.setValueAtTime(n,e),this._noise.start(e),this._noise.stop(e+n*this.attackNoise),this},t.PluckSynth.prototype.dispose=function(){return t.Instrument.prototype.dispose.call(this),this._noise.dispose(),this._lfcf.dispose(),this._noise=null,this._lfcf=null,this._writable(["resonance","dampening"]),this.dampening=null,this.resonance=null,this},t.PluckSynth}),Module(function(t){return t.PolySynth=function(){t.Instrument.call(this);var e=this.optionsObject(arguments,["polyphony","voice"],t.PolySynth.defaults);this.voices=new Array(e.polyphony),this._freeVoices=[],this._activeVoices={};for(var n=0;n<e.polyphony;n++){var i=new e.voice(arguments[2],arguments[3]);this.voices[n]=i,i.connect(this.output)}this._freeVoices=this.voices.slice(0)},t.extend(t.PolySynth,t.Instrument),t.PolySynth.defaults={polyphony:4,voice:t.MonoSynth},t.PolySynth.prototype.triggerAttack=function(t,e,n){Array.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var r=t[i],o=JSON.stringify(r);if(this._activeVoices[o])this._activeVoices[o].triggerAttack(r,e,n);else if(this._freeVoices.length>0){var s=this._freeVoices.shift();s.triggerAttack(r,e,n),this._activeVoices[o]=s}}return this},t.PolySynth.prototype.triggerAttackRelease=function(t,e,n,i){return n=this.toSeconds(n),this.triggerAttack(t,n,i),this.triggerRelease(t,n+this.toSeconds(e)),this},t.PolySynth.prototype.triggerRelease=function(t,e){Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=JSON.stringify(t[n]),r=this._activeVoices[i];r&&(r.triggerRelease(e),this._freeVoices.push(r),delete this._activeVoices[i],r=null)}return this},t.PolySynth.prototype.set=function(t,e,n){for(var i=0;i<this.voices.length;i++)this.voices[i].set(t,e,n);return this},t.PolySynth.prototype.get=function(t){return this.voices[0].get(t)},t.PolySynth.prototype.setPreset=function(t){for(var e=0;e<this.voices.length;e++)this.voices[e].setPreset(t);return this},t.PolySynth.prototype.dispose=function(){t.Instrument.prototype.dispose.call(this);for(var e=0;e<this.voices.length;e++)this.voices[e].dispose(),this.voices[e]=null;return this.voices=null,this._activeVoices=null,this._freeVoices=null,this},t.PolySynth}),Module(function(t){return t.Player=function(){var e=this.optionsObject(arguments,["url","onload"],t.Player.defaults);t.Source.call(this,e),this._source=null,this.autostart=e.autostart,this._buffer=new t.Buffer({url:e.url,onload:this._onload.bind(this,e.onload),reverse:e.reverse}),this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.retrigger=e.retrigger},t.extend(t.Player,t.Source),t.Player.defaults={onload:t.noOp,playbackRate:1,loop:!1,autostart:!1,loopStart:0,loopEnd:0,retrigger:!1,reverse:!1},t.Player.prototype.load=function(t,e){return this._buffer.load(t,this._onload.bind(this,e)),this},t.Player.prototype._onload=function(t){t(this),this.autostart&&this.start()},t.Player.prototype._start=function(t,e,n){if(!this._buffer.loaded)throw Error("tried to start Player before the buffer was loaded");return e=this._loop?this.defaultArg(e,this._loopStart):this.defaultArg(e,0),e=this.toSeconds(e),n=this.defaultArg(n,this._buffer.duration-e),t=this.toSeconds(t),n=this.toSeconds(n),this._source=this.context.createBufferSource(),this._source.buffer=this._buffer.get(),this._loop?(this._source.loop=this._loop,this._source.loopStart=this.toSeconds(this._loopStart),this._source.loopEnd=this.toSeconds(this._loopEnd),n=65536):this._nextStop=t+n,this._source.playbackRate.value=this._playbackRate,this._source.onended=this.onended,this._source.connect(this.output),this._source.start(t,e,n),this},t.Player.prototype._stop=function(t){return this._source&&(this._source.stop(this.toSeconds(t)),this._source=null),this},t.Player.prototype.setLoopPoints=function(t,e){return this.loopStart=t,this.loopEnd=e,this},Object.defineProperty(t.Player.prototype,"loopStart",{get:function(){return this._loopStart},set:function(t){this._loopStart=t,this._source&&(this._source.loopStart=this.toSeconds(t))}}),Object.defineProperty(t.Player.prototype,"loopEnd",{get:function(){return this._loopEnd},set:function(t){this._loopEnd=t,this._source&&(this._source.loopEnd=this.toSeconds(t))}}),Object.defineProperty(t.Player.prototype,"buffer",{get:function(){return this._buffer},set:function(t){this._buffer.set(t)}}),Object.defineProperty(t.Player.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this._source&&(this._source.loop=t)}}),Object.defineProperty(t.Player.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}}),Object.defineProperty(t.Player.prototype,"reverse",{get:function(){return this._buffer.reverse},set:function(t){this._buffer.reverse=t}}),t.Player.prototype.dispose=function(){return t.Source.prototype.dispose.call(this),null!==this._source&&(this._source.disconnect(),this._source=null),this._buffer.dispose(),this._buffer=null,this},t.Player}),Module(function(t){return t.Sampler=function(e,n){n=this.defaultArg(n,t.Sampler.defaults),t.Instrument.call(this,n),this.player=new t.Player(n.player),this.player.retrigger=!0,this._buffers={},this.envelope=new t.AmplitudeEnvelope(n.envelope),this.filterEnvelope=new t.ScaledEnvelope(n.filterEnvelope),this._sample=n.sample,this._pitch=n.pitch,this.filter=new t.Filter(n.filter),this._loadBuffers(e),this.pitch=n.pitch,this.player.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),this._readOnly(["player","filterEnvelope","envelope","filter"])},t.extend(t.Sampler,t.Instrument),t.Sampler.defaults={sample:0,pitch:0,player:{loop:!1},envelope:{attack:.001,decay:0,sustain:1,release:.1},filterEnvelope:{attack:.001,decay:.001,sustain:1,release:.5,min:20,max:2e4,exponent:2},filter:{type:"lowpass"}},t.Sampler.prototype._loadBuffers=function(e){if("string"==typeof e)this._buffers[0]=new t.Buffer(e,function(){this.sample="0"}.bind(this));else{e=this._flattenUrls(e);for(var n in e){this._sample=n;var i=e[n];this._buffers[n]=new t.Buffer(i)}}},t.Sampler.prototype._flattenUrls=function(t){var e={};for(var n in t)if(t.hasOwnProperty(n))if("object"==typeof t[n]){var i=this._flattenUrls(t[n]);for(var r in i)i.hasOwnProperty(r)&&(e[n+"."+r]=i[r])}else e[n]=t[n];return e},t.Sampler.prototype.triggerAttack=function(t,e,n){return e=this.toSeconds(e),t&&(this.sample=t),this.player.start(e),this.envelope.triggerAttack(e,n),this.filterEnvelope.triggerAttack(e),this},t.Sampler.prototype.triggerRelease=function(t){return t=this.toSeconds(t),this.filterEnvelope.triggerRelease(t),this.envelope.triggerRelease(t),this.player.stop(this.toSeconds(this.envelope.release)+t),this},Object.defineProperty(t.Sampler.prototype,"sample",{get:function(){return this._sample},set:function(t){if(!this._buffers.hasOwnProperty(t))throw new Error("Sampler does not have a sample named "+t);this._sample=t,this.player.buffer=this._buffers[t]}}),Object.defineProperty(t.Sampler.prototype,"reverse",{get:function(){for(var t in this._buffers)return this._buffers[t].reverse},set:function(t){for(var e in this._buffers)this._buffers[e].reverse=t}}),Object.defineProperty(t.Sampler.prototype,"pitch",{get:function(){return this._pitch},set:function(t){this._pitch=t,this.player.playbackRate=this.intervalToFrequencyRatio(t)}}),t.Sampler.prototype.dispose=function(){t.Instrument.prototype.dispose.call(this),this._writable(["player","filterEnvelope","envelope","filter"]),this.player.dispose(),this.filterEnvelope.dispose(),this.envelope.dispose(),this.filter.dispose(),this.player=null,this.filterEnvelope=null,this.envelope=null,this.filter=null;for(var e in this._buffers)this._buffers[e].dispose(),this._buffers[e]=null;return this._buffers=null,this},t.Sampler}),Module(function(t){return t.SimpleSynth=function(e){e=this.defaultArg(e,t.SimpleSynth.defaults),t.Monophonic.call(this,e),this.oscillator=new t.OmniOscillator(e.oscillator),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new t.AmplitudeEnvelope(e.envelope),this.oscillator.chain(this.envelope,this.output),this.oscillator.start(),this._readOnly(["oscillator","frequency","detune","envelope"])},t.extend(t.SimpleSynth,t.Monophonic),t.SimpleSynth.defaults={oscillator:{type:"triangle"},envelope:{attack:.005,decay:.1,sustain:.3,release:1}},t.SimpleSynth.prototype._triggerEnvelopeAttack=function(t,e){return this.envelope.triggerAttack(t,e),this},t.SimpleSynth.prototype._triggerEnvelopeRelease=function(t){return this.envelope.triggerRelease(t),this},t.SimpleSynth.prototype.dispose=function(){return t.Monophonic.prototype.dispose.call(this),this._writable(["oscillator","frequency","detune","envelope"]),this.oscillator.dispose(),this.oscillator=null,this.envelope.dispose(),this.envelope=null,this.frequency=null,this.detune=null,this},t.SimpleSynth}),Module(function(t){return t.SimpleAM=function(e){e=this.defaultArg(e,t.SimpleAM.defaults),t.Monophonic.call(this,e),this.carrier=new t.SimpleSynth(e.carrier),this.modulator=new t.SimpleSynth(e.modulator),this.frequency=new t.Signal(440,t.Type.Frequency),this.harmonicity=new t.Multiply(e.harmonicity),this.harmonicity.units=t.Type.Positive,this._modulationScale=new t.AudioToGain,this._modulationNode=this.context.createGain(),this.frequency.connect(this.carrier.frequency),this.frequency.chain(this.harmonicity,this.modulator.frequency),this.modulator.chain(this._modulationScale,this._modulationNode.gain),this.carrier.chain(this._modulationNode,this.output),this._readOnly(["carrier","modulator","frequency","harmonicity"])},t.extend(t.SimpleAM,t.Monophonic),t.SimpleAM.defaults={harmonicity:3,carrier:{volume:-10,portamento:0,oscillator:{type:"sine"},envelope:{attack:.01,decay:.01,sustain:1,release:.5}},modulator:{volume:-10,portamento:0,oscillator:{type:"sine"},envelope:{attack:.5,decay:.1,sustain:1,release:.5}}},t.SimpleAM.prototype._triggerEnvelopeAttack=function(t,e){return t=this.toSeconds(t),this.carrier.envelope.triggerAttack(t,e),this.modulator.envelope.triggerAttack(t),this},t.SimpleAM.prototype._triggerEnvelopeRelease=function(t){return this.carrier.triggerRelease(t),this.modulator.triggerRelease(t),this},t.SimpleAM.prototype.dispose=function(){return t.Monophonic.prototype.dispose.call(this),this._writable(["carrier","modulator","frequency","harmonicity"]),this.carrier.dispose(),this.carrier=null,this.modulator.dispose(),this.modulator=null,this.frequency.dispose(),this.frequency=null,this.harmonicity.dispose(),this.harmonicity=null,this._modulationScale.dispose(),this._modulationScale=null,this._modulationNode.disconnect(),this._modulationNode=null,this},t.SimpleAM}),Module(function(t){return t.SimpleFM=function(e){e=this.defaultArg(e,t.SimpleFM.defaults),t.Monophonic.call(this,e),this.carrier=new t.SimpleSynth(e.carrier),this.carrier.volume.value=-10,this.modulator=new t.SimpleSynth(e.modulator),this.modulator.volume.value=-10,this.frequency=new t.Signal(440,t.Type.Frequency),this.harmonicity=new t.Multiply(e.harmonicity),this.harmonicity.units=t.Type.Positive,this.modulationIndex=new t.Multiply(e.modulationIndex),this.modulationIndex.units=t.Type.Positive,this._modulationNode=this.context.createGain(),this.frequency.connect(this.carrier.frequency),this.frequency.chain(this.harmonicity,this.modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.modulator.connect(this._modulationNode.gain),this._modulationNode.gain.value=0,this._modulationNode.connect(this.carrier.frequency),this.carrier.connect(this.output),this._readOnly(["carrier","modulator","frequency","harmonicity","modulationIndex"])},t.extend(t.SimpleFM,t.Monophonic),t.SimpleFM.defaults={harmonicity:3,modulationIndex:10,carrier:{volume:-10,portamento:0,oscillator:{type:"sine"},envelope:{attack:.01,decay:0,sustain:1,release:.5}},modulator:{volume:-10,portamento:0,oscillator:{type:"triangle"},envelope:{attack:.01,decay:0,sustain:1,release:.5}}},t.SimpleFM.prototype._triggerEnvelopeAttack=function(t,e){return t=this.toSeconds(t),this.carrier.envelope.triggerAttack(t,e),this.modulator.envelope.triggerAttack(t),this},t.SimpleFM.prototype._triggerEnvelopeRelease=function(t){return this.carrier.triggerRelease(t),this.modulator.triggerRelease(t),this},t.SimpleFM.prototype.dispose=function(){return t.Monophonic.prototype.dispose.call(this),this._writable(["carrier","modulator","frequency","harmonicity","modulationIndex"]),this.carrier.dispose(),this.carrier=null,this.modulator.dispose(),this.modulator=null,this.frequency.dispose(),this.frequency=null,this.modulationIndex.dispose(),this.modulationIndex=null,this.harmonicity.dispose(),this.harmonicity=null,this._modulationNode.disconnect(),this._modulationNode=null,this},t.SimpleFM}),Module(function(t){return t.Effect=function(){t.call(this);var e=this.optionsObject(arguments,["wet"],t.Effect.defaults);this._dryWet=new t.CrossFade(e.wet),this.wet=this._dryWet.fade,this.effectSend=this.context.createGain(),this.effectReturn=this.context.createGain(),this.input.connect(this._dryWet.a),this.input.connect(this.effectSend),this.effectReturn.connect(this._dryWet.b),this._dryWet.connect(this.output),this._readOnly(["wet"])},t.extend(t.Effect),t.Effect.defaults={wet:1},t.Effect.prototype.connectEffect=function(t){return this.effectSend.chain(t,this.effectReturn),this},t.Effect.prototype.dispose=function(){return t.prototype.dispose.call(this),this._dryWet.dispose(),this._dryWet=null,this.effectSend.disconnect(),this.effectSend=null,this.effectReturn.disconnect(),this.effectReturn=null,this._writable(["wet"]),this.wet=null,this},t.Effect}),Module(function(t){return t.AutoFilter=function(){var e=this.optionsObject(arguments,["frequency","min","max"],t.AutoFilter.defaults);t.Effect.call(this,e),this._lfo=new t.LFO({frequency:e.frequency,amplitude:e.depth,min:e.min,max:e.max}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.filter=new t.Filter(e.filter),this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.type=e.type,this._readOnly(["frequency","depth"])},t.extend(t.AutoFilter,t.Effect),t.AutoFilter.defaults={frequency:1,type:"sine",depth:1,min:200,max:1200,filter:{type:"lowpass",rolloff:-12,Q:1}},t.AutoFilter.prototype.start=function(t){return this._lfo.start(t),this},t.AutoFilter.prototype.stop=function(t){return this._lfo.stop(t),this},t.AutoFilter.prototype.sync=function(t){return this._lfo.sync(t),this},t.AutoFilter.prototype.unsync=function(){return this._lfo.unsync(),this},Object.defineProperty(t.AutoFilter.prototype,"type",{get:function(){return this._lfo.type},set:function(t){this._lfo.type=t}}),Object.defineProperty(t.AutoFilter.prototype,"min",{get:function(){return this._lfo.min},set:function(t){this._lfo.min=t}}),Object.defineProperty(t.AutoFilter.prototype,"max",{get:function(){return this._lfo.max},set:function(t){this._lfo.max=t}}),t.AutoFilter.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this._lfo.dispose(),this._lfo=null,this.filter.dispose(),this.filter=null,this._writable(["frequency","depth"]),this.frequency=null,this.depth=null,this},t.AutoFilter}),Module(function(t){return t.AutoPanner=function(){var e=this.optionsObject(arguments,["frequency"],t.AutoPanner.defaults);t.Effect.call(this,e),this._lfo=new t.LFO({frequency:e.frequency,amplitude:e.depth,min:0,max:1,phase:90}),this.depth=this._lfo.amplitude,this._panner=new t.Panner,this.frequency=this._lfo.frequency,this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this.type=e.type,this._readOnly(["depth","frequency"])},t.extend(t.AutoPanner,t.Effect),t.AutoPanner.defaults={frequency:1,type:"sine",depth:1},t.AutoPanner.prototype.start=function(t){return this._lfo.start(t),this},t.AutoPanner.prototype.stop=function(t){return this._lfo.stop(t),this},t.AutoPanner.prototype.sync=function(t){return this._lfo.sync(t),this},t.AutoPanner.prototype.unsync=function(){return this._lfo.unsync(),this},Object.defineProperty(t.AutoPanner.prototype,"type",{get:function(){return this._lfo.type},set:function(t){this._lfo.type=t}}),t.AutoPanner.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this._lfo.dispose(),this._lfo=null,this._panner.dispose(),this._panner=null,this._writable(["depth","frequency"]),this.frequency=null,this.depth=null,this},t.AutoPanner}),Module(function(t){return t.AutoWah=function(){var e=this.optionsObject(arguments,["baseFrequency","octaves","sensitivity"],t.AutoWah.defaults);t.Effect.call(this,e),this.follower=new t.Follower(e.follower),this._sweepRange=new t.ScaleExp(0,1,.5),this._baseFrequency=e.baseFrequency,this._octaves=e.octaves,this._inputBoost=this.context.createGain(),this._bandpass=new t.Filter({rolloff:-48,frequency:0,Q:e.Q}),this._peaking=new t.Filter(0,"peaking"),this._peaking.gain.value=e.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this.follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=e.sensitivity,this._readOnly(["gain","Q"])},t.extend(t.AutoWah,t.Effect),t.AutoWah.defaults={baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:{attack:.3,release:.5}},Object.defineProperty(t.AutoWah.prototype,"octaves",{get:function(){return this._octaves},set:function(t){this._octaves=t,this._setSweepRange()}}),Object.defineProperty(t.AutoWah.prototype,"baseFrequency",{get:function(){return this._baseFrequency},set:function(t){this._baseFrequency=t,this._setSweepRange()}}),Object.defineProperty(t.AutoWah.prototype,"sensitivity",{get:function(){return this.gainToDb(1/this._inputBoost.gain.value)},set:function(t){this._inputBoost.gain.value=1/this.dbToGain(t)}}),t.AutoWah.prototype._setSweepRange=function(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)},t.AutoWah.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this.follower.dispose(),this.follower=null,this._sweepRange.dispose(),this._sweepRange=null,this._bandpass.dispose(),this._bandpass=null,this._peaking.dispose(),this._peaking=null,this._inputBoost.disconnect(),this._inputBoost=null,this._writable(["gain","Q"]),this.gain=null,this.Q=null,this},t.AutoWah}),Module(function(t){return t.BitCrusher=function(){var e=this.optionsObject(arguments,["bits"],t.BitCrusher.defaults);t.Effect.call(this,e);var n=1/Math.pow(2,e.bits-1);this._subtract=new t.Subtract,this._modulo=new t.Modulo(n),this._bits=e.bits,this.effectSend.fan(this._subtract,this._modulo),this._modulo.connect(this._subtract,0,1),this._subtract.connect(this.effectReturn)},t.extend(t.BitCrusher,t.Effect),t.BitCrusher.defaults={bits:4},Object.defineProperty(t.BitCrusher.prototype,"bits",{get:function(){return this._bits},set:function(t){this._bits=t;var e=1/Math.pow(2,t-1);this._modulo.value=e}}),t.BitCrusher.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this._subtract.dispose(),this._subtract=null,this._modulo.dispose(),this._modulo=null,this},t.BitCrusher}),Module(function(t){return t.Chebyshev=function(){var e=this.optionsObject(arguments,["order"],t.Chebyshev.defaults);t.Effect.call(this),this._shaper=new t.WaveShaper(4096),this._order=e.order,this.connectEffect(this._shaper),this.order=e.order,this.oversample=e.oversample},t.extend(t.Chebyshev,t.Effect),t.Chebyshev.defaults={order:1,oversample:"none"},t.Chebyshev.prototype._getCoefficient=function(t,e,n){return n.hasOwnProperty(e)?n[e]:(0===e?n[e]=0:1===e?n[e]=t:n[e]=2*t*this._getCoefficient(t,e-1,n)-this._getCoefficient(t,e-2,n),n[e])},Object.defineProperty(t.Chebyshev.prototype,"order",{get:function(){return this._order},set:function(t){this._order=t;for(var e=new Array(4096),n=e.length,i=0;n>i;++i){var r=2*i/n-1;0===r?e[i]=0:e[i]=this._getCoefficient(r,t,{})}this._shaper.curve=e}}),Object.defineProperty(t.Chebyshev.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(t){this._shaper.oversample=t}}),t.Chebyshev.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this},t.Chebyshev}),Module(function(t){return t.StereoEffect=function(){t.call(this);var e=this.optionsObject(arguments,["wet"],t.Effect.defaults);this._dryWet=new t.CrossFade(e.wet),this.wet=this._dryWet.fade,this._split=new t.Split,this.effectSendL=this._split.left,this.effectSendR=this._split.right,this._merge=new t.Merge,this.effectReturnL=this._merge.left,this.effectReturnR=this._merge.right,this.input.connect(this._split),this.input.connect(this._dryWet,0,0),this._merge.connect(this._dryWet,0,1),this._dryWet.connect(this.output),
this._readOnly(["wet"])},t.extend(t.StereoEffect,t.Effect),t.StereoEffect.prototype.dispose=function(){return t.prototype.dispose.call(this),this._dryWet.dispose(),this._dryWet=null,this._split.dispose(),this._split=null,this._merge.dispose(),this._merge=null,this.effectSendL=null,this.effectSendR=null,this.effectReturnL=null,this.effectReturnR=null,this._writable(["wet"]),this.wet=null,this},t.StereoEffect}),Module(function(t){return t.FeedbackEffect=function(){var e=this.optionsObject(arguments,["feedback"]);e=this.defaultArg(e,t.FeedbackEffect.defaults),t.Effect.call(this,e),this.feedback=new t.Signal(e.feedback,t.Type.NormalRange),this._feedbackGain=this.context.createGain(),this.effectReturn.chain(this._feedbackGain,this.effectSend),this.feedback.connect(this._feedbackGain.gain),this._readOnly(["feedback"])},t.extend(t.FeedbackEffect,t.Effect),t.FeedbackEffect.defaults={feedback:.125},t.FeedbackEffect.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this._writable(["feedback"]),this.feedback.dispose(),this.feedback=null,this._feedbackGain.disconnect(),this._feedbackGain=null,this},t.FeedbackEffect}),Module(function(t){return t.StereoXFeedbackEffect=function(){var e=this.optionsObject(arguments,["feedback"],t.FeedbackEffect.defaults);t.StereoEffect.call(this,e),this.feedback=new t.Signal(e.feedback,t.Type.NormalRange),this._feedbackLR=this.context.createGain(),this._feedbackRL=this.context.createGain(),this.effectReturnL.chain(this._feedbackLR,this.effectSendR),this.effectReturnR.chain(this._feedbackRL,this.effectSendL),this.feedback.fan(this._feedbackLR.gain,this._feedbackRL.gain),this._readOnly(["feedback"])},t.extend(t.StereoXFeedbackEffect,t.FeedbackEffect),t.StereoXFeedbackEffect.prototype.dispose=function(){return t.StereoEffect.prototype.dispose.call(this),this._writable(["feedback"]),this.feedback.dispose(),this.feedback=null,this._feedbackLR.disconnect(),this._feedbackLR=null,this._feedbackRL.disconnect(),this._feedbackRL=null,this},t.StereoXFeedbackEffect}),Module(function(t){return t.Chorus=function(){var e=this.optionsObject(arguments,["frequency","delayTime","depth"],t.Chorus.defaults);t.StereoXFeedbackEffect.call(this,e),this._depth=e.depth,this._delayTime=e.delayTime/1e3,this._lfoL=new t.LFO(e.rate,0,1),this._lfoR=new t.LFO(e.rate,0,1),this._lfoR.phase=180,this._delayNodeL=this.context.createDelay(),this._delayNodeR=this.context.createDelay(),this.frequency=this._lfoL.frequency,this.connectSeries(this.effectSendL,this._delayNodeL,this.effectReturnL),this.connectSeries(this.effectSendR,this._delayNodeR,this.effectReturnR),this.input.connect(this.output),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this._lfoL.start(),this._lfoR.start(),this._lfoL.frequency.connect(this._lfoR.frequency),this.depth=this._depth,this.frequency.value=e.frequency,this.type=e.type,this._readOnly(["frequency"])},t.extend(t.Chorus,t.StereoXFeedbackEffect),t.Chorus.defaults={frequency:1.5,delayTime:3.5,depth:.7,feedback:.1,type:"sine"},Object.defineProperty(t.Chorus.prototype,"depth",{get:function(){return this._depth},set:function(t){this._depth=t;var e=this._delayTime*t;this._lfoL.min=Math.max(this._delayTime-e,0),this._lfoL.max=this._delayTime+e,this._lfoR.min=Math.max(this._delayTime-e,0),this._lfoR.max=this._delayTime+e}}),Object.defineProperty(t.Chorus.prototype,"delayTime",{get:function(){return 1e3*this._delayTime},set:function(t){this._delayTime=t/1e3,this.depth=this._depth}}),Object.defineProperty(t.Chorus.prototype,"type",{get:function(){return this._lfoL.type},set:function(t){this._lfoL.type=t,this._lfoR.type=t}}),t.Chorus.prototype.dispose=function(){return t.StereoXFeedbackEffect.prototype.dispose.call(this),this._lfoL.dispose(),this._lfoL=null,this._lfoR.dispose(),this._lfoR=null,this._delayNodeL.disconnect(),this._delayNodeL=null,this._delayNodeR.disconnect(),this._delayNodeR=null,this._writable("frequency"),this.frequency=null,this},t.Chorus}),Module(function(t){return t.Convolver=function(){var e=this.optionsObject(arguments,["url"],t.Convolver.defaults);t.Effect.call(this,e),this._convolver=this.context.createConvolver(),this._buffer=new t.Buffer(e.url,function(t){this.buffer=t,e.onload()}.bind(this)),this.connectEffect(this._convolver)},t.extend(t.Convolver,t.Effect),t.Convolver.defaults={url:"",onload:t.noOp},Object.defineProperty(t.Convolver.prototype,"buffer",{get:function(){return this._buffer.get()},set:function(t){this._buffer.set(t),this._convolver.buffer=this._buffer.get()}}),t.Convolver.prototype.load=function(t,e){return this._buffer.load(t,function(t){this.buffer=t,e&&e()}.bind(this)),this},t.Convolver.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this._convolver.disconnect(),this._convolver=null,this._buffer.dispose(),this._buffer=null,this},t.Convolver}),Module(function(t){return t.Distortion=function(){var e=this.optionsObject(arguments,["distortion"],t.Distortion.defaults);t.Effect.call(this,e),this._shaper=new t.WaveShaper(4096),this._distortion=e.distortion,this.connectEffect(this._shaper),this.distortion=e.distortion,this.oversample=e.oversample},t.extend(t.Distortion,t.Effect),t.Distortion.defaults={distortion:.4,oversample:"none"},Object.defineProperty(t.Distortion.prototype,"distortion",{get:function(){return this._distortion},set:function(t){this._distortion=t;var e=100*t,n=Math.PI/180;this._shaper.setMap(function(t){return Math.abs(t)<.001?0:(3+e)*t*20*n/(Math.PI+e*Math.abs(t))})}}),Object.defineProperty(t.Distortion.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(t){this._shaper.oversample=t}}),t.Distortion.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this},t.Distortion}),Module(function(t){return t.FeedbackDelay=function(){var e=this.optionsObject(arguments,["delayTime","feedback"],t.FeedbackDelay.defaults);t.FeedbackEffect.call(this,e),this.delayTime=new t.Signal(e.delayTime,t.Type.Time),this._delayNode=this.context.createDelay(4),this.connectEffect(this._delayNode),this.delayTime.connect(this._delayNode.delayTime),this._readOnly(["delayTime"])},t.extend(t.FeedbackDelay,t.FeedbackEffect),t.FeedbackDelay.defaults={delayTime:.25},t.FeedbackDelay.prototype.dispose=function(){return t.FeedbackEffect.prototype.dispose.call(this),this.delayTime.dispose(),this._delayNode.disconnect(),this._delayNode=null,this._writable(["delayTime"]),this.delayTime=null,this},t.FeedbackDelay}),Module(function(t){var e=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],n=[225,556,441,341];return t.Freeverb=function(){var i=this.optionsObject(arguments,["roomSize","dampening"],t.Freeverb.defaults);t.StereoEffect.call(this,i),this.roomSize=new t.Signal(i.roomSize,t.Type.NormalRange),this.dampening=new t.Signal(i.dampening,t.Type.Frequency),this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[];for(var r=0;r<n.length;r++){var o=this.context.createBiquadFilter();o.type="allpass",o.frequency.value=n[r],this._allpassFiltersL.push(o)}for(var s=0;s<n.length;s++){var a=this.context.createBiquadFilter();a.type="allpass",a.frequency.value=n[s],this._allpassFiltersR.push(a)}for(var u=0;u<e.length;u++){var l=new t.LowpassCombFilter(e[u]);u<e.length/2?this.effectSendL.chain(l,this._allpassFiltersL[0]):this.effectSendR.chain(l,this._allpassFiltersR[0]),this.roomSize.connect(l.resonance),this.dampening.connect(l.dampening),this._combFilters.push(l)}this.connectSeries.apply(this,this._allpassFiltersL),this.connectSeries.apply(this,this._allpassFiltersR),this._allpassFiltersL[this._allpassFiltersL.length-1].connect(this.effectReturnL),this._allpassFiltersR[this._allpassFiltersR.length-1].connect(this.effectReturnR),this._readOnly(["roomSize","dampening"])},t.extend(t.Freeverb,t.StereoEffect),t.Freeverb.defaults={roomSize:.7,dampening:3e3},t.Freeverb.prototype.dispose=function(){t.StereoEffect.prototype.dispose.call(this);for(var e=0;e<this._allpassFiltersL.length;e++)this._allpassFiltersL[e].disconnect(),this._allpassFiltersL[e]=null;this._allpassFiltersL=null;for(var n=0;n<this._allpassFiltersR.length;n++)this._allpassFiltersR[n].disconnect(),this._allpassFiltersR[n]=null;this._allpassFiltersR=null;for(var i=0;i<this._combFilters.length;i++)this._combFilters[i].dispose(),this._combFilters[i]=null;return this._combFilters=null,this._writable(["roomSize","dampening"]),this.roomSize.dispose(),this.roomSize=null,this.dampening.dispose(),this.dampening=null,this},t.Freeverb}),Module(function(t){var e=[.06748,.06404,.08212,.09004],n=[.773,.802,.753,.733],i=[347,113,37];return t.JCReverb=function(){var r=this.optionsObject(arguments,["roomSize"],t.JCReverb.defaults);t.StereoEffect.call(this,r),this.roomSize=new t.Signal(r.roomSize,t.Type.NormalRange),this._scaleRoomSize=new t.Scale(-.733,.197),this._allpassFilters=[],this._feedbackCombFilters=[];for(var o=0;o<i.length;o++){var s=this.context.createBiquadFilter();s.type="allpass",s.frequency.value=i[o],this._allpassFilters.push(s)}for(var a=0;a<e.length;a++){var u=new t.FeedbackCombFilter(e[a],.1);this._scaleRoomSize.connect(u.resonance),u.resonance.value=n[a],this._allpassFilters[this._allpassFilters.length-1].connect(u),a<e.length/2?u.connect(this.effectReturnL):u.connect(this.effectReturnR),this._feedbackCombFilters.push(u)}this.roomSize.connect(this._scaleRoomSize),this.connectSeries.apply(this,this._allpassFilters),this.effectSendL.connect(this._allpassFilters[0]),this.effectSendR.connect(this._allpassFilters[0]),this._readOnly(["roomSize"])},t.extend(t.JCReverb,t.StereoEffect),t.JCReverb.defaults={roomSize:.5},t.JCReverb.prototype.dispose=function(){t.StereoEffect.prototype.dispose.call(this);for(var e=0;e<this._allpassFilters.length;e++)this._allpassFilters[e].disconnect(),this._allpassFilters[e]=null;this._allpassFilters=null;for(var n=0;n<this._feedbackCombFilters.length;n++)this._feedbackCombFilters[n].dispose(),this._feedbackCombFilters[n]=null;return this._feedbackCombFilters=null,this._writable(["roomSize"]),this.roomSize.dispose(),this.roomSize=null,this._scaleRoomSize.dispose(),this._scaleRoomSize=null,this},t.JCReverb}),Module(function(t){return t.MidSideEffect=function(){t.Effect.call(this),this._midSideSplit=new t.MidSideSplit,this._midSideMerge=new t.MidSideMerge,this.midSend=this._midSideSplit.mid,this.sideSend=this._midSideSplit.side,this.midReturn=this._midSideMerge.mid,this.sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)},t.extend(t.MidSideEffect,t.Effect),t.MidSideEffect.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this._midSideSplit.dispose(),this._midSideSplit=null,this._midSideMerge.dispose(),this._midSideMerge=null,this.midSend=null,this.sideSend=null,this.midReturn=null,this.sideReturn=null,this},t.MidSideEffect}),Module(function(t){return t.Phaser=function(){var e=this.optionsObject(arguments,["frequency","depth","baseFrequency"],t.Phaser.defaults);t.StereoEffect.call(this,e),this._lfoL=new t.LFO(e.frequency,0,1),this._lfoR=new t.LFO(e.frequency,0,1),this._lfoR.phase=180,this._baseFrequency=e.baseFrequency,this._depth=e.depth,this.Q=new t.Signal(e.Q,t.Type.Positive),this._filtersL=this._makeFilters(e.stages,this._lfoL,this.Q),this._filtersR=this._makeFilters(e.stages,this._lfoR,this.Q),this.frequency=this._lfoL.frequency,this.frequency.value=e.frequency,this.effectSendL.connect(this._filtersL[0]),this.effectSendR.connect(this._filtersR[0]),this._filtersL[e.stages-1].connect(this.effectReturnL),this._filtersR[e.stages-1].connect(this.effectReturnR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=e.baseFrequency,this.depth=e.depth,this._lfoL.start(),this._lfoR.start(),this._readOnly(["frequency","Q"])},t.extend(t.Phaser,t.StereoEffect),t.Phaser.defaults={frequency:.5,depth:10,stages:10,Q:10,baseFrequency:350},t.Phaser.prototype._makeFilters=function(t,e,n){for(var i=new Array(t),r=0;t>r;r++){var o=this.context.createBiquadFilter();o.type="allpass",n.connect(o.Q),e.connect(o.frequency),i[r]=o}return this.connectSeries.apply(this,i),i},Object.defineProperty(t.Phaser.prototype,"depth",{get:function(){return this._depth},set:function(t){this._depth=t;var e=this._baseFrequency+this._baseFrequency*t;this._lfoL.max=e,this._lfoR.max=e}}),Object.defineProperty(t.Phaser.prototype,"baseFrequency",{get:function(){return this._baseFrequency},set:function(t){this._baseFrequency=t,this._lfoL.min=t,this._lfoR.min=t,this.depth=this._depth}}),t.Phaser.prototype.dispose=function(){t.StereoEffect.prototype.dispose.call(this),this._writable(["frequency","Q"]),this.Q.dispose(),this.Q=null,this._lfoL.dispose(),this._lfoL=null,this._lfoR.dispose(),this._lfoR=null;for(var e=0;e<this._filtersL.length;e++)this._filtersL[e].disconnect(),this._filtersL[e]=null;this._filtersL=null;for(var n=0;n<this._filtersR.length;n++)this._filtersR[n].disconnect(),this._filtersR[n]=null;return this._filtersR=null,this.frequency=null,this},t.Phaser}),Module(function(t){return t.PingPongDelay=function(){var e=this.optionsObject(arguments,["delayTime","feedback"],t.PingPongDelay.defaults);t.StereoXFeedbackEffect.call(this,e),this._leftDelay=this.context.createDelay(e.maxDelayTime),this._rightDelay=this.context.createDelay(e.maxDelayTime),this._rightPreDelay=this.context.createDelay(e.maxDelayTime),this.delayTime=new t.Signal(e.delayTime,t.Type.Time),this.effectSendL.chain(this._leftDelay,this.effectReturnL),this.effectSendR.chain(this._rightPreDelay,this._rightDelay,this.effectReturnR),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackLR.disconnect(),this._feedbackLR.connect(this._rightDelay),this._readOnly(["delayTime"])},t.extend(t.PingPongDelay,t.StereoXFeedbackEffect),t.PingPongDelay.defaults={delayTime:.25,maxDelayTime:1},t.PingPongDelay.prototype.dispose=function(){return t.StereoXFeedbackEffect.prototype.dispose.call(this),this._leftDelay.disconnect(),this._leftDelay=null,this._rightDelay.disconnect(),this._rightDelay=null,this._rightPreDelay.disconnect(),this._rightPreDelay=null,this._writable(["delayTime"]),this.delayTime.dispose(),this.delayTime=null,this},t.PingPongDelay}),Module(function(t){return t.StereoFeedbackEffect=function(){var e=this.optionsObject(arguments,["feedback"],t.FeedbackEffect.defaults);t.StereoEffect.call(this,e),this.feedback=new t.Signal(e.feedback,t.Type.NormalRange),this._feedbackL=this.context.createGain(),this._feedbackR=this.context.createGain(),this.effectReturnL.chain(this._feedbackL,this.effectSendL),this.effectReturnR.chain(this._feedbackR,this.effectSendR),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),this._readOnly(["feedback"])},t.extend(t.StereoFeedbackEffect,t.FeedbackEffect),t.StereoFeedbackEffect.prototype.dispose=function(){return t.StereoEffect.prototype.dispose.call(this),this._writable(["feedback"]),this.feedback.dispose(),this.feedback=null,this._feedbackL.disconnect(),this._feedbackL=null,this._feedbackR.disconnect(),this._feedbackR=null,this},t.StereoFeedbackEffect}),Module(function(t){return t.StereoWidener=function(){var e=this.optionsObject(arguments,["width"],t.StereoWidener.defaults);t.MidSideEffect.call(this,e),this.width=new t.Signal(.5,t.Type.NormalRange),this._midMult=new t.Expr("$0 * ($1 * (1 - $2))"),this._sideMult=new t.Expr("$0 * ($1 * $2)"),this._two=new t.Signal(2),this._two.connect(this._midMult,0,1),this.width.connect(this._midMult,0,2),this._two.connect(this._sideMult,0,1),this.width.connect(this._sideMult,0,2),this.midSend.chain(this._midMult,this.midReturn),this.sideSend.chain(this._sideMult,this.sideReturn),this._readOnly(["width"])},t.extend(t.StereoWidener,t.MidSideEffect),t.StereoWidener.defaults={width:.5},t.StereoWidener.prototype.dispose=function(){return t.MidSideEffect.prototype.dispose.call(this),this._writable(["width"]),this.width.dispose(),this.width=null,this._midMult.dispose(),this._midMult=null,this._sideMult.dispose(),this._sideMult=null,this._two.dispose(),this._two=null,this},t.StereoWidener}),Module(function(t){return t.Tremolo=function(){var e=this.optionsObject(arguments,["frequency","depth"],t.Tremolo.defaults);t.Effect.call(this,e),this._lfo=new t.LFO({frequency:e.frequency,amplitude:e.depth,min:1,max:0}),this._amplitude=this.context.createGain(),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this._readOnly(["frequency","depth"]),this.connectEffect(this._amplitude),this._lfo.connect(this._amplitude.gain),this.type=e.type},t.extend(t.Tremolo,t.Effect),t.Tremolo.defaults={frequency:10,type:"sine",depth:.5},t.Tremolo.prototype.start=function(t){return this._lfo.start(t),this},t.Tremolo.prototype.stop=function(t){return this._lfo.stop(t),this},t.Tremolo.prototype.sync=function(t){return this._lfo.sync(t),this},t.Tremolo.prototype.unsync=function(){return this._lfo.unsync(),this},Object.defineProperty(t.Tremolo.prototype,"type",{get:function(){return this._lfo.type},set:function(t){this._lfo.type=t}}),t.Tremolo.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this._writable(["frequency","depth"]),this._lfo.dispose(),this._lfo=null,this._amplitude.disconnect(),this._amplitude=null,this.frequency=null,this.depth=null,this},t.Tremolo}),Module(function(t){return t.Clip=function(e,n){if(e>n){var i=e;e=n,n=i}this.min=this.input=new t.Min(n),this._readOnly("min"),this.max=this.output=new t.Max(e),this._readOnly("max"),this.min.connect(this.max)},t.extend(t.Clip,t.SignalBase),t.Clip.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable("min"),this.min.dispose(),this.min=null,this._writable("max"),this.max.dispose(),this.max=null,this},t.Clip}),Module(function(t){return t.Normalize=function(e,n){this._inputMin=this.defaultArg(e,0),this._inputMax=this.defaultArg(n,1),this._sub=this.input=new t.Add(0),this._div=this.output=new t.Multiply(1),this._sub.connect(this._div),this._setRange()},t.extend(t.Normalize,t.SignalBase),Object.defineProperty(t.Normalize.prototype,"min",{get:function(){return this._inputMin},set:function(t){this._inputMin=t,this._setRange()}}),Object.defineProperty(t.Normalize.prototype,"max",{get:function(){return this._inputMax},set:function(t){this._inputMax=t,this._setRange()}}),t.Normalize.prototype._setRange=function(){this._sub.value=-this._inputMin,this._div.value=1/(this._inputMax-this._inputMin)},t.Normalize.prototype.dispose=function(){return t.prototype.dispose.call(this),this._sub.dispose(),this._sub=null,this._div.dispose(),this._div=null,this},t.Normalize}),Module(function(t){t.Route=function(n){n=this.defaultArg(n,2),t.call(this,1,n),this.gate=new t.Signal(0),this._readOnly("gate");for(var i=0;n>i;i++){var r=new e(i);this.output[i]=r,this.gate.connect(r.selecter),this.input.connect(r)}},t.extend(t.Route,t.SignalBase),t.Route.prototype.select=function(t,e){return t=Math.floor(t),this.gate.setValueAtTime(t,this.toSeconds(e)),this},t.Route.prototype.dispose=function(){this._writable("gate"),this.gate.dispose(),this.gate=null;for(var e=0;e<this.output.length;e++)this.output[e].dispose(),this.output[e]=null;return t.prototype.dispose.call(this),this};var e=function(e){this.selecter=new t.Equal(e),this.gate=this.input=this.output=this.context.createGain(),this.selecter.connect(this.gate.gain)};return t.extend(e),e.prototype.dispose=function(){t.prototype.dispose.call(this),this.selecter.dispose(),this.selecter=null,this.gate.disconnect(),this.gate=null},t.Route}),Module(function(t){return t.Switch=function(e){e=this.defaultArg(e,!1),t.call(this),this.gate=new t.Signal(0),this._readOnly("gate"),this._thresh=new t.GreaterThan(.5),this.input.connect(this.output),this.gate.chain(this._thresh,this.output.gain),e&&this.open()},t.extend(t.Switch,t.SignalBase),t.Switch.prototype.open=function(t){return this.gate.setValueAtTime(1,this.toSeconds(t)),this},t.Switch.prototype.close=function(t){return this.gate.setValueAtTime(0,this.toSeconds(t)),this},t.Switch.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable("gate"),this.gate.dispose(),this.gate=null,this._thresh.dispose(),this._thresh=null,this},t.Switch}),Module(function(t){return t.Microphone=function(e){t.Source.call(this),this._mediaStream=null,this._stream=null,this._constraints={audio:!0};var n=this;MediaStreamTrack.getSources(function(t){e<t.length&&(n.constraints.audio={optional:[{sourceId:t[e].id}]})})},t.extend(t.Microphone,t.Source),t.Microphone.prototype._start=function(){navigator.getUserMedia(this._constraints,this._onStream.bind(this),this._onStreamError.bind(this))},t.Microphone.prototype._stop=function(){return this._stream.stop(),this},t.Microphone.prototype._onStream=function(t){this._stream=t,this._mediaStream=this.context.createMediaStreamSource(t),this._mediaStream.connect(this.output)},t.Microphone.prototype._onStreamError=function(t){console.error(t)},t.Microphone.prototype.dispose=function(){return t.Source.prototype.dispose.call(this),this._mediaStream&&(this._mediaStream.disconnect(),this._mediaStream=null),this._stream=null,this._constraints=null,this},navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,t.Microphone}),"function"==typeof define&&define.amd?define("Tone",[],function(){return Tone}):"object"==typeof module?module.exports=Tone:root.Tone=Tone}(this)},{}]},{},[3]);